enchant();var SCREEN_WIDTH=320,SCREEN_HEIGHT=320,PLAYER_WIDTH=16,PLAYER_HEIGHT=25,PLAYER_JUMP=-15,PLAYER_GRAVIRY=5,ENEMY_WIDTH=32,ENEMY_HEIGHT=32,ENEMY_SPEED=-5,ENEMY_HIT_LENGTH=20,ITEM_WIDTH=16,ITEM_HEIGHT=16,ITEM_SPEED=-4,COIN_POINT=100,COIN_FRAME=14,DIAMOND_POINT=1e3,DIAMOND_FRAME=64,BACKGROUND_WIDTH=1320,BACKGROUND_HEIGHT=320,PLAYER_IMAGE1="images/ninja/ninja3.png",PLAYER_IMAGE2="images/ninja/ninja1.png",PLAYER_IMAGE3="images/ninja/ninja3.png",PLAYER_IMAGE4="images/ninja/ninja2.png",BACKGROUND_IMAGE="images/background_castle.png",GROUND_IMAGE3="images/ground1-2.png",G_WIDTH=32,G_HEIGHT=32,BTN_IMAGE="images/btn.png",BTN_JUMP="images/btn_jump.png",BTN_SHURIKEN="images/btn_shuriken.png",ATTACK_WIDTH=16,ATTACK_HEIGHT=16,ATTACK_IMAGE="images/ninja/shuriken.png",HINOTAMA_IMAGE1="images/ninja/hinotama1.png",HINOTAMA_IMAGE2="images/ninja/hinotama2.png",ATTACK_EFFECT="images/effect0.png",OROCHI_IMAGE="images/monster5.gif",CLEAR_IMAGE="images/clear.png",EPILOGUE_NINJA1="images/epilogue_ninja1.png",EPILOGUE_NINJA2="images/epilogue_ninja2.png",EPILOGUE_MAKIMONO="images/epilogue_makimono.png",EPILOGUE_DESCRIPTION="images/epilogue_description.png",STAFFROLL="images/staffroll.mp4",TAP_HERE="images/taphere.png",ASSETS=[PLAYER_IMAGE1,PLAYER_IMAGE2,PLAYER_IMAGE3,PLAYER_IMAGE4,BACKGROUND_IMAGE,GROUND_IMAGE3,BTN_IMAGE,BTN_JUMP,BTN_SHURIKEN,ATTACK_EFFECT,OROCHI_IMAGE,CLEAR_IMAGE,ATTACK_IMAGE,HINOTAMA_IMAGE1,HINOTAMA_IMAGE2,TAP_HERE,EPILOGUE_NINJA1,EPILOGUE_NINJA2,EPILOGUE_MAKIMONO,EPILOGUE_DESCRIPTION,STAFFROLL],game=null,player=null,is_ground=[[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],randfloat=function(e,t){return Math.random()*(t-e)+e},stage=new Group;window.onload=function(){(game=new Game(SCREEN_WIDTH,SCREEN_HEIGHT)).preload(ASSETS),enemies=[],startFrame=game.frame,game.onload=function(){var e=game.rootScene;e.backgroundColor="#0af",e.onenter=function(){game.frame=0,game.pushScene(game.makeStage1())}},game.makeStage1=function(){var e=new Scene,t=null,i=new Sprite(BACKGROUND_WIDTH,BACKGROUND_HEIGHT);return i.image=game.assets[BACKGROUND_IMAGE],i.moveTo(0,0),i.onenterframe=function(){this.x-=1,this.x<=-(BACKGROUND_WIDTH-SCREEN_WIDTH)&&i.moveTo(0,-15),game.frame-startFrame>=10&&null==t&&(t=new Orochi,e.addChild(t),t.key=game.frame,enemies[t.key]=t)},e.addChild(i),e.addChild(stage),e.onenter=function(){(map=new Map(32,32)).image=game.assets[GROUND_IMAGE3],map.loadData(is_ground),stage.addChild(map);var t=new Button(20,SCREEN_HEIGHT-55,"a");e.addChild(t),t.ontouchstart=function(){player.jump()};var i=new Button(SCREEN_WIDTH-70,SCREEN_HEIGHT-55,"b");e.addChild(i),i.ontouchstart=function(){var t=player.attack();t.scene=e,e.addChild(t)},e.addChild(stage),(player=new Player).x=50,player.y=235,player.vx=0,player.vy=0,player.ax=0,player.ay=0,player.pose=0,player.jumping=!0,player.jumpflg=0,stage.addChild(player),stage.addEventListener("enterframe",(function(e){this.x=50-(player.x+player.ax),g_idx=this.x}))},e.onenterframe=function(){if(game.frame%30==0&&player.x>800){var t=new Enemy;t.moveTo(SCREEN_WIDTH+30,Math.random()*(SCREEN_HEIGHT-ENEMY_HEIGHT)),e.addChild(t),t.key=game.frame,enemies[t.key]=t}},e},game.createEpilogue=function(){var e=new Scene;e.backgroundColor="black";var t,i=new Sprite(143,32);i.image=game.assets[EPILOGUE_DESCRIPTION],i.x=90,i.y=30,e.addChild(i),(t=new Sprite(30,47)).image=game.assets[EPILOGUE_MAKIMONO],t.scale(.8,.8),t.x=60,t.y=80,e.addChild(t),(t=new Sprite(30,47)).image=game.assets[EPILOGUE_MAKIMONO],t.scale(.8,.8),t.x=150,t.y=80,e.addChild(t),(t=new Sprite(30,47)).image=game.assets[EPILOGUE_MAKIMONO],t.scale(.8,.8),t.x=240,t.y=80,e.addChild(t);var a=new Sprite(181,232);a.image=game.assets[EPILOGUE_NINJA1],a.scale(.5,.5),a.x=75,a.y=80;var s=0;a.onenterframe=function(){s%5==0&&(this.image==game.assets[EPILOGUE_NINJA1]?this.image=game.assets[EPILOGUE_NINJA2]:this.image=game.assets[EPILOGUE_NINJA1]),++s},e.addChild(a),taphere=new Sprite(127,25),taphere.image=game.assets[TAP_HERE],taphere.x=100,taphere.y=270;var h=.08;taphere.opacity=h;var n=0;return taphere.onenterframe=function(){taphere.opacity<1&&0==n?taphere.opacity+=h:(taphere.opacity>=1&&(n=1),taphere.opacity<=0&&(n=0),taphere.opacity-h<0?taphere.opacity=0:taphere.opacity-=h)},e.addChild(taphere),taphere.ontouchstart=function(){game.replaceScene(game.createStaffroll())},e},game.createStaffroll=function(){var e=new Scene;e.backgroundColor="black";var t=document.createElement("video");t.src=STAFFROLL,t.setAttribute("controls",""),t.width=640,t.style.position="absolute",t.play(),document.body.style.backgroundColor="black",document.body.appendChild(t);var i=new Sprite(320,320);i.image=game.assets[STAFFROLL],i.x=0,i.y=0,taphere=new Sprite(127,25),taphere.image=game.assets[TAP_HERE],taphere.x=60,taphere.y=200;var a=.08;taphere.opacity=a;var s=0;return taphere.onenterframe=function(){taphere.opacity<1&&0==s?taphere.opacity+=a:(taphere.opacity>=1&&(s=1),taphere.opacity<=0&&(s=0),taphere.opacity-a<0?taphere.opacity=0:taphere.opacity-=a)},e.addChild(taphere),taphere.ontouchstart=function(){location.href="https://genmakai.github.io/site/"},e},game.start()};var Button=enchant.Class.create(enchant.Sprite,{initialize:function(e,t,i){enchant.Sprite.call(this,50,50),enchant.CanvasLayer&&(this._element="div"),this.image="a"==i?game.assets[BTN_JUMP]:"b"==i?game.assets[BTN_SHURIKEN]:game.assets[BTN_IMAGE],this.x=e,this.y=t,this.buttonMode=i,this._style["z-index"]=100}}),PlayerAttack=Class.create(enchant.Sprite,{initialize:function(e,t){Sprite.call(this,ATTACK_WIDTH,ATTACK_HEIGHT),this.image=game.assets[ATTACK_IMAGE],this.x=e+10,this.y=t+5,this.moveSpeed=20,this.rotation=0},remove:function(){null!=this.scene&&this.scene.removeChild(this)},onenterframe:function(){if(this.x=this.x+3,this.rotation+=30,this.x>SCREEN_WIDTH)this.remove();else for(var e in enemies)if(enemies[e].intersect(this)){new Blast(this.x+25,this.y+10,this.scene);enemies[e].remove(this.scene),this.remove()}}}),Blast=enchant.Class.create(enchant.Sprite,{initialize:function(e,t,i){enchant.Sprite.call(this,16,16),this.x=e,this.y=t,this.image=game.assets[ATTACK_EFFECT],this.time=0,this.duration=20,this.frame=0,null!=i&&i.addChild(this)},remove:function(){this.scene.removeChild(this)},onenterframe:function(){this.time++,this.frame=Math.floor(this.time/this.duration*5),this.time===this.duration&&this.remove()}}),gameOver=function(e){game.end(e)},GameClear=Class.create(Sprite,{initialize:function(e,t,i){enchant.Sprite.call(this,SCREEN_WIDTH-55,47),this.image=game.assets[CLEAR_IMAGE],this.x=e,this.y=t,this.opacity=1,i.addChild(this),game.stop()}}),Player=Class.create(Sprite,{initialize:function(){Sprite.call(this,PLAYER_WIDTH,PLAYER_HEIGHT),this.image=game.assets[PLAYER_IMAGE1],this.frame=0,this.vy=0,this.time=0|randfloat(0,360),this.positionX=50},onenterframe:function(){var e=new(enchant.Class.create({initialize:function(e,t,i,a){this.x=e,this.y=t,this.width=i,this.height=a},right:{get:function(){return this.x+this.width}},bottom:{get:function(){return this.y+this.height}}}))(this.x,this.y,this.width,this.height);if(map.hitTest(e.x,e.bottom)||map.hitTest(e.right,e.bottom)?(e.y=e.y,0==this.ay&&(this.jumpflg=0)):e.y+=PLAYER_GRAVIRY,map.hitTest(e.x,e.y)?(e.y-=PLAYER_JUMP,this.ay+=PLAYER_GRAVIRY):e.y=e.y,map.hitTest(e.right,e.y)?(e.x-=0,this.ax+=2):(e.x+=2,this.ax=0),this.jumping||(this.ay<0&&this.ay++,0==this.ay&&(this.ay=this.ay)),this.jumping=!1,this.x=e.x,p_idx=this.x,this.y=e.y+this.ay,this.y>320){var t=Math.round(this.x);this.frame=3,this.vy=-20,this.addEventListener("enterframe",(function(){this.vy+=2,this.y+=Math.min(Math.max(this.vy,-10),10),this.y>310&&game.end(t,t+"mで死にました"),this.removeEventListener("enterframe",arguments.callee)}))}this.x+this.width<0&&gameOver("画面外に出てしまいました. 残念!!"),this.time%5==0&&(this.image==game.assets[PLAYER_IMAGE1]?this.image=game.assets[PLAYER_IMAGE2]:this.image==game.assets[PLAYER_IMAGE2]?this.image=game.assets[PLAYER_IMAGE3]:this.image==game.assets[PLAYER_IMAGE3]?this.image=game.assets[PLAYER_IMAGE4]:this.image=game.assets[PLAYER_IMAGE1]),++this.time},jump:function(){0==this.jumpflg&&(this.jumping=!0,this.jumpflg=1,this.ay=PLAYER_JUMP)},attack:function(){return new PlayerAttack(this.positionX,this.y)}}),Enemy=Class.create(Sprite,{initialize:function(){Sprite.call(this,39,25),this.image=game.assets[HINOTAMA_IMAGE1],this.time=0|randfloat(0,360)},onenterframe:function(){this.x+=ENEMY_SPEED,this.y+=Math.cos(5*this.time*Math.PI/180),this.time%5==0&&(this.image==game.assets[HINOTAMA_IMAGE1]?this.image=game.assets[HINOTAMA_IMAGE2]:this.image=game.assets[HINOTAMA_IMAGE1]),this.within(player,ENEMY_HIT_LENGTH)&&gameOver("火の玉と衝突してしまいました. 残念!!"),this.x<-40&&this.parentNode.removeChild(this),++this.time},remove:function(e){null!=e&&e.removeChild(this),delete enemies[this.key]}}),BossTemplete=Class.create(Enemy,{initialize:function(e){Sprite.call(this,80,80),this.image=e,this.x=200,this.y=BACKGROUND_HEIGHT-125,this.hitPoint=100}}),Orochi=Class.create(BossTemplete,{initialize:function(){BossTemplete.call(this,game.assets[OROCHI_IMAGE]),this.frame=11,this.framePoint=0,this.attackFlg=!1,this.retractFlg=!1,this.damageFlg=!1,this.comeOutFlg=!0,this.comeOutCount=30,this.clearFlg=0},onenterframe:function(){if(this.comeOutFlg)if(this.comeOutCount<=0){if(game.frame%6==0)if(11==this.frame)this.x=200,this.frame=0;else if(this.frame<=1||this.frame>=4&&this.frame<6)this.frame++;else if(2==this.frame)this.frame*=2,this.damageFlg=!0;else switch(this.frame){case 6:case 10:this.framePoint=this.frame,this.frame=9;break;case 9:6==this.framePoint?this.frame=10:this.framePoint%5==0&&(this.frame=6);break;case 7:case 8:this.frame--}game.frame%300==0&&(this.frame=10,this.comeOutFlg=!1,this.damageFlg=!1,this.retractFlg=!0)}else this.comeOutCount--;else if(this.attackFlg){if(game.frame%3==0&&player.positionX+15<=this.x)switch(this.frame){case 1:this.frame=4;break;case 4:this.frame=0;break;case 6:this.frame=1;break;default:this.frame<=2?this.frame=3:this.frame=2,this.x-=15}else if(game.frame%6==0&&player.positionX+15>this.x)switch(this.frame){case 0:this.frame=1;break;case 1:this.frame=5;break;case 2:case 3:this.frame=0;break;case 5:this.frame=6;break;case 6:this.frame=9;break;case 9:this.frame=10;break;case 10:this.attackFlg=!1,this.retractFlg=!0}}else if(this.retractFlg&&game.frame%3==0)switch(this.frame){case 0:player.positionX+10>this.x?(this.x=-200,this.comeOutCount=50,this.comeOutFlg=!0,this.frame=11):this.attackFlg=!0,this.retractFlg=!1;break;case 1:this.frame=0;break;case 6:this.frame=1;break;case 10:this.frame=6}10==this.frame&&this.within(player,ENEMY_HIT_LENGTH-60)&&gameOver("大蛇の攻撃を受けてしまいました。 残念!!")},remove:function(e){this.damageFlg&&0===this.clearFlg&&(this.hitPoint<=0?(e.removeChild(this),this.clearFlg=1):(this.frame=8,this.hitPoint--)),(1===this.clearFlg||this.hitPoint<=0)&&(this.clearFlg=2,game.replaceScene(game.createEpilogue()))}}),map=null,Ashigaru=Class.create(Sprite,{initialize:function(){Sprite.call(this,ASHIGARU_WIDTH,ASHIGARU_HEIGHT),this.image=game.assets[ASHIGARU_IMAGE1],this.frame=0,this.time=0|randfloat(0,360)},onenterframe:function(){var e=enchant.Class.create({initialize:function(e,t,i,a){this.x=e,this.y=t,this.width=i,this.height=a},right:{get:function(){return this.x+this.width}},bottom:{get:function(){return this.y+this.height}}}),t=new e(this.x,this.y,this.width,this.height);map.hitTest(t.x,t.bottom)||map.hitTest(t.right,t.bottom)?t.y=t.y:t.y+=PLAYER_GRAVIRY,map.hitTest(t.x,t.y)?(t.y-=PLAYER_JUMP,this.ay+=PLAYER_GRAVIRY):t.y=t.y,map.hitTest(t.right,t.y)?(t.x-=0,this.ax+=2):(t.x-=2,this.ax=0),this.ay<0&&this.ay++,0==this.ay&&(this.ay=this.ay),this.x=t.x,this.y=t.y+this.ay,this.y>320&&(this.frame=3,this.vy=-20,this.addEventListener("enterframe",(function(){this.vy+=2,this.y+=Math.min(Math.max(this.vy,-10),10),this.y})),this.removeEventListener("enterframe",arguments.callee)),this.x+this.width<0&&gameOver("画面外に出てしまいました. 残念!!"),this.time%5==0&&(this.image==game.assets[ASHIGARU_IMAGE1]?this.image=game.assets[ASHIGARU_IMAGE2]:this.image==game.assets[ASHIGARU_IMAGE2]?this.image=game.assets[ASHIGARU_IMAGE3]:this.image==game.assets[ASHIGARU_IMAGE3]?this.image=game.assets[ASHIGARU_IMAGE4]:this.image=game.assets[ASHIGARU_IMAGE1]),++this.time}});
