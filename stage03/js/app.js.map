{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/enchant.js","webpack:///./src/js/plugins/ui.enchant.js","webpack:///./src/js/plugins/avatar.enchant.js","webpack:///./src/js/functions.js","webpack:///./src/js/sprite/_base.js","webpack:///./src/js/sprite/_ninja.js","webpack:///./src/js/sprite/_cloud.js","webpack:///./src/js/sprite/_mountain.js","webpack:///./src/js/sprite/_ground.js","webpack:///./src/js/sprite/_janpBtn.js","webpack:///./src/js/sprite/_rook.js","webpack:///./src/js/sprite/_enemyBase.js","webpack:///./src/js/sprite/_musha.js","webpack:///./src/js/sprite/_bakuhatu.js","webpack:///./src/js/sprite/_ashigaru.js","webpack:///./src/js/sprite/_bakuhatu2.js","webpack:///./src/js/sprite/_hinotama.js","webpack:///./src/js/model/_label.js","webpack:///./src/js/config/enemy.js","webpack:///./src/js/model/_sprite.js","webpack:///./src/js/_main.js","webpack:///./src/js/app.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","undefined","origin","lastTime","obj","prop","desc","__defineGetter__","__defineSetter__","set","defineProperties","descs","F","getPrototypeOf","__proto__","Function","thisObject","func","this","args","Array","slice","arguments","Nop","bound","a","concat","apply","getTime","performance","now","Date","webkitNow","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","setTimeout","Math","max","div","ua","core","enchant","filter","join","include","prefix","len","submodules","push","indexOf","splice","length","Class","getInheritanceTree","Game","Core","Error","addEventListener","msg","data","JSON","parse","type","instance","dispatchEvent","Event","start","pause","resume","_tick","e","superclass","definition","writable","Constructor","initialize","constructor","tree","_inherited","ret","C","proto","ENV","VERSION","BROWSER","navigator","userAgent","test","VENDOR_PREFIX","product","TOUCH_ENABLED","document","createElement","setAttribute","ontouchstart","RETINA_DISPLAY","devicePixelRatio","viewport","querySelector","head","appendChild","USE_FLASH_SOUND","vendor","location","href","USE_DEFAULT_EVENT_TAGS","CANVAS_DRAWING_METHODS","KEY_BIND_TABLE","37","38","39","40","PREVENT_DEFAULT_KEY_CODES","SOUND_ENABLED_ON_MOBILE_SAFARI","USE_TOUCH_TO_START_SCENE","USE_WEBAUDIO","protocol","USE_ANIMATION","COLOR_DETECTION_LEVEL","target","x","y","localX","localY","_initPosition","pageX","pageY","_pageX","scale","_pageY","LOAD","ERROR","CORE_RESIZE","PROGRESS","ENTER_FRAME","EXIT_FRAME","ENTER","EXIT","CHILD_ADDED","ADDED","ADDED_TO_SCENE","CHILD_REMOVED","REMOVED","REMOVED_FROM_SCENE","TOUCH_START","TOUCH_MOVE","TOUCH_END","RENDER","INPUT_START","INPUT_CHANGE","INPUT_END","INPUT_STATE_CHANGED","LEFT_BUTTON_DOWN","LEFT_BUTTON_UP","RIGHT_BUTTON_DOWN","RIGHT_BUTTON_UP","UP_BUTTON_DOWN","UP_BUTTON_UP","DOWN_BUTTON_DOWN","DOWN_BUTTON_UP","A_BUTTON_DOWN","A_BUTTON_UP","B_BUTTON_DOWN","B_BUTTON_UP","ADDED_TO_TIMELINE","REMOVED_FROM_TIMELINE","ACTION_START","ACTION_END","ACTION_TICK","ACTION_ADDED","ACTION_REMOVED","ANIMATION_END","EventTarget","_listeners","listener","listeners","unshift","on","removeEventListener","clearEventListener","_offsetX","_offsetY","width","height","body","initial","stop","_calledTime","_mousedownID","_surfaceID","_soundID","_scenes","sWidth","sHeight","stage","getElementById","style","getComputedStyle","parseInt","min","firstChild","removeChild","position","bounding","getBoundingClientRect","round","scrollX","pageXOffset","left","scrollY","pageYOffset","top","id","insertBefore","innerWidth","innerHeight","fontSize","webkitTextSizeAdjust","webkitTapHighlightColor","_element","_oncoreresize","_width","_height","fps","frame","ready","running","assets","_assets","detectAssets","preload","currentScene","rootScene","Scene","pushScene","loadingScene","LoadingScene","_activated","input","keyboardInputManager","KeyboardInputManager","addBroadcastTarget","_keybind","_binds","keybind","keyCode","preventDefault","stopPropagation","tagName","toLowerCase","_touchEventTarget","touch","evt","touches","changedTouches","_determineEventTarget","identifier","w","_dispatchCoreResizeEvent","h","_scale","floor","load","src","alias","callback","onerror","assetName","tempCallback","ext","findExt","Deferred","next","_callback","_onerror","fail","_loadFuncs","req","XMLHttpRequest","open","onreadystatechange","readyState","status","message","getResponseHeader","match","Surface","Sound","responseText","send","deferred","onloadTimeSetter","currentTime","scene","_createTouchToStartScene","waitTouch","WebAudioSound","buffer","audioContext","createBuffer","play","removeScene","_requestNextFrame","_requestPreload","arg","error","loaded","loadFunc","total","reverse","forEach","asset","parallel","label","Label","size","color","font","textAlign","_boundHeight","backgroundColor","addChild","debug","_debug","actualFps","_actualFps","delay","_callTick","time","elapsed","nodes","childNodes","node","pop","age","popScene","replaceScene","_buttonListener","button","keyunbind","changeButtonState","bool","changeState","getElapsedTime","path","matched","split","InputManager","valueStore","source","broadcastTarget","_stateHandler","inputSource","unbind","eventTarget","removeBroadcastTarget","broadcastEvent","InputSource","notifyStateChange","BinaryInputManager","flagStore","activeEventNameSuffix","inactiveEventNameSuffix","activeInputsNum","binaryInputSource","_down","_up","inputEvent","downEvent","upEvent","BinaryInputSource","domElement","_attachDOMEvent","KeyboardInputSource","getByKeyCode","eventType","state","code","_instances","Node","_dirty","_matrix","_x","_y","parentNode","tl","Timeline","moveTo","moveBy","_updateCoordinate","parent","newmat","ox","oy","matrix","Matrix","stack","mat","makeTransformMatrix","multiply","vec","_originX","_originY","multiplyVec","reset","remove","_intersectBetweenClassAndInstance","collection","_intersectOne","_intersectStrictBetweenClassAndInstance","_intersectStrictOne","_staticIntersect","other","Entity","Class1","Class2","c1","c2","j","ll","_intersectBetweenClassAndClass","_staticIntersectStrict","_intersectStrictBetweenClassAndClass","_nodePrototypeClearEventListener","_rotation","_scaleX","_scaleY","_touchEnabled","_clipping","_backgroundColor","_debugColor","_opacity","_visible","_buttonMode","_style","__styleStatus","_isContainedInCollection","compositeOperation","buttonMode","buttonPressed","enableCollection","debugColor","opacity","parseFloat","visible","touchEnabled","enabled","pointerEvents","intersect","intersectStrict","poss1","poss2","dirs1","dirs2","pos1","pos2","dir1","dir2","px1","py1","px2","py2","dx1","dy1","dx2","dy2","vx","vy","rect1","getOrientedBoundingRect","rect2","lt1","leftTop","rt1","rightTop","lb1","leftBottom","rb1","rightBottom","lt2","rt2","lb2","rb2","ltx1","lty1","rtx1","rty1","lbx1","lby1","rbx1","rby1","ltx2","lty2","rtx2","rty2","lbx2","lby2","rbx2","rby2","t1","r1","b1","l1","t2","r2","b2","l2","cx1","cy1","cx2","cy2","within","distance","_","rotate","deg","rotation","scaleX","scaleY","originX","originY","_addSelfToCollection","_removeSelfFromCollection","disableCollection","getConstructor","_collectionTarget","getBoundingRect","m11w","m12w","m21h","m22h","mdx","mdy","xw","sort","b","yh","_collectizeConstructor","_collective","rel","subclass","Sprite","_image","_frameLeft","_frameTop","_frame","_frameSequence","image","_computeFramePosition","_deepCompareToPreviousFrame","__frameSequence","frameSequence","_rotateFrameSequence","_originalFrameSequence","frameArray","row","nextFrame","shift","cvsRender","ctx","iw","ih","elem","sx","sy","sw","sh","fillStyle","_getPattern","fillRect","drawImage","domRender","element","_css","text","updateBoundArea","_text","replace","_splitText","metrics","getMetrics","amount","line","buf","increase","labelWidth","textBaseline","measureText","fillText","innerHTML","detectRender","_boundOffset","_boundWidth","whiteSpace","lineHeight","computedStyle","Map","tileWidth","tileHeight","surface","_surface","canvas","webkitTransformOrigin","webkitTransform","_context","getContext","_tileWidth","_tileHeight","_data","_tight","collisionData","_previousOffsetX","_previousOffsetY","loadData","checkTile","hitTest","img","col","draw","_doubledImage","redraw","dx","dy","right","ceil","bottom","context","clearRect","updateBuffer","px","py","w1","w2","h1","h2","_buffer","save","setTransform","cvs","restore","Group","__dirty","event","child","childAdded","addedToScene","reference","childRemoved","removedFromScene","lastChild","dirty","dest","theta","PI","tmpcos","cos","tmpsin","sin","m1","m2","a11","a21","adx","a12","a22","ady","b11","b21","bdx","b12","b22","bdy","m11","m21","m12","m22","DetectColorManager","reso","colorResolution","capacity","pow","attachDetectColor","sprite","_getColor","detachDetectColor","_decodeDetectColor","getSpriteByColor","getSpriteByColors","rgba","result","score","found","DomManager","elementDefinition","layer","targetNode","HTMLElement","border","margin","manager","_setDomTarget","_attachEvent","getDomElement","getDomElementAsNext","getNextManager","_domManager","addManager","childManager","nextManager","nextElement","setLayer","removeManager","DomlessManager","_domRef","render","inheritMat","toFixed","display","setProperty","_detachEvent","_register","_layers","Dom","dom","DomLayer","_scene","__onchildadded","self","_attachDomManager","__onchildremoved","_rendering","_detachDomManager","_startRendering","_onexitframe","_stopRendering","onchildadded","onchildremoved","CanvasLayer","_cvsCache","detectColor","_detect","_lastDetected","_dctx","_setImageSmoothingEnable","_colorManager","Canvas","_attachCache","CanvasRenderer","_detachCache","_getEntityByPosition","extra","getImageData","imageSmoothingEnabled","msImageSmoothingEnabled","mozImageSmoothingEnabled","webkitImageSmoothingEnabled","transform","globalCompositeOperation","globalAlpha","strokeStyle","strokeRect","beginPath","rect","clip","overflow","_layerPriority","_onchildadded","_onchildremoved","_onenter","_onexit","that","_dispatchExitframe","addLayer","nextSibling","_layer","barWidth","barHeight","bar","progress","_progress","CanvasScene","DOMScene","getCSSCanvasContext","mozSetImageElement","method","getPixel","setPixel","g","pixel","createImageData","putImageData","clear","clone","toDataURL","Image","onload","_staticCanvas2DContext","force","_pattern","createPattern","_succ","_fail","_next","_id","_tail","q","_add","queue","received","_insert","err","ins","clearTimeout","DOMSound","duration","Audio","cloneNode","volume","sound","audio","canPlayType","canplay","autoplay","embed","allowscriptaccess","getCurrentTime","setCurrentTime","getVolume","setVolume","getDuration","AudioContext","webkitAudioContext","mozAudioContext","msAudioContext","oAudioContext","destination","createBufferSource","_volume","_currentTime","_state","connectTarget","dup","disconnect","offset","actx","createGain","_gain","createGainNode","gain","connect","noteGrainOn","_startTime","noteOff","xhr","canPlay","dispatchErrorEvent","responseType","decodeAudioData","response","Easing","LINEAR","SWING","QUAD_EASEIN","QUAD_EASEOUT","QUAD_EASEINOUT","CUBIC_EASEIN","CUBIC_EASEOUT","CUBIC_EASEINOUT","QUART_EASEIN","QUART_EASEOUT","QUART_EASEINOUT","QUINT_EASEIN","QUINT_EASEOUT","QUINT_EASEINOUT","SIN_EASEIN","SIN_EASEOUT","SIN_EASEINOUT","CIRC_EASEIN","sqrt","CIRC_EASEOUT","CIRC_EASEINOUT","ELASTIC_EASEIN","abs","asin","ELASTIC_EASEOUT","ELASTIC_EASEINOUT","BOUNCE_EASEOUT","BOUNCE_EASEIN","BOUNCE_EASEINOUT","BACK_EASEIN","BACK_EASEOUT","BACK_EASEINOUT","EXPO_EASEIN","EXPO_EASEOUT","EXPO_EASEINOUT","ActionEventTarget","paused","looped","isFrameBased","_parallel","_onenterframe","_nodeEventListener","_deactivateTimeline","_activateTimeline","tick","setFrameBased","setTimeBased","remainingTime","action","timeline","add","f","actions","params","Action","tween","Tween","skip","frames","loop","unloop","wait","then","onactiontick","exec","cue","ptr","repeat","and","last","ParallelAction","or","doAll","children","waitAll","waitUntil","fadeTo","easing","fadeIn","fadeOut","moveX","moveY","hide","show","removeFromScene","scaleTo","scaleBy","rotateTo","rotateBy","param","remaining","endedActions","excepted","target_val","ratio","ui","Pad","up","down","_updateInput","_detectInput","APad","outside","outsideImage","inside","insideImage","isTouched","rad","dist","_updateImage","_calcPolar","_dispatchPadEvent","tan","atan","dir","Button","theme","pressed","DEFAULT_THEME","_applyTheme","normal","active","css","theme2css","_font","_color","_textAlign","bg","background","bd","ts","textShadow","bs","boxShadow","end","offsetX","offsetY","blur","dark","light","blue","MutableText","widthItemNum","_imageAge","Number","MAX_VALUE","setText","txt","charCode","charPos","returnLength","charCodeAt","ScoreLabel","_score","_current","newscore","TimeLabel","counttype","_time","_count","newtime","LifeLabel","maxlife","_maxlife","_life","heart","life","newlife","Bar","fillColor","_direction","_origin","_maxvalue","_lastvalue","direction","newdirection","maxvalue","val","VirtualMap","meshWidth","meshHeight","mx","my","avatar","AvatarCharacter","animPattern","animFrame","AvatarMonster","AvatarBG","veryfarbg","farbgs","tiles","tile","scroll","ddx","Avatar","setCode","gender","hairstyle","haircolor","weapon","armor","headpiece","loadImage","opt","___EnchantAvatarServerURL","getCode","random","Base","Controller","controller","item","game","group","Ninja","isJump","GROUND_Y","touchstart","touchend","soundEffect","runSpeed","SPEED_FLG","isBan","runState","isSecond","oneSecond","SCROLL_SPEED","jump","run","Cloud","SPEED","Mountain","Ground","jumpBtn","player","items","prayer","Rook","num","move","EnemyBase","Musha","defaultRunSpeed","intersectPrayer","over","Bakuhatu","Ashigaru","boss","SCROLL_FLG","slowRun","Bakuhatu2","Hinotama","flg","MyLabel","enemysTimeline","class","count","MySprite","console","log","flameCount","second","gameStart","restart","hookClass","enemysClass","applyGroup","hookAdd","map","enemyApply","charaGroup","bgGroup","old","bgm","easy","nomal","hard","gameScene","timerInit","ctlGroup","Jump","init","titleScene","gameclearScene","taphere","onenterframe","chara","getData","overScene","defaultValue","propertyArray","main","Main","facade"],"mappings":"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","file":"/dist/js/app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * enchant.js v0.8.3\n * http://enchantjs.com\n *\n * Copyright UEI Corporation\n * Released under the MIT license.\n */\n\n(function(window, undefined) {\n\n// ECMA-262 5th edition Functions\nif (typeof Object.defineProperty !== 'function') {\n    Object.defineProperty = function(obj, prop, desc) {\n        if ('value' in desc) {\n            obj[prop] = desc.value;\n        }\n        if ('get' in desc) {\n            obj.__defineGetter__(prop, desc.get);\n        }\n        if ('set' in desc) {\n            obj.__defineSetter__(prop, desc.set);\n        }\n        return obj;\n    };\n}\nif (typeof Object.defineProperties !== 'function') {\n    Object.defineProperties = function(obj, descs) {\n        for (var prop in descs) {\n            if (descs.hasOwnProperty(prop)) {\n                Object.defineProperty(obj, prop, descs[prop]);\n            }\n        }\n        return obj;\n    };\n}\nif (typeof Object.create !== 'function') {\n    Object.create = function(prototype, descs) {\n        function F() {\n        }\n\n        F.prototype = prototype;\n        var obj = new F();\n        if (descs != null) {\n            Object.defineProperties(obj, descs);\n        }\n        return obj;\n    };\n}\nif (typeof Object.getPrototypeOf !== 'function') {\n    Object.getPrototypeOf = function(obj) {\n        return obj.__proto__;\n    };\n}\n\nif (typeof Function.prototype.bind !== 'function') {\n    Function.prototype.bind = function(thisObject) {\n        var func = this;\n        var args = Array.prototype.slice.call(arguments, 1);\n        var Nop = function() {\n        };\n        var bound = function() {\n            var a = args.concat(Array.prototype.slice.call(arguments));\n            return func.apply(\n                this instanceof Nop ? this : thisObject || window, a);\n        };\n        Nop.prototype = func.prototype;\n        bound.prototype = new Nop();\n        return bound;\n    };\n}\n\nwindow.getTime = (function() {\n    var origin;\n    if (window.performance && window.performance.now) {\n        origin = Date.now();\n        return function() {\n            return origin + window.performance.now();\n        };\n    } else if (window.performance && window.performance.webkitNow) {\n        origin = Date.now();\n        return function() {\n            return origin + window.performance.webkitNow();\n        };\n    } else {\n        return Date.now;\n    }\n}());\n\n// define requestAnimationFrame\nwindow.requestAnimationFrame =\n    window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    (function() {\n        var lastTime = window.getTime();\n        var frame = 1000 / 60;\n        return function(func) {\n            var _id = setTimeout(function() {\n                lastTime = window.getTime();\n                func(lastTime);\n            }, Math.max(0, lastTime + frame - window.getTime()));\n            return _id;\n        };\n    }());\n\n/**\n * Export the library classes globally.\n *\n * When no arguments are given, all classes defined in enchant.js as well as all classes defined in\n * plugins will be exported. When more than one argument is given, by default only classes defined\n * in enchant.js will be exported. When you wish to export plugin classes you must explicitly deliver\n * the plugin identifiers as arguments.\n *\n * @example\n * enchant();     // All classes will be exported.\n * enchant('');   // Only classes in enchant.js will be exported.\n * enchant('ui'); // enchant.js classes and ui.enchant.js classes will be exported.\n *\n * @param {...String} [modules] Export module. Multiple designations possible.\n * @function\n * @global\n * @name enchant\n */\nvar enchant = function(modules) {\n    if (modules != null) {\n        if (!(modules instanceof Array)) {\n            modules = Array.prototype.slice.call(arguments);\n        }\n        modules = modules.filter(function(module) {\n            return [module].join();\n        });\n    }\n    (function include(module, prefix) {\n        var submodules = [],\n            i, len;\n        for (var prop in module) {\n            if (module.hasOwnProperty(prop)) {\n                if (typeof module[prop] === 'function') {\n                    window[prop] = module[prop];\n                } else if (typeof module[prop] === 'object' && module[prop] !== null && Object.getPrototypeOf(module[prop]) === Object.prototype) {\n                    if (modules == null) {\n                        submodules.push(prop);\n                    } else {\n                        i = modules.indexOf(prefix + prop);\n                        if (i !== -1) {\n                            submodules.push(prop);\n                            modules.splice(i, 1);\n                        }\n                    }\n                }\n            }\n        }\n\n        for (i = 0, len = submodules.length; i < len; i++) {\n            include(module[submodules[i]], prefix + submodules[i] + '.');\n        }\n    }(enchant, ''));\n\n    // issue 185\n    if (enchant.Class.getInheritanceTree(window.Game).length <= enchant.Class.getInheritanceTree(window.Core).length) {\n        window.Game = window.Core;\n    }\n\n    if (modules != null && modules.length) {\n        throw new Error('Cannot load module: ' + modules.join(', '));\n    }\n};\n\n// export enchant\nwindow.enchant = enchant;\n\nwindow.addEventListener(\"message\", function(msg, origin) {\n    try {\n        var data = JSON.parse(msg.data);\n        if (data.type === \"event\") {\n            enchant.Core.instance.dispatchEvent(new enchant.Event(data.value));\n        } else if (data.type === \"debug\") {\n            switch (data.value) {\n                case \"start\":\n                    enchant.Core.instance.start();\n                    break;\n                case \"pause\":\n                    enchant.Core.instance.pause();\n                    break;\n                case \"resume\":\n                    enchant.Core.instance.resume();\n                    break;\n                case \"tick\":\n                    enchant.Core.instance._tick();\n                    break;\n                default:\n                    break;\n            }\n        }\n    } catch (e) {\n        // ignore\n    }\n}, false);\n\n/**\n * @name enchant.Class\n * @class\n * A Class representing a class which supports inheritance.\n * @param {Function} [superclass] The class from which the\n * new class will inherit the class definition.\n * @param {*} [definition] Class definition.\n * @constructor\n */\nenchant.Class = function(superclass, definition) {\n    return enchant.Class.create(superclass, definition);\n};\n\n/**\n * Creates a class.\n *\n * When defining a class that extends from another class, \n * the constructor of the other class will be used by default.\n * Even if you override this constructor, you must still call it\n * to ensure that the class is initialized correctly.\n *\n * @example\n * // Creates a Ball class.\n * var Ball = Class.create({ \n *\n *     // Ball's constructor\n *     initialize: function(radius) {\n *       // ... code ...\n *     }, \n *\n *     // Defines a fall method that doesn't take any arguments.\n *     fall: function() { \n *       // ... code ...\n *     }\n * });\n *\n * // Creates a Ball class that extends from \"Sprite\"\n * var Ball = Class.create(Sprite);  \n *\n * // Creates a Ball class that extends from \"Sprite\"\n * var Ball = Class.create(Sprite, { \n *\n *     // Overwrite Sprite's constructor\n *     initialize: function(radius) { \n *\n *         // Call Sprite's constructor.\n *         Sprite.call(this, radius * 2, radius * 2);\n *\n *         this.image = core.assets['ball.gif'];\n *     }\n * });\n *\n * @param {Function} [superclass] The class from which the\n * new class will inherit the class definition.\n * @param {*} [definition] Class definition.\n * @static\n */\nenchant.Class.create = function(superclass, definition) {\n    if (superclass == null && definition) {\n        throw new Error(\"superclass is undefined (enchant.Class.create)\");\n    } else if (superclass == null) {\n        throw new Error(\"definition is undefined (enchant.Class.create)\");\n    }\n\n    if (arguments.length === 0) {\n        return enchant.Class.create(Object, definition);\n    } else if (arguments.length === 1 && typeof arguments[0] !== 'function') {\n        return enchant.Class.create(Object, arguments[0]);\n    }\n\n    for (var prop in definition) {\n        if (definition.hasOwnProperty(prop)) {\n            if (typeof definition[prop] === 'object' && definition[prop] !== null && Object.getPrototypeOf(definition[prop]) === Object.prototype) {\n                if (!('enumerable' in definition[prop])) {\n                    definition[prop].enumerable = true;\n                }\n            } else {\n                definition[prop] = { value: definition[prop], enumerable: true, writable: true };\n            }\n        }\n    }\n    var Constructor = function() {\n        if (this instanceof Constructor) {\n            Constructor.prototype.initialize.apply(this, arguments);\n        } else {\n            return new Constructor();\n        }\n    };\n    Constructor.prototype = Object.create(superclass.prototype, definition);\n    Constructor.prototype.constructor = Constructor;\n    if (Constructor.prototype.initialize == null) {\n        Constructor.prototype.initialize = function() {\n            superclass.apply(this, arguments);\n        };\n    }\n\n    var tree = this.getInheritanceTree(superclass);\n    for (var i = 0, l = tree.length; i < l; i++) {\n        if (typeof tree[i]._inherited === 'function') {\n            tree[i]._inherited(Constructor);\n            break;\n        }\n    }\n\n    return Constructor;\n};\n\n/**\n * Get the inheritance tree of this class.\n * @param {Function} Constructor\n * @return {Function[]} Parent's constructor\n */\nenchant.Class.getInheritanceTree = function(Constructor) {\n    var ret = [];\n    var C = Constructor;\n    var proto = C.prototype;\n    while (C !== Object) {\n        ret.push(C);\n        proto = Object.getPrototypeOf(proto);\n        C = proto.constructor;\n    }\n    return ret;\n};\n\n/**\n * @namespace\n * enchant.js environment variables.\n * Execution settings can be changed by modifying these before calling new Core().\n */\nenchant.ENV = {\n    /**\n     * Version of enchant.js\n     * @type String\n     */\n    VERSION: '0.8.3',\n    /**\n     * Identifier of the current browser.\n     * @type String\n     */\n    BROWSER: (function(ua) {\n        if (/Eagle/.test(ua)) {\n            return 'eagle';\n        } else if (/Opera/.test(ua)) {\n            return 'opera';\n        } else if (/MSIE|Trident/.test(ua)) {\n            return 'ie';\n        } else if (/Chrome/.test(ua)) {\n            return 'chrome';\n        } else if (/(?:Macintosh|Windows).*AppleWebKit/.test(ua)) {\n            return 'safari';\n        } else if (/(?:iPhone|iPad|iPod).*AppleWebKit/.test(ua)) {\n            return 'mobilesafari';\n        } else if (/Firefox/.test(ua)) {\n            return 'firefox';\n        } else if (/Android/.test(ua)) {\n            return 'android';\n        } else {\n            return '';\n        }\n    }(navigator.userAgent)),\n    /**\n     * The CSS vendor prefix of the current browser.\n     * @type String\n     */\n    VENDOR_PREFIX: (function() {\n        var ua = navigator.userAgent;\n        if (ua.indexOf('Opera') !== -1) {\n            return 'O';\n        } else if (/MSIE|Trident/.test(ua)) {\n            return 'ms';\n        } else if (ua.indexOf('WebKit') !== -1) {\n            return 'webkit';\n        } else if (navigator.product === 'Gecko') {\n            return 'Moz';\n        } else {\n            return '';\n        }\n    }()),\n    /**\n     * Determines if the current browser supports touch.\n     * True, if touch is enabled.\n     * @type Boolean\n     */\n    TOUCH_ENABLED: (function() {\n        var div = document.createElement('div');\n        div.setAttribute('ontouchstart', 'return');\n        return typeof div.ontouchstart === 'function';\n    }()),\n    /**\n     * Determines if the current browser is an iPhone with a retina display.\n     * True, if this display is a retina display.\n     * @type Boolean\n     */\n    RETINA_DISPLAY: (function() {\n        if (navigator.userAgent.indexOf('iPhone') !== -1 && window.devicePixelRatio === 2) {\n            var viewport = document.querySelector('meta[name=\"viewport\"]');\n            if (viewport == null) {\n                viewport = document.createElement('meta');\n                document.head.appendChild(viewport);\n            }\n            viewport.setAttribute('content', 'width=640');\n            return true;\n        } else {\n            return false;\n        }\n    }()),\n    /**\n     * Determines if for current browser Flash should be used to play \n     * sound instead of the native audio class.\n     * True, if flash should be used.\n     * @type Boolean\n     */\n    USE_FLASH_SOUND: (function() {\n        var ua = navigator.userAgent;\n        var vendor = navigator.vendor || \"\";\n        // non-local access, not on mobile mobile device, not on safari\n        return (location.href.indexOf('http') === 0 && ua.indexOf('Mobile') === -1 && vendor.indexOf('Apple') !== -1);\n    }()),\n    /**\n     * If click/touch event occure for these tags the setPreventDefault() method will not be called.\n     * @type String[]\n     */\n    USE_DEFAULT_EVENT_TAGS: ['input', 'textarea', 'select', 'area'],\n    /**\n     * Method names of CanvasRenderingContext2D that will be defined as Surface method.\n     * @type String[]\n     */\n    CANVAS_DRAWING_METHODS: [\n        'putImageData', 'drawImage', 'drawFocusRing', 'fill', 'stroke',\n        'clearRect', 'fillRect', 'strokeRect', 'fillText', 'strokeText'\n    ],\n    /**\n     * Keybind Table.\n     * You can use 'left', 'up', 'right', 'down' for preset event.\n     * @example\n     * enchant.ENV.KEY_BIND_TABLE = {\n     *     37: 'left',\n     *     38: 'up',\n     *     39: 'right',\n     *     40: 'down',\n     *     32: 'a', //-> use 'space' key as 'a button'\n     * };\n     * @type Object\n     */\n    KEY_BIND_TABLE: {\n        37: 'left',\n        38: 'up',\n        39: 'right',\n        40: 'down'\n    },\n    /**\n     * If keydown event occure for these keycodes the setPreventDefault() method will be called.\n     * @type Number[]\n     */\n    PREVENT_DEFAULT_KEY_CODES: [37, 38, 39, 40],\n    /**\n     * Determines if Sound is enabled on Mobile Safari.\n     * @type Boolean\n     */\n    SOUND_ENABLED_ON_MOBILE_SAFARI: true,\n    /**\n     * Determines if \"touch to start\" scene is enabled.\n     * It is necessary on Mobile Safari because WebAudio Sound is\n     * muted by browser until play any sound in touch event handler.\n     * If set it to false, you should control this behavior manually.\n     * @type Boolean\n     */\n    USE_TOUCH_TO_START_SCENE: true,\n    /**\n     * Determines if WebAudioAPI is enabled. (true: use WebAudioAPI instead of Audio element if possible)\n     * @type Boolean\n     */\n    USE_WEBAUDIO: (function() {\n        return location.protocol !== 'file:';\n    }()),\n    /**\n     * Determines if animation feature is enabled. (true: Timeline instance will be generated in new Node)\n     * @type Boolean\n     */\n    USE_ANIMATION: true,\n    /**\n     * Specifies range of the touch detection.\n     * The detection area will be (COLOR_DETECTION_LEVEL * 2 + 1)px square.\n     * @type Boolean\n     */\n    COLOR_DETECTION_LEVEL: 2\n};\n\n/**\n * @scope enchant.Event.prototype\n */\nenchant.Event = enchant.Class.create({\n    /**\n     * @name enchant.Event\n     * @class\n     * A class for an independent implementation of events similar to DOM Events.\n     * Does not include phase concepts.\n     * @param {String} type Event type.\n     * @constructs\n     */\n    initialize: function(type) {\n        /**\n         * The type of the event.\n         * @type String\n         */\n        this.type = type;\n        /**\n         * The target of the event.\n         * @type *\n         */\n        this.target = null;\n        /**\n         * The x-coordinate of the event's occurrence.\n         * @type Number\n         */\n        this.x = 0;\n        /**\n         * The y-coordinate of the event's occurrence.\n         * @type Number\n         */\n        this.y = 0;\n        /**\n         * The x-coordinate of the event's occurrence relative to the object\n         * which issued the event.\n         * @type Number\n         */\n        this.localX = 0;\n        /**\n         * The y-coordinate of the event's occurrence relative to the object\n         * which issued the event.\n         * @type Number\n         */\n        this.localY = 0;\n    },\n    _initPosition: function(pageX, pageY) {\n        var core = enchant.Core.instance;\n        this.x = this.localX = (pageX - core._pageX) / core.scale;\n        this.y = this.localY = (pageY - core._pageY) / core.scale;\n    }\n});\n\n/**\n * An event dispatched once the core has finished loading.\n *\n * When preloading images, it is necessary to wait until preloading is complete\n * before starting the game.\n * Issued by: {@link enchant.Core}\n *\n * @example\n * var core = new Core(320, 320);\n * core.preload('player.gif');\n * core.onload = function() {\n *     ... // Describes initial core processing\n * };\n * core.start();\n * @type String\n */\nenchant.Event.LOAD = 'load';\n\n/**\n * An event dispatched when an error occurs.\n * Issued by: {@link enchant.Core}, {@link enchant.Surface}, {@link enchant.WebAudioSound}, {@link enchant.DOMSound}\n */\nenchant.Event.ERROR = 'error';\n\n/**\n * An event dispatched when the display size is changed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n @type String\n */\nenchant.Event.CORE_RESIZE = 'coreresize';\n\n/**\n * An event dispatched while the core is loading.\n * Dispatched each time an image is preloaded.\n * Issued by: {@link enchant.LoadingScene}\n * @type String\n */\nenchant.Event.PROGRESS = 'progress';\n\n/**\n * An event which is occurring when a new frame is beeing processed.\n * Issued object: {@link enchant.Core}, {@link enchant.Node}\n * @type String\n */\nenchant.Event.ENTER_FRAME = 'enterframe';\n\n/**\n * An event dispatched at the end of processing a new frame.\n * Issued by: {@link enchant.Core}, {@link enchant.Node}\n * @type String\n */\nenchant.Event.EXIT_FRAME = 'exitframe';\n\n/**\n * An event dispatched when a Scene begins.\n * Issued by: {@link enchant.Scene}\n * @type String\n */\nenchant.Event.ENTER = 'enter';\n\n/**\n * An event dispatched when a Scene ends.\n * Issued by: {@link enchant.Scene}\n * @type String\n */\nenchant.Event.EXIT = 'exit';\n\n/**\n * An event dispatched when a Child is added to a Node.\n * Issued by: {@link enchant.Group}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.CHILD_ADDED = 'childadded';\n\n/**\n * An event dispatched when a Node is added to a Group.\n * Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.ADDED = 'added';\n\n/**\n * An event dispatched when a Node is added to a Scene.\n * Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.ADDED_TO_SCENE = 'addedtoscene';\n\n/**\n * An event dispatched when a Child is removed from a Node.\n * Issued by: {@link enchant.Group}, {@link enchant.Scene}\n * @type String\n * @type String\n */\nenchant.Event.CHILD_REMOVED = 'childremoved';\n\n/**\n * An event dispatched when a Node is deleted from a Group.\n * Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.REMOVED = 'removed';\n\n/**\n * An event dispatched when a Node is deleted from a Scene.\n * Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.REMOVED_FROM_SCENE = 'removedfromscene';\n\n/**\n * An event dispatched when a touch event intersecting a Node begins.\n * A mouse event counts as a touch event. Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.TOUCH_START = 'touchstart';\n\n/**\n * An event dispatched when a touch event intersecting the Node has been moved.\n * A mouse event counts as a touch event. Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.TOUCH_MOVE = 'touchmove';\n\n/**\n * An event dispatched when a touch event intersecting the Node ends.\n * A mouse event counts as a touch event. Issued by: {@link enchant.Node}\n * @type String\n */\nenchant.Event.TOUCH_END = 'touchend';\n\n/**\n * An event dispatched when an Entity is rendered.\n * Issued by: {@link enchant.Entity}\n * @type String\n */\nenchant.Event.RENDER = 'render';\n\n/**\n * An event dispatched when a button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.INPUT_START = 'inputstart';\n\n/**\n * An event dispatched when button inputs change.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.INPUT_CHANGE = 'inputchange';\n\n/**\n * An event dispatched when button input ends.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.INPUT_END = 'inputend';\n\n/**\n * An internal event which is occurring when a input changes.\n * Issued object: {@link enchant.InputSource}\n * @type String\n */\nenchant.Event.INPUT_STATE_CHANGED = 'inputstatechanged';\n\n/**\n * An event dispatched when the 'left' button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.LEFT_BUTTON_DOWN = 'leftbuttondown';\n\n/**\n * An event dispatched when the 'left' button is released.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.LEFT_BUTTON_UP = 'leftbuttonup';\n\n/**\n * An event dispatched when the 'right' button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.RIGHT_BUTTON_DOWN = 'rightbuttondown';\n\n/**\n * An event dispatched when the 'right' button is released.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.RIGHT_BUTTON_UP = 'rightbuttonup';\n\n/**\n * An event dispatched when the 'up' button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.UP_BUTTON_DOWN = 'upbuttondown';\n\n/**\n * An event dispatched when the 'up' button is released.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.UP_BUTTON_UP = 'upbuttonup';\n\n/**\n * An event dispatched when the 'down' button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.DOWN_BUTTON_DOWN = 'downbuttondown';\n\n/**\n * An event dispatched when the 'down' button is released.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.DOWN_BUTTON_UP = 'downbuttonup';\n\n/**\n * An event dispatched when the 'a' button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.A_BUTTON_DOWN = 'abuttondown';\n\n/**\n * An event dispatched when the 'a' button is released.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.A_BUTTON_UP = 'abuttonup';\n\n/**\n * An event dispatched when the 'b' button is pressed.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.B_BUTTON_DOWN = 'bbuttondown';\n\n/**\n * An event dispatched when the 'b' button is released.\n * Issued by: {@link enchant.Core}, {@link enchant.Scene}\n * @type String\n */\nenchant.Event.B_BUTTON_UP = 'bbuttonup';\n\n/**\n * An event dispatched when an Action is added to a Timeline.\n * When looped, an Action is removed from the Timeline and added back into it.\n * @type String\n */\nenchant.Event.ADDED_TO_TIMELINE = \"addedtotimeline\";\n\n/**\n * An event dispatched when an Action is removed from a Timeline.\n * When looped, an Action is removed from the timeline and added back into it.\n * @type String\n */\nenchant.Event.REMOVED_FROM_TIMELINE = \"removedfromtimeline\";\n\n/**\n * An event dispatched when an Action begins.\n * @type String\n */\nenchant.Event.ACTION_START = \"actionstart\";\n\n/**\n * An event dispatched when an Action finishes.\n * @type String\n */\nenchant.Event.ACTION_END = \"actionend\";\n\n/**\n * An event dispatched when an Action has gone through one frame.\n * @type String\n */\nenchant.Event.ACTION_TICK = \"actiontick\";\n\n/**\n * An event dispatched to the Timeline when an Action is added.\n * @type String\n */\nenchant.Event.ACTION_ADDED = \"actionadded\";\n\n/**\n * An event dispatched to the Timeline when an Action is removed.\n * @type String\n */\nenchant.Event.ACTION_REMOVED = \"actionremoved\";\n\n/**\n * An event dispatched when an animation finishes, meaning null element was encountered\n * Issued by: {@link enchant.Sprite}\n * @type String\n */\nenchant.Event.ANIMATION_END = \"animationend\";\n\n/**\n * @scope enchant.EventTarget.prototype\n */\nenchant.EventTarget = enchant.Class.create({\n    /**\n     * @name enchant.EventTarget\n     * @class\n     * A class for implementation of events similar to DOM Events.\n     * However, it does not include the concept of phases.\n     * @constructs\n     */\n    initialize: function() {\n        this._listeners = {};\n    },\n    /**\n     * Add a new event listener which will be executed when the event\n     * is dispatched.\n     * @param {String} type Type of the events.\n     * @param {Function(e:enchant.Event)} listener Event listener to be added.\n     */\n    addEventListener: function(type, listener) {\n        var listeners = this._listeners[type];\n        if (listeners == null) {\n            this._listeners[type] = [listener];\n        } else if (listeners.indexOf(listener) === -1) {\n            listeners.unshift(listener);\n\n        }\n    },\n    /**\n     * Synonym for addEventListener.\n     * @param {String} type Type of the events.\n     * @param {Function(e:enchant.Event)} listener Event listener to be added.\n     * @see enchant.EventTarget#addEventListener\n     */\n    on: function() {\n        this.addEventListener.apply(this, arguments);\n    },\n    /**\n     * Delete an event listener.\n     * @param {String} [type] Type of the events.\n     * @param {Function(e:enchant.Event)} listener Event listener to be deleted.\n     */\n    removeEventListener: function(type, listener) {\n        var listeners = this._listeners[type];\n        if (listeners != null) {\n            var i = listeners.indexOf(listener);\n            if (i !== -1) {\n                listeners.splice(i, 1);\n            }\n        }\n    },\n    /**\n     * Clear all defined event listeners of a given type.\n     * If no type is given, all listeners will be removed.\n     * @param {String} type Type of the events.\n     */\n    clearEventListener: function(type) {\n        if (type != null) {\n            delete this._listeners[type];\n        } else {\n            this._listeners = {};\n        }\n    },\n    /**\n     * Issue an event.\n     * @param {enchant.Event} e Event to be issued.\n     */\n    dispatchEvent: function(e) {\n        e.target = this;\n        e.localX = e.x - this._offsetX;\n        e.localY = e.y - this._offsetY;\n        if (this['on' + e.type] != null){\n            this['on' + e.type](e);\n        }\n        var listeners = this._listeners[e.type];\n        if (listeners != null) {\n            listeners = listeners.slice();\n            for (var i = 0, len = listeners.length; i < len; i++) {\n                listeners[i].call(this, e);\n            }\n        }\n    }\n});\n\n(function() {\n    var core;\n    /**\n     * @scope enchant.Core.prototype\n     */\n    enchant.Core = enchant.Class.create(enchant.EventTarget, {\n        /**\n         * @name enchant.Core\n         * @class\n         * A class for controlling the core’s main loop and scenes.\n         *\n         * There can be only one instance at a time. When the\n         * constructor is executed while an instance exists, the\n         * existing instance will be overwritten. The existing instance\n         * can be accessed from {@link enchant.Core.instance}.\n         *\n         * @param {Number} [width=320] The width of the core viewport.\n         * @param {Number} [height=320] The height of the core viewport.\n         * @constructs\n         * @extends enchant.EventTarget\n         */\n        initialize: function(width, height) {\n            if (window.document.body === null) {\n                // @TODO postpone initialization after window.onload\n                throw new Error(\"document.body is null. Please excute 'new Core()' in window.onload.\");\n            }\n\n            enchant.EventTarget.call(this);\n            var initial = true;\n            if (core) {\n                initial = false;\n                core.stop();\n            }\n            core = enchant.Core.instance = this;\n\n            this._calledTime = 0;\n            this._mousedownID = 0;\n            this._surfaceID = 0;\n            this._soundID = 0;\n\n            this._scenes = [];\n\n            width = width || 320;\n            height = height || 320;\n\n            var stage = document.getElementById('enchant-stage');\n            var scale, sWidth, sHeight;\n            if (!stage) {\n                stage = document.createElement('div');\n                stage.id = 'enchant-stage';\n                stage.style.position = 'absolute';\n\n                if (document.body.firstChild) {\n                    document.body.insertBefore(stage, document.body.firstChild);\n                } else {\n                    document.body.appendChild(stage);\n                }\n                scale = Math.min(\n                    window.innerWidth / width,\n                    window.innerHeight / height\n                );\n                this._pageX = stage.getBoundingClientRect().left;\n                this._pageY = stage.getBoundingClientRect().top;\n            } else {\n                var style = window.getComputedStyle(stage);\n                sWidth = parseInt(style.width, 10);\n                sHeight = parseInt(style.height, 10);\n                if (sWidth && sHeight) {\n                    scale = Math.min(\n                        sWidth / width,\n                        sHeight / height\n                    );\n                } else {\n                    scale = 1;\n                }\n                while (stage.firstChild) {\n                    stage.removeChild(stage.firstChild);\n                }\n                stage.style.position = 'relative';\n\n                var bounding = stage.getBoundingClientRect();\n                this._pageX = Math.round(window.scrollX || window.pageXOffset + bounding.left);\n                this._pageY = Math.round(window.scrollY || window.pageYOffset + bounding.top);\n            }\n            stage.style.fontSize = '12px';\n            stage.style.webkitTextSizeAdjust = 'none';\n            stage.style.webkitTapHighlightColor = 'rgba(0, 0, 0, 0)';\n            this._element = stage;\n\n            this.addEventListener('coreresize', this._oncoreresize);\n\n            this._width = width;\n            this._height = height;\n            this.scale = scale;\n\n            /**\n             * The frame rate of the core.\n             * @type Number\n             */\n            this.fps = 30;\n            /**\n             * The number of frames processed since the core was started.\n             * @type Number\n             */\n            this.frame = 0;\n            /**\n             * Indicates whether or not the core can be executed.\n             * @type Boolean\n             */\n            this.ready = false;\n            /**\n             * Indicates whether or not the core is currently running.\n             * @type Boolean\n             */\n            this.running = false;\n            /**\n             * Object which stores loaded assets using their paths as keys.\n             * @type Object\n             */\n            this.assets = {};\n            var assets = this._assets = [];\n            (function detectAssets(module) {\n                if (module.assets) {\n                    enchant.Core.instance.preload(module.assets);\n                }\n                for (var prop in module) {\n                    if (module.hasOwnProperty(prop)) {\n                        if (typeof module[prop] === 'object' && module[prop] !== null && Object.getPrototypeOf(module[prop]) === Object.prototype) {\n                            detectAssets(module[prop]);\n                        }\n                    }\n                }\n            }(enchant));\n\n            /**\n             * The Scene which is currently displayed. This Scene is on top of the Scene stack.\n             * @type enchant.Scene\n             */\n            this.currentScene = null;\n            /**\n             * The root Scene. The Scene at the bottom of the Scene stack.\n             * @type enchant.Scene\n             */\n            this.rootScene = new enchant.Scene();\n            this.pushScene(this.rootScene);\n            /**\n             * The Scene to be displayed during loading.\n             * @type enchant.Scene\n             */\n            this.loadingScene = new enchant.LoadingScene();\n\n            /**\n             [/lang:ja]\n             * Indicates whether or not {@link enchant.Core#start} has been called.\n             [/lang]\n             * @type Boolean\n             * @private\n             */\n            this._activated = false;\n\n            this._offsetX = 0;\n            this._offsetY = 0;\n\n            /**\n             * Object that saves the current input state for the core.\n             * @type Object\n             */\n            this.input = {};\n\n            this.keyboardInputManager = new enchant.KeyboardInputManager(window.document, this.input);\n            this.keyboardInputManager.addBroadcastTarget(this);\n            this._keybind = this.keyboardInputManager._binds;\n\n            if (!enchant.ENV.KEY_BIND_TABLE) {\n                enchant.ENV.KEY_BIND_TABLE = {};\n            }\n\n            for (var prop in enchant.ENV.KEY_BIND_TABLE) {\n                this.keybind(prop, enchant.ENV.KEY_BIND_TABLE[prop]);\n            }\n\n            if (initial) {\n                stage = enchant.Core.instance._element;\n                var evt;\n                document.addEventListener('keydown', function(e) {\n                    core.dispatchEvent(new enchant.Event('keydown'));\n                    if (enchant.ENV.PREVENT_DEFAULT_KEY_CODES.indexOf(e.keyCode) !== -1) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                    }\n                }, true);\n\n                if (enchant.ENV.TOUCH_ENABLED) {\n                    stage.addEventListener('touchstart', function(e) {\n                        var tagName = (e.target.tagName).toLowerCase();\n                        if (enchant.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(tagName) === -1) {\n                            e.preventDefault();\n                            if (!core.running) {\n                                e.stopPropagation();\n                            }\n                        }\n                    }, true);\n                    stage.addEventListener('touchmove', function(e) {\n                        var tagName = (e.target.tagName).toLowerCase();\n                        if (enchant.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(tagName) === -1) {\n                            e.preventDefault();\n                            if (!core.running) {\n                                e.stopPropagation();\n                            }\n                        }\n                    }, true);\n                    stage.addEventListener('touchend', function(e) {\n                        var tagName = (e.target.tagName).toLowerCase();\n                        if (enchant.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(tagName) === -1) {\n                            e.preventDefault();\n                            if (!core.running) {\n                                e.stopPropagation();\n                            }\n                        }\n                    }, true);\n                }\n                stage.addEventListener('mousedown', function(e) {\n                    var tagName = (e.target.tagName).toLowerCase();\n                    if (enchant.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(tagName) === -1) {\n                        e.preventDefault();\n                        core._mousedownID++;\n                        if (!core.running) {\n                            e.stopPropagation();\n                        }\n                    }\n                }, true);\n                stage.addEventListener('mousemove', function(e) {\n                    var tagName = (e.target.tagName).toLowerCase();\n                    if (enchant.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(tagName) === -1) {\n                        e.preventDefault();\n                        if (!core.running) {\n                            e.stopPropagation();\n                        }\n                    }\n                }, true);\n                stage.addEventListener('mouseup', function(e) {\n                    var tagName = (e.target.tagName).toLowerCase();\n                    if (enchant.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(tagName) === -1) {\n                        e.preventDefault();\n                        if (!core.running) {\n                            e.stopPropagation();\n                        }\n                    }\n                }, true);\n                core._touchEventTarget = {};\n                if (enchant.ENV.TOUCH_ENABLED) {\n                    stage.addEventListener('touchstart', function(e) {\n                        var core = enchant.Core.instance;\n                        var evt = new enchant.Event(enchant.Event.TOUCH_START);\n                        var touches = e.changedTouches;\n                        var touch, target;\n                        for (var i = 0, l = touches.length; i < l; i++) {\n                            touch = touches[i];\n                            evt._initPosition(touch.pageX, touch.pageY);\n                            target = core.currentScene._determineEventTarget(evt);\n                            core._touchEventTarget[touch.identifier] = target;\n                            target.dispatchEvent(evt);\n                        }\n                    }, false);\n                    stage.addEventListener('touchmove', function(e) {\n                        var core = enchant.Core.instance;\n                        var evt = new enchant.Event(enchant.Event.TOUCH_MOVE);\n                        var touches = e.changedTouches;\n                        var touch, target;\n                        for (var i = 0, l = touches.length; i < l; i++) {\n                            touch = touches[i];\n                            target = core._touchEventTarget[touch.identifier];\n                            if (target) {\n                                evt._initPosition(touch.pageX, touch.pageY);\n                                target.dispatchEvent(evt);\n                            }\n                        }\n                    }, false);\n                    stage.addEventListener('touchend', function(e) {\n                        var core = enchant.Core.instance;\n                        var evt = new enchant.Event(enchant.Event.TOUCH_END);\n                        var touches = e.changedTouches;\n                        var touch, target;\n                        for (var i = 0, l = touches.length; i < l; i++) {\n                            touch = touches[i];\n                            target = core._touchEventTarget[touch.identifier];\n                            if (target) {\n                                evt._initPosition(touch.pageX, touch.pageY);\n                                target.dispatchEvent(evt);\n                                delete core._touchEventTarget[touch.identifier];\n                            }\n                        }\n                    }, false);\n                }\n                stage.addEventListener('mousedown', function(e) {\n                    var core = enchant.Core.instance;\n                    var evt = new enchant.Event(enchant.Event.TOUCH_START);\n                    evt._initPosition(e.pageX, e.pageY);\n                    var target = core.currentScene._determineEventTarget(evt);\n                    core._touchEventTarget[core._mousedownID] = target;\n                    target.dispatchEvent(evt);\n                }, false);\n                stage.addEventListener('mousemove', function(e) {\n                    var core = enchant.Core.instance;\n                    var evt = new enchant.Event(enchant.Event.TOUCH_MOVE);\n                    evt._initPosition(e.pageX, e.pageY);\n                    var target = core._touchEventTarget[core._mousedownID];\n                    if (target) {\n                        target.dispatchEvent(evt);\n                    }\n                }, false);\n                stage.addEventListener('mouseup', function(e) {\n                    var core = enchant.Core.instance;\n                    var evt = new enchant.Event(enchant.Event.TOUCH_END);\n                    evt._initPosition(e.pageX, e.pageY);\n                    var target = core._touchEventTarget[core._mousedownID];\n                    if (target) {\n                        target.dispatchEvent(evt);\n                    }\n                    delete core._touchEventTarget[core._mousedownID];\n                }, false);\n            }\n        },\n        /**\n         * The width of the core screen.\n         * @type Number\n         */\n        width: {\n            get: function() {\n                return this._width;\n            },\n            set: function(w) {\n                this._width = w;\n                this._dispatchCoreResizeEvent();\n            }\n        },\n        /**\n         * The height of the core screen.\n         * @type Number\n         */\n        height: {\n            get: function() {\n                return this._height;\n            },\n            set: function(h) {\n                this._height = h;\n                this._dispatchCoreResizeEvent();\n            }\n        },\n        /**\n         * The scaling of the core rendering.\n         * @type Number\n         */\n        scale: {\n            get: function() {\n                return this._scale;\n            },\n            set: function(s) {\n                this._scale = s;\n                this._dispatchCoreResizeEvent();\n            }\n        },\n        _dispatchCoreResizeEvent: function() {\n            var e = new enchant.Event('coreresize');\n            e.width = this._width;\n            e.height = this._height;\n            e.scale = this._scale;\n            this.dispatchEvent(e);\n        },\n        _oncoreresize: function(e) {\n            this._element.style.width = Math.floor(this._width * this._scale) + 'px';\n            this._element.style.height = Math.floor(this._height * this._scale) + 'px';\n            var scene;\n            for (var i = 0, l = this._scenes.length; i < l; i++) {\n                scene = this._scenes[i];\n                scene.dispatchEvent(e);\n            }\n        },\n        /**\n         * File preloader.\n         *\n         * Loads the files specified in the parameters when\n         * {@link enchant.Core#start} is called.\n         * When all files are loaded, a {@link enchant.Event.LOAD}\n         * event is dispatched from the Core object. Depending on the\n         * type of each file, different objects will be created and\n         * stored in {@link enchant.Core#assets} Variable.\n         *\n         * When an image file is loaded, a {@link enchant.Surface} is\n         * created. If a sound file is loaded, an {@link enchant.Sound}\n         * object is created. Any other file type will be accessible\n         * as a string.\n         *\n         * In addition, because this Surface object is created with\n         * {@link enchant.Surface.load}, it is not possible to\n         * manipulate the image directly.\n         * Refer to the {@link enchant.Surface.load} documentation.\n         *\n         * @example\n         * core.preload('player.gif');\n         * core.onload = function() {\n         *     var sprite = new Sprite(32, 32);\n         *     sprite.image = core.assets['player.gif']; // Access via path\n         *     ...\n         * };\n         * core.start();\n         *\n         * @param {...String|String[]} assets Path of images to be preloaded.\n         * Multiple settings possible.\n         * @return {enchant.Core} this\n         */\n        preload: function(assets) {\n            var a;\n            if (!(assets instanceof Array)) {\n                if (typeof assets === 'object') {\n                    a = [];\n                    for (var name in assets) {\n                        if (assets.hasOwnProperty(name)) {\n                            a.push([ assets[name], name ]);\n                        }\n                    }\n                    assets = a;\n                } else {\n                    assets = Array.prototype.slice.call(arguments);\n                }\n            }\n            Array.prototype.push.apply(this._assets, assets);\n            return this;\n        },\n        /**\n         * Loads a file.\n         *\n         * @param {String} src File path of the resource to be loaded.\n         * @param {String} [alias] Name you want to designate for the resource to be loaded.\n         * @param {Function} [callback] Function to be called if the file loads successfully.\n         * @param {Function} [onerror] Function to be called if the file fails to load.\n         * @return {enchant.Deferred}\n         */\n        load: function(src, alias, callback, onerror) {\n            var assetName;\n            if (typeof arguments[1] === 'string') {\n                assetName = alias;\n                callback = callback || function() {};\n                onerror = onerror || function() {};\n            } else {\n                assetName = src;\n                var tempCallback = callback;\n                callback = arguments[1] || function() {};\n                onerror = tempCallback || function() {};\n            }\n\n            var ext = enchant.Core.findExt(src);\n\n            return enchant.Deferred.next(function() {\n                var d = new enchant.Deferred();\n                var _callback = function(e) {\n                    d.call(e);\n                    callback.call(this, e);\n                };\n                var _onerror = function(e) {\n                    d.fail(e);\n                    onerror.call(this, e);\n                };\n                if (enchant.Core._loadFuncs[ext]) {\n                    enchant.Core.instance.assets[assetName] = enchant.Core._loadFuncs[ext](src, ext, _callback, _onerror);\n                } else {\n                    var req = new XMLHttpRequest();\n                    req.open('GET', src, true);\n                    req.onreadystatechange = function() {\n                        if (req.readyState === 4) {\n                            if (req.status !== 200 && req.status !== 0) {\n                                // throw new Error(req.status + ': ' + 'Cannot load an asset: ' + src);\n                                var e = new enchant.Event('error');\n                                e.message = req.status + ': ' + 'Cannot load an asset: ' + src;\n                                _onerror.call(enchant.Core.instance, e);\n                            }\n\n                            var type = req.getResponseHeader('Content-Type') || '';\n                            if (type.match(/^image/)) {\n                                core.assets[assetName] = enchant.Surface.load(src, _callback, _onerror);\n                            } else if (type.match(/^audio/)) {\n                                core.assets[assetName] = enchant.Sound.load(src, type, _callback, _onerror);\n                            } else {\n                                core.assets[assetName] = req.responseText;\n                                _callback.call(enchant.Core.instance, new enchant.Event('load'));\n                            }\n                        }\n                    };\n                    req.send(null);\n                }\n                return d;\n            });\n        },\n        /**\n         * Start the core.\n         *\n         * Sets the framerate of the {@link enchant.Core#currentScene}\n         * according to the value stored in {@link enchant.core#fps}. If\n         * there are images to preload, loading will begin and the\n         * loading screen will be displayed.\n         * @return {enchant.Deferred}\n         */\n        start: function(deferred) {\n            var onloadTimeSetter = function() {\n                this.frame = 0;\n                this.removeEventListener('load', onloadTimeSetter);\n            };\n            this.addEventListener('load', onloadTimeSetter);\n\n            this.currentTime = window.getTime();\n            this.running = true;\n            this.ready = true;\n\n            if (!this._activated) {\n                this._activated = true;\n                if (enchant.ENV.BROWSER === 'mobilesafari' &&\n                    enchant.ENV.USE_WEBAUDIO &&\n                    enchant.ENV.USE_TOUCH_TO_START_SCENE) {\n                    var d = new enchant.Deferred();\n                    var scene = this._createTouchToStartScene();\n                    scene.addEventListener(enchant.Event.TOUCH_START, function waitTouch() {\n                        this.removeEventListener(enchant.Event.TOUCH_START, waitTouch);\n                        var a = new enchant.WebAudioSound();\n                        a.buffer = enchant.WebAudioSound.audioContext.createBuffer(1, 1, 48000);\n                        a.play();\n                        core.removeScene(scene);\n                        core.start(d);\n                    }, false);\n                    core.pushScene(scene);\n                    return d;\n                }\n            }\n\n            this._requestNextFrame(0);\n\n            var ret = this._requestPreload()\n                .next(function() {\n                    enchant.Core.instance.loadingScene.dispatchEvent(new enchant.Event(enchant.Event.LOAD));\n                });\n\n            if (deferred) {\n                ret.next(function(arg) {\n                    deferred.call(arg);\n                })\n                .error(function(arg) {\n                    deferred.fail(arg);\n                });\n            }\n\n            return ret;\n        },\n        _requestPreload: function() {\n            var o = {};\n            var loaded = 0,\n                len = 0,\n                loadFunc = function() {\n                    var e = new enchant.Event('progress');\n                    e.loaded = ++loaded;\n                    e.total = len;\n                    core.loadingScene.dispatchEvent(e);\n                };\n            this._assets\n                .reverse()\n                .forEach(function(asset) {\n                    var src, name;\n                    if (asset instanceof Array) {\n                        src = asset[0];\n                        name = asset[1];\n                    } else {\n                        src = name = asset;\n                    }\n                    if (!o[name]) {\n                        o[name] = this.load(src, name, loadFunc);\n                        len++;\n                    }\n                }, this);\n\n            this.pushScene(this.loadingScene);\n            return enchant.Deferred.parallel(o);\n        },\n        _createTouchToStartScene: function() {\n            var label = new enchant.Label('Touch to Start'),\n                size = Math.round(core.width / 10),\n                scene = new enchant.Scene();\n\n            label.color = '#fff';\n            label.font = (size - 1) + 'px bold Helvetica,Arial,sans-serif';\n            label.textAlign = 'center';\n            label.width = core.width;\n            label.height = label._boundHeight;\n            label.y = (core.height - label.height) / 2;\n\n            scene.backgroundColor = '#000';\n            scene.addChild(label);\n\n            return scene;\n        },\n        /**\n         * Start application in debug mode.\n         *\n         * Core debug mode can be turned on even if the\n         * {@link enchant.Core#_debug} flag is already set to true.\n         * @return {enchant.Deferred}\n         */\n        debug: function() {\n            this._debug = true;\n            return this.start();\n        },\n        actualFps: {\n            get: function() {\n                return this._actualFps || this.fps;\n            }\n        },\n        /**\n         * Requests the next frame.\n         * @param {Number} delay Amount of time to delay before calling requestAnimationFrame.\n         * @private\n         */\n        _requestNextFrame: function(delay) {\n            if (!this.ready) {\n                return;\n            }\n            if (this.fps >= 60 || delay <= 16) {\n                this._calledTime = window.getTime();\n                window.requestAnimationFrame(this._callTick);\n            } else {\n                setTimeout(function() {\n                    var core = enchant.Core.instance;\n                    core._calledTime = window.getTime();\n                    window.requestAnimationFrame(core._callTick);\n                }, Math.max(0, delay));\n            }\n        },\n        /**\n         * Calls {@link enchant.Core#_tick}.\n         * @param {Number} time\n         * @private\n         */\n        _callTick: function(time) {\n            enchant.Core.instance._tick(time);\n        },\n        _tick: function(time) {\n            var e = new enchant.Event('enterframe');\n            var now = window.getTime();\n            var elapsed = e.elapsed = now - this.currentTime;\n            this.currentTime = now;\n\n            this._actualFps = elapsed > 0 ? (1000 / elapsed) : 0;\n\n            var nodes = this.currentScene.childNodes.slice();\n            var push = Array.prototype.push;\n            while (nodes.length) {\n                var node = nodes.pop();\n                node.age++;\n                node.dispatchEvent(e);\n                if (node.childNodes) {\n                    push.apply(nodes, node.childNodes);\n                }\n            }\n\n            this.currentScene.age++;\n            this.currentScene.dispatchEvent(e);\n            this.dispatchEvent(e);\n\n            this.dispatchEvent(new enchant.Event('exitframe'));\n            this.frame++;\n            now = window.getTime();\n            \n            this._requestNextFrame(1000 / this.fps - (now - this._calledTime));\n        },\n        getTime: function() {\n            return window.getTime();\n        },\n        /**\n         * Stops the core.\n         *\n         * The frame will not be updated, and player input will not be accepted anymore.\n         * Core can be restarted using {@link enchant.Core#resume}.\n         */\n        stop: function() {\n            this.ready = false;\n            this.running = false;\n        },\n        /**\n         * Stops the core.\n         *\n         * The frame will not be updated, and player input will not be accepted anymore.\n         * Core can be started again using {@link enchant.Core#resume}.\n         */\n        pause: function() {\n            this.ready = false;\n        },\n        /**\n         * Resumes core operations.\n         */\n        resume: function() {\n            if (this.ready) {\n                return;\n            }\n            this.currentTime = window.getTime();\n            this.ready = true;\n            this.running = true;\n            this._requestNextFrame(0);\n        },\n\n        /**\n         * Switches to a new Scene.\n         *\n         * Scenes are controlled using a stack, with the top scene on\n         * the stack being the one displayed.\n         * When {@link enchant.Core#pushScene} is executed, the Scene is\n         * placed top of the stack. Frames will be only updated for the\n         * Scene which is on the top of the stack.\n         *\n         * @param {enchant.Scene} scene The new scene to display.\n         * @return {enchant.Scene} The new Scene.\n         */\n        pushScene: function(scene) {\n            this._element.appendChild(scene._element);\n            if (this.currentScene) {\n                this.currentScene.dispatchEvent(new enchant.Event('exit'));\n            }\n            this.currentScene = scene;\n            this.currentScene.dispatchEvent(new enchant.Event('enter'));\n            return this._scenes.push(scene);\n        },\n        /**\n         * Ends the current Scene and returns to the previous Scene.\n         *\n         * Scenes are controlled using a stack, with the top scene on\n         * the stack being the one displayed.\n         * When {@link enchant.Core#popScene} is executed, the Scene at\n         * the top of the stack is removed and returned.\n         *\n         * @return {enchant.Scene} Removed Scene.\n         */\n        popScene: function() {\n            if (this.currentScene === this.rootScene) {\n                return this.currentScene;\n            }\n            this._element.removeChild(this.currentScene._element);\n            this.currentScene.dispatchEvent(new enchant.Event('exit'));\n            this.currentScene = this._scenes[this._scenes.length - 2];\n            this.currentScene.dispatchEvent(new enchant.Event('enter'));\n            return this._scenes.pop();\n        },\n        /**\n         * Overwrites the current Scene with a new Scene.\n         *\n         * Executes {@link enchant.Core#popScene} and {@link enchant.Core#pushScene}\n         * one after another to replace the current scene with the new scene.\n         *\n         * @param {enchant.Scene} scene The new scene with which to replace the current scene.\n         * @return {enchant.Scene} The new Scene.\n         */\n        replaceScene: function(scene) {\n            this.popScene();\n            return this.pushScene(scene);\n        },\n        /**\n         * Removes a Scene from the Scene stack.\n         *\n         * If the scene passed in as a parameter is not the current\n         * scene, the stack will be searched for the given scene.\n         * If the given scene does not exist anywhere in the stack,\n         * this method returns null.\n         *\n         * @param {enchant.Scene} scene Scene to be removed.\n         * @return {enchant.Scene} The deleted Scene.\n         */\n        removeScene: function(scene) {\n            if (this.currentScene === scene) {\n                return this.popScene();\n            } else {\n                var i = this._scenes.indexOf(scene);\n                if (i !== -1) {\n                    this._scenes.splice(i, 1);\n                    this._element.removeChild(scene._element);\n                    return scene;\n                } else {\n                    return null;\n                }\n            }\n        },\n        _buttonListener: function(e) {\n            this.currentScene.dispatchEvent(e);\n        },\n        /**\n         * Bind a key code to an enchant.js button.\n         *\n         * Binds the given key code to the given enchant.js button\n         * ('left', 'right', 'up', 'down', 'a', 'b').\n         *\n         * @param {Number} key Key code for the button to be bound.\n         * @param {String} button An enchant.js button.\n         * @return {enchant.Core} this\n         */\n        keybind: function(key, button) {\n            this.keyboardInputManager.keybind(key, button);\n            this.addEventListener(button + 'buttondown', this._buttonListener);\n            this.addEventListener(button + 'buttonup', this._buttonListener);\n            return this;\n        },\n        /**\n         * Delete the key binding for the given key.\n         *\n         * @param {Number} key Key code whose binding is to be deleted.\n         * @return {enchant.Core} this\n         */\n        keyunbind: function(key) {\n            var button = this._keybind[key];\n            this.keyboardInputManager.keyunbind(key);\n            this.removeEventListener(button + 'buttondown', this._buttonListener);\n            this.removeEventListener(button + 'buttonup', this._buttonListener);\n            return this;\n        },\n        changeButtonState: function(button, bool) {\n            this.keyboardInputManager.changeState(button, bool);\n        },\n        /**\n         * Get the core time (not actual) elapsed since {@link enchant.Core#start} was called.\n         * @return {Number} Time elapsed (in seconds).\n         */\n        getElapsedTime: function() {\n            return this.frame / this.fps;\n        }\n    });\n\n    /**\n     * Functions for loading assets of the corresponding file type.\n     * The loading functions must take the file path, extension and\n     * callback function as arguments, then return the appropriate\n     * class instance.\n     * @static\n     * @private\n     * @type Object\n     */\n    enchant.Core._loadFuncs = {};\n    enchant.Core._loadFuncs['jpg'] =\n        enchant.Core._loadFuncs['jpeg'] =\n            enchant.Core._loadFuncs['gif'] =\n                enchant.Core._loadFuncs['png'] =\n                    enchant.Core._loadFuncs['bmp'] = function(src, ext, callback, onerror) {\n                        return enchant.Surface.load(src, callback, onerror);\n                    };\n    enchant.Core._loadFuncs['mp3'] =\n        enchant.Core._loadFuncs['aac'] =\n            enchant.Core._loadFuncs['m4a'] =\n                enchant.Core._loadFuncs['wav'] =\n                    enchant.Core._loadFuncs['ogg'] = function(src, ext, callback, onerror) {\n                        return enchant.Sound.load(src, 'audio/' + ext, callback, onerror);\n                    };\n\n    /**\n     * Get the file extension from a path.\n     * @param {String} path file path.\n     * @return {*}\n     */\n    enchant.Core.findExt = function(path) {\n        var matched = path.match(/\\.\\w+$/);\n        if (matched && matched.length > 0) {\n            return matched[0].slice(1).toLowerCase();\n        }\n\n        // for data URI\n        if (path.indexOf('data:') === 0) {\n            return path.split(/[\\/;]/)[1].toLowerCase();\n        }\n        return null;\n    };\n\n    /**\n     * The current Core instance.\n     * @type enchant.Core\n     * @static\n     */\n    enchant.Core.instance = null;\n}());\n\n/**\n * @name enchant.Game\n * @class\n * enchant.Game is moved to {@link enchant.Core} from v0.6\n * @deprecated\n */\nenchant.Game = enchant.Core;\n\n/**\n * @scope enchant.InputManager.prototype\n */\nenchant.InputManager = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.InputManager\n     * @class\n     * Class for managing input.\n     * @param {*} valueStore object that store input state.\n     * @param {*} [source=this] source that will be added to event object.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function(valueStore, source) {\n        enchant.EventTarget.call(this);\n\n        /**\n         * Array that store event target.\n         * @type enchant.EventTarget[]\n         */\n        this.broadcastTarget = [];\n        /**\n         * Object that store input state.\n         * @type Object\n         */\n        this.valueStore = valueStore;\n        /**\n         * source that will be added to event object.\n         * @type Object\n         */\n        this.source = source || this;\n\n        this._binds = {};\n\n        this._stateHandler = function(e) {\n            var id = e.source.identifier;\n            var name = this._binds[id];\n            this.changeState(name, e.data);\n        }.bind(this);\n    },\n    /**\n     * Name specified input.\n     * Input can be watched by flag or event.\n     * @param {enchant.InputSource} inputSource input source.\n     * @param {String} name input name.\n     */\n    bind: function(inputSource, name) {\n        inputSource.addEventListener(enchant.Event.INPUT_STATE_CHANGED, this._stateHandler);\n        this._binds[inputSource.identifier] = name;\n    },\n    /**\n     * Remove binded name.\n     * @param {enchant.InputSource} inputSource input source.\n     */\n    unbind: function(inputSource) {\n        inputSource.removeEventListener(enchant.Event.INPUT_STATE_CHANGED, this._stateHandler);\n        delete this._binds[inputSource.identifier];\n    },\n    /**\n     * Add event target.\n     * @param {enchant.EventTarget} eventTarget broadcast target.\n     */\n    addBroadcastTarget: function(eventTarget) {\n        var i = this.broadcastTarget.indexOf(eventTarget);\n        if (i === -1) {\n            this.broadcastTarget.push(eventTarget);\n        }\n    },\n    /**\n     * Remove event target.\n     * @param {enchant.EventTarget} eventTarget broadcast target.\n     */\n    removeBroadcastTarget: function(eventTarget) {\n        var i = this.broadcastTarget.indexOf(eventTarget);\n        if (i !== -1) {\n            this.broadcastTarget.splice(i, 1);\n        }\n    },\n    /**\n     * Dispatch event to {@link enchant.InputManager#broadcastTarget}.\n     * @param {enchant.Event} e event.\n     */\n    broadcastEvent: function(e) {\n        var target = this.broadcastTarget;\n        for (var i = 0, l = target.length; i < l; i++) {\n            target[i].dispatchEvent(e);\n        }\n    },\n    /**\n     * Change state of input.\n     * @param {String} name input name.\n     * @param {*} data input state.\n     */\n    changeState: function(name, data) {\n    }\n});\n\n/**\n * @scope enchant.InputSource.prototype\n */\nenchant.InputSource = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.InputSource\n     * @class\n     * Class that wrap input.\n     * @param {String} identifier identifier of InputSource.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function(identifier) {\n        enchant.EventTarget.call(this);\n        /**\n         * identifier of InputSource.\n         * @type String\n         */\n        this.identifier = identifier;\n    },\n    /**\n     * Notify state change by event.\n     * @param {*} data state.\n     */\n    notifyStateChange: function(data) {\n        var e = new enchant.Event(enchant.Event.INPUT_STATE_CHANGED);\n        e.data = data;\n        e.source = this;\n        this.dispatchEvent(e);\n    }\n});\n\n/**\n * @scope enchant.BinaryInputManager.prototype\n */\nenchant.BinaryInputManager = enchant.Class.create(enchant.InputManager, {\n    /**\n     * @name enchant.BinaryInputManager\n     * @class\n     * Class for managing input.\n     * @param {*} flagStore object that store input flag.\n     * @param {String} activeEventNameSuffix event name suffix.\n     * @param {String} inactiveEventNameSuffix event name suffix.\n     * @param {*} [source=this] source that will be added to event object.\n     * @constructs\n     * @extends enchant.InputManager\n     */\n    initialize: function(flagStore, activeEventNameSuffix, inactiveEventNameSuffix, source) {\n        enchant.InputManager.call(this, flagStore, source);\n        /**\n         * The number of active inputs.\n         * @type Number\n         */\n        this.activeInputsNum = 0;\n        /**\n         * event name suffix that dispatched by BinaryInputManager.\n         * @type String\n         */\n        this.activeEventNameSuffix = activeEventNameSuffix;\n        /**\n         * event name suffix that dispatched by BinaryInputManager.\n         * @type String\n         */\n        this.inactiveEventNameSuffix = inactiveEventNameSuffix;\n    },\n    /**\n     * Name specified input.\n     * @param {enchant.BinaryInputSource} inputSource input source.\n     * @param {String} name input name.\n     * @see enchant.InputManager#bind\n     */\n    bind: function(binaryInputSource, name) {\n        enchant.InputManager.prototype.bind.call(this, binaryInputSource, name);\n        this.valueStore[name] = false;\n    },\n    /**\n     * Remove binded name.\n     * @param {enchant.BinaryInputSource} inputSource input source.\n     * @see enchant.InputManager#unbind\n     */\n    unbind: function(binaryInputSource) {\n        var name = this._binds[binaryInputSource.identifier];\n        enchant.InputManager.prototype.unbind.call(this, binaryInputSource);\n        delete this.valueStore[name];\n    },\n    /**\n     * Change state of input.\n     * @param {String} name input name.\n     * @param {Boolean} bool input state.\n     */\n    changeState: function(name, bool) {\n        if (bool) {\n            this._down(name);\n        } else {\n            this._up(name);\n        }\n    },\n    _down: function(name) {\n        var inputEvent;\n        if (!this.valueStore[name]) {\n            this.valueStore[name] = true;\n            inputEvent = new enchant.Event((this.activeInputsNum++) ? 'inputchange' : 'inputstart');\n            inputEvent.source = this.source;\n            this.broadcastEvent(inputEvent);\n        }\n        var downEvent = new enchant.Event(name + this.activeEventNameSuffix);\n        downEvent.source = this.source;\n        this.broadcastEvent(downEvent);\n    },\n    _up: function(name) {\n        var inputEvent;\n        if (this.valueStore[name]) {\n            this.valueStore[name] = false;\n            inputEvent = new enchant.Event((--this.activeInputsNum) ? 'inputchange' : 'inputend');\n            inputEvent.source = this.source;\n            this.broadcastEvent(inputEvent);\n        }\n        var upEvent = new enchant.Event(name + this.inactiveEventNameSuffix);\n        upEvent.source = this.source;\n        this.broadcastEvent(upEvent);\n    }\n});\n\n/**\n * @scope enchant.BinaryInputSource.prototype\n */\nenchant.BinaryInputSource = enchant.Class.create(enchant.InputSource, {\n    /**\n     * @name enchant.BinaryInputSource\n     * @class\n     * Class that wrap binary input.\n     * @param {String} identifier identifier of BinaryInputSource.\n     * @constructs\n     * @extends enchant.InputSource\n     */\n    initialize: function(identifier) {\n        enchant.InputSource.call(this, identifier);\n    }\n});\n\n/**\n * @scope enchant.KeyboardInputManager.prototype\n */\nenchant.KeyboardInputManager = enchant.Class.create(enchant.BinaryInputManager, {\n    /**\n     * @name enchant.KeyboardInputManager\n     * @class\n     * Class that manage keyboard input.\n     * @param {HTMLElement} dom element that will be watched.\n     * @param {*} flagStore object that store input flag.\n     * @constructs\n     * @extends enchant.BinaryInputManager\n     */\n    initialize: function(domElement, flagStore) {\n        enchant.BinaryInputManager.call(this, flagStore, 'buttondown', 'buttonup');\n        this._attachDOMEvent(domElement, 'keydown', true);\n        this._attachDOMEvent(domElement, 'keyup', false);\n    },\n    /**\n     * Call {@link enchant.BinaryInputManager#bind} with BinaryInputSource equivalent of key code.\n     * @param {Number} keyCode key code.\n     * @param {String} name input name.\n     */\n    keybind: function(keyCode, name) {\n        this.bind(enchant.KeyboardInputSource.getByKeyCode('' + keyCode), name);\n    },\n    /**\n     * Call {@link enchant.BinaryInputManager#unbind} with BinaryInputSource equivalent of key code.\n     * @param {Number} keyCode key code.\n     */\n    keyunbind: function(keyCode) {\n        this.unbind(enchant.KeyboardInputSource.getByKeyCode('' + keyCode));\n    },\n    _attachDOMEvent: function(domElement, eventType, state) {\n        domElement.addEventListener(eventType, function(e) {\n            var core = enchant.Core.instance;\n            if (!core || !core.running) {\n                return;\n            }\n            var code = e.keyCode;\n            var source = enchant.KeyboardInputSource._instances[code];\n            if (source) {\n                source.notifyStateChange(state);\n            }\n        }, true);\n    }\n});\n\n/**\n * @scope enchant.KeyboardInputSource.prototype\n */\nenchant.KeyboardInputSource = enchant.Class.create(enchant.BinaryInputSource, {\n    /**\n     * @name enchant.KeyboardInputSource\n     * @class\n     * @param {String} keyCode key code of BinaryInputSource.\n     * @constructs\n     * @extends enchant.BinaryInputSource\n     */\n    initialize: function(keyCode) {\n        enchant.BinaryInputSource.call(this, keyCode);\n    }\n});\n/**\n * @private\n */\nenchant.KeyboardInputSource._instances = {};\n/**\n * @static\n * Get the instance by key code.\n * @param {Number} keyCode key code.\n * @return {enchant.KeyboardInputSource} instance.\n */\nenchant.KeyboardInputSource.getByKeyCode = function(keyCode) {\n    if (!this._instances[keyCode]) {\n        this._instances[keyCode] = new enchant.KeyboardInputSource(keyCode);\n    }\n    return this._instances[keyCode];\n};\n\n/**\n * @scope enchant.Node.prototype\n */\nenchant.Node = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.Node\n     * @class\n     * Base class for objects in the display tree which is rooted at a Scene.\n     * Not to be used directly.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function() {\n        enchant.EventTarget.call(this);\n\n        this._dirty = false;\n\n        this._matrix = [ 1, 0, 0, 1, 0, 0 ];\n\n        this._x = 0;\n        this._y = 0;\n        this._offsetX = 0;\n        this._offsetY = 0;\n\n        /**\n         * The age (frames) of this node which will be increased before this node receives {@link enchant.Event.ENTER_FRAME} event.\n         * @type Number\n         */\n        this.age = 0;\n\n        /**\n         * Parent Node of this Node.\n         * @type enchant.Group\n         */\n        this.parentNode = null;\n        /**\n         * Scene to which Node belongs.\n         * @type enchant.Scene\n         */\n        this.scene = null;\n\n        this.addEventListener('touchstart', function(e) {\n            if (this.parentNode) {\n                this.parentNode.dispatchEvent(e);\n            }\n        });\n        this.addEventListener('touchmove', function(e) {\n            if (this.parentNode) {\n                this.parentNode.dispatchEvent(e);\n            }\n        });\n        this.addEventListener('touchend', function(e) {\n            if (this.parentNode) {\n                this.parentNode.dispatchEvent(e);\n            }\n        });\n\n        // Nodeが生成される際に, tl プロパティに Timeline オブジェクトを追加している.\n        if (enchant.ENV.USE_ANIMATION) {\n            this.tl = new enchant.Timeline(this);\n        }\n    },\n    /**\n     * Move the Node to the given target location.\n     * @param {Number} x Target x coordinates.\n     * @param {Number} y Target y coordinates.\n     */\n    moveTo: function(x, y) {\n        this.x = x;\n        this.y = y;\n    },\n    /**\n     * Move the Node relative to its current position.\n     * @param {Number} x x axis movement distance.\n     * @param {Number} y y axis movement distance.\n     */\n    moveBy: function(x, y) {\n        this.x += x;\n        this.y += y;\n    },\n    /**\n     * x coordinates of the Node.\n     * @type Number\n     */\n    x: {\n        get: function() {\n            return this._x;\n        },\n        set: function(x) {\n            if(this._x !== x) {\n                this._x = x;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * y coordinates of the Node.\n     * @type Number\n     */\n    y: {\n        get: function() {\n            return this._y;\n        },\n        set: function(y) {\n            if(this._y !== y) {\n                this._y = y;\n                this._dirty = true;\n            }\n        }\n    },\n    _updateCoordinate: function() {\n        var node = this;\n        var tree = [ node ];\n        var parent = node.parentNode;\n        var scene = this.scene;\n        while (parent && node._dirty) {\n            tree.unshift(parent);\n            node = node.parentNode;\n            parent = node.parentNode;\n        }\n        var matrix = enchant.Matrix.instance;\n        var stack = matrix.stack;\n        var mat = [];\n        var newmat, ox, oy;\n        stack.push(tree[0]._matrix);\n        for (var i = 1, l = tree.length; i < l; i++) {\n            node = tree[i];\n            newmat = [];\n            matrix.makeTransformMatrix(node, mat);\n            matrix.multiply(stack[stack.length - 1], mat, newmat);\n            node._matrix = newmat;\n            stack.push(newmat);\n            ox = (typeof node._originX === 'number') ? node._originX : node._width / 2 || 0;\n            oy = (typeof node._originY === 'number') ? node._originY : node._height / 2 || 0;\n            var vec = [ ox, oy ];\n            matrix.multiplyVec(newmat, vec, vec);\n            node._offsetX = vec[0] - ox;\n            node._offsetY = vec[1] - oy;\n            node._dirty = false;\n        }\n        matrix.reset();\n    },\n    remove: function() {\n        if (this.parentNode) {\n            this.parentNode.removeChild(this);\n        }\n        if (this.childNodes) {\n            var childNodes = this.childNodes.slice();\n            for(var i = childNodes.length-1; i >= 0; i--) {\n                childNodes[i].remove();\n            }\n        }\n        \n        this.clearEventListener();\n    }\n});\n\nvar _intersectBetweenClassAndInstance = function(Class, instance) {\n    var ret = [];\n    var c;\n    for (var i = 0, l = Class.collection.length; i < l; i++) {\n        c = Class.collection[i];\n        if (instance._intersectOne(c)) {\n            ret.push(c);\n        }\n    }\n    return ret;\n};\n\nvar _intersectBetweenClassAndClass = function(Class1, Class2) {\n    var ret = [];\n    var c1, c2;\n    for (var i = 0, l = Class1.collection.length; i < l; i++) {\n        c1 = Class1.collection[i];\n        for (var j = 0, ll = Class2.collection.length; j < ll; j++) {\n            c2 = Class2.collection[j];\n            if (c1._intersectOne(c2)) {\n                ret.push([ c1, c2 ]);\n            }\n        }\n    }\n    return ret;\n};\n\nvar _intersectStrictBetweenClassAndInstance = function(Class, instance) {\n    var ret = [];\n    var c;\n    for (var i = 0, l = Class.collection.length; i < l; i++) {\n        c = Class.collection[i];\n        if (instance._intersectStrictOne(c)) {\n            ret.push(c);\n        }\n    }\n    return ret;\n};\n\nvar _intersectStrictBetweenClassAndClass = function(Class1, Class2) {\n    var ret = [];\n    var c1, c2;\n    for (var i = 0, l = Class1.collection.length; i < l; i++) {\n        c1 = Class1.collection[i];\n        for (var j = 0, ll = Class2.collection.length; j < ll; j++) {\n            c2 = Class2.collection[j];\n            if (c1._intersectStrictOne(c2)) {\n                ret.push([ c1, c2 ]);\n            }\n        }\n    }\n    return ret;\n};\n\nvar _staticIntersect = function(other) {\n    if (other instanceof enchant.Entity) {\n        return _intersectBetweenClassAndInstance(this, other);\n    } else if (typeof other === 'function' && other.collection) {\n        return _intersectBetweenClassAndClass(this, other);\n    }\n    return false;\n};\n\nvar _staticIntersectStrict = function(other) {\n    if (other instanceof enchant.Entity) {\n        return _intersectStrictBetweenClassAndInstance(this, other);\n    } else if (typeof other === 'function' && other.collection) {\n        return _intersectStrictBetweenClassAndClass(this, other);\n    }\n    return false;\n};\n\nvar _nodePrototypeClearEventListener = enchant.Node.prototype.clearEventListener;\n\n/**\n * @scope enchant.Entity.prototype\n */\nenchant.Entity = enchant.Class.create(enchant.Node, {\n    /**\n     * @name enchant.Entity\n     * @class\n     * A class with objects displayed as DOM elements. Not to be used directly.\n     * @constructs\n     * @extends enchant.Node\n     */\n    initialize: function() {\n        var core = enchant.Core.instance;\n        enchant.Node.call(this);\n\n        this._rotation = 0;\n        this._scaleX = 1;\n        this._scaleY = 1;\n\n        this._touchEnabled = true;\n        this._clipping = false;\n\n        this._originX = null;\n        this._originY = null;\n\n        this._width = 0;\n        this._height = 0;\n        this._backgroundColor = null;\n        this._debugColor = '#0000ff';\n        this._opacity = 1;\n        this._visible = true;\n        this._buttonMode = null;\n\n        this._style = {};\n        this.__styleStatus = {};\n\n        this._isContainedInCollection = false;\n\n        /**\n         * @type String\n         */\n        this.compositeOperation = null;\n\n        /**\n         * Defines this Entity as a button.\n         * When touched or clicked the corresponding button event is dispatched.\n         * Valid buttonModes are: left, right, up, down, a, b. \n         * @type String\n         */\n        this.buttonMode = null;\n        /**\n         * Indicates if this Entity is being clicked.\n         * Only works when {@link enchant.Entity.buttonMode} is set.\n         * @type Boolean\n         */\n        this.buttonPressed = false;\n        this.addEventListener('touchstart', function() {\n            if (!this.buttonMode) {\n                return;\n            }\n            this.buttonPressed = true;\n            this.dispatchEvent(new enchant.Event(this.buttonMode + 'buttondown'));\n            core.changeButtonState(this.buttonMode, true);\n        });\n        this.addEventListener('touchend', function() {\n            if (!this.buttonMode) {\n                return;\n            }\n            this.buttonPressed = false;\n            this.dispatchEvent(new enchant.Event(this.buttonMode + 'buttonup'));\n            core.changeButtonState(this.buttonMode, false);\n        });\n\n        this.enableCollection();\n    },\n    /**\n     * The width of the Entity.\n     * @type Number\n     */\n    width: {\n        get: function() {\n            return this._width;\n        },\n        set: function(width) {\n            if(this._width !== width) {\n                this._width = width;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * The height of the Entity.\n     * @type Number\n     */\n    height: {\n        get: function() {\n            return this._height;\n        },\n        set: function(height) {\n            if(this._height !== height) {\n                this._height = height;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * The Entity background color.\n     * Must be provided in the same format as the CSS 'color' property.\n     * @type String\n     */\n    backgroundColor: {\n        get: function() {\n            return this._backgroundColor;\n        },\n        set: function(color) {\n            this._backgroundColor = color;\n        }\n    },\n    /**\n     * The Entity debug color.\n     * Must be provided in the same format as the CSS 'color' property.\n     * @type String\n     */\n    debugColor: {\n        get: function() {\n            return this._debugColor;\n        },\n        set: function(color) {\n            this._debugColor = color;\n        }\n    },\n    /**\n     * The transparency of this entity.\n     * Defines the transparency level from 0 to 1\n     * (0 is completely transparent, 1 is completely opaque).\n     * @type Number\n     */\n    opacity: {\n        get: function() {\n            return this._opacity;\n        },\n        set: function(opacity) {\n            this._opacity = parseFloat(opacity);\n        }\n    },\n    /**\n     * Indicates whether or not to display this Entity.\n     * @type Boolean\n     */\n    visible: {\n        get: function() {\n            return this._visible;\n        },\n        set: function(visible) {\n            this._visible = visible;\n        }\n    },\n    /**\n     * Indicates whether or not this Entity can be touched.\n     * @type Boolean\n     */\n    touchEnabled: {\n        get: function() {\n            return this._touchEnabled;\n        },\n        set: function(enabled) {\n            this._touchEnabled = enabled;\n            if (enabled) {\n                this._style.pointerEvents = 'all';\n            } else {\n                this._style.pointerEvents = 'none';\n            }\n        }\n    },\n    /**\n     * Performs a collision detection based on whether or not the bounding rectangles are intersecting.\n     * @param {*} other An object like Entity, with the properties x, y, width, height, which are used for the \n     * collision detection.\n     * @return {Boolean} True, if a collision was detected.\n     */\n    intersect: function(other) {\n        if (other instanceof enchant.Entity) {\n            return this._intersectOne(other);\n        } else if (typeof other === 'function' && other.collection) {\n            return _intersectBetweenClassAndInstance(other, this);\n        }\n        return false;\n    },\n    _intersectOne: function(other) {\n        if (this._dirty) {\n            this._updateCoordinate();\n        } if (other._dirty) {\n            other._updateCoordinate();\n        }\n        return this._offsetX < other._offsetX + other.width && other._offsetX < this._offsetX + this.width &&\n            this._offsetY < other._offsetY + other.height && other._offsetY < this._offsetY + this.height;\n    },\n    intersectStrict: function(other) {\n        if (other instanceof enchant.Entity) {\n            return this._intersectStrictOne(other);\n        } else if (typeof other === 'function' && other.collection) {\n            return _intersectStrictBetweenClassAndInstance(other, this);\n        }\n        return false;\n    },\n    _intersectStrictOne: function(other) {\n        if (this._dirty) {\n            this._updateCoordinate();\n        } if (other._dirty) {\n            other._updateCoordinate();\n        }\n        var rect1 = this.getOrientedBoundingRect(),\n            rect2 = other.getOrientedBoundingRect(),\n            lt1 = rect1.leftTop, rt1 = rect1.rightTop,\n            lb1 = rect1.leftBottom, rb1 = rect1.rightBottom,\n            lt2 = rect2.leftTop, rt2 = rect2.rightTop,\n            lb2 = rect2.leftBottom, rb2 = rect2.rightBottom,\n            ltx1 = lt1[0], lty1 = lt1[1], rtx1 = rt1[0], rty1 = rt1[1],\n            lbx1 = lb1[0], lby1 = lb1[1], rbx1 = rb1[0], rby1 = rb1[1],\n            ltx2 = lt2[0], lty2 = lt2[1], rtx2 = rt2[0], rty2 = rt2[1],\n            lbx2 = lb2[0], lby2 = lb2[1], rbx2 = rb2[0], rby2 = rb2[1],\n            t1 = [ rtx1 - ltx1, rty1 - lty1 ],\n            r1 = [ rbx1 - rtx1, rby1 - rty1 ],\n            b1 = [ lbx1 - rbx1, lby1 - rby1 ],\n            l1 = [ ltx1 - lbx1, lty1 - lby1 ],\n            t2 = [ rtx2 - ltx2, rty2 - lty2 ],\n            r2 = [ rbx2 - rtx2, rby2 - rty2 ],\n            b2 = [ lbx2 - rbx2, lby2 - rby2 ],\n            l2 = [ ltx2 - lbx2, lty2 - lby2 ],\n            cx1 = (ltx1 + rtx1 + lbx1 + rbx1) >> 2,\n            cy1 = (lty1 + rty1 + lby1 + rby1) >> 2,\n            cx2 = (ltx2 + rtx2 + lbx2 + rbx2) >> 2,\n            cy2 = (lty2 + rty2 + lby2 + rby2) >> 2,\n            i, j, poss1, poss2, dirs1, dirs2, pos1, pos2, dir1, dir2,\n            px1, py1, px2, py2, dx1, dy1, dx2, dy2, vx, vy, c, c1, c2;\n        if (t1[0] * (cy2 - lty1) - t1[1] * (cx2 - ltx1) > 0 &&\n            r1[0] * (cy2 - rty1) - r1[1] * (cx2 - rtx1) > 0 &&\n            b1[0] * (cy2 - rby1) - b1[1] * (cx2 - rbx1) > 0 &&\n            l1[0] * (cy2 - lby1) - l1[1] * (cx2 - lbx1) > 0) {\n            return true;\n        } else if (t2[0] * (cy1 - lty2) - t2[1] * (cx1 - ltx2) > 0 &&\n            r2[0] * (cy1 - rty2) - r2[1] * (cx1 - rtx2) > 0 &&\n            b2[0] * (cy1 - rby2) - b2[1] * (cx1 - rbx2) > 0 &&\n            l2[0] * (cy1 - lby2) - l2[1] * (cx1 - lbx2) > 0) {\n            return true;\n        } else {\n            poss1 = [ lt1, rt1, rb1, lb1 ];\n            poss2 = [ lt2, rt2, rb2, lb2 ];\n            dirs1 = [ t1, r1, b1, l1 ];\n            dirs2 = [ t2, r2, b2, l2 ];\n            for (i = 0; i < 4; i++) {\n                pos1 = poss1[i];\n                px1 = pos1[0]; py1 = pos1[1];\n                dir1 = dirs1[i];\n                dx1 = dir1[0]; dy1 = dir1[1];\n                for (j = 0; j < 4; j++) {\n                    pos2 = poss2[j];\n                    px2 = pos2[0]; py2 = pos2[1];\n                    dir2 = dirs2[j];\n                    dx2 = dir2[0]; dy2 = dir2[1];\n                    c = dx1 * dy2 - dy1 * dx2;\n                    if (c !== 0) {\n                        vx = px2 - px1;\n                        vy = py2 - py1;\n                        c1 = (vx * dy1 - vy * dx1) / c;\n                        c2 = (vx * dy2 - vy * dx2) / c;\n                        if (0 < c1 && c1 < 1 && 0 < c2 && c2 < 1) {\n                            return true;\n                        }\n                    }\n                }\n            }\n            return false;\n        }\n    },\n    /**\n     * Performs a collision detection based on distance from the Entity's central point.\n     * @param {*} other An object like Entity, with properties x, y, width, height, which are used for the \n     * collision detection.\n     * @param {Number} [distance] The greatest distance to be considered for a collision.\n     * The default distance is the average of both objects width and height.\n     * @return {Boolean} True, if a collision was detected.\n     */\n    within: function(other, distance) {\n        if (this._dirty) {\n            this._updateCoordinate();\n        } if (other._dirty) {\n            other._updateCoordinate();\n        }\n        if (distance == null) {\n            distance = (this.width + this.height + other.width + other.height) / 4;\n        }\n        var _;\n        return (_ = this._offsetX - other._offsetX + (this.width - other.width) / 2) * _ +\n            (_ = this._offsetY - other._offsetY + (this.height - other.height) / 2) * _ < distance * distance;\n    },\n    /**\n     * Enlarges or shrinks this Entity.\n     * @param {Number} x Scaling factor on the x axis.\n     * @param {Number} [y] Scaling factor on the y axis.\n     */\n    scale: function(x, y) {\n        this._scaleX *= x;\n        this._scaleY *= (y != null) ? y : x;\n        this._dirty = true;\n    },\n    /**\n     * Rotate this Entity.\n     * @param {Number} deg Rotation angle (degree).\n     */\n    rotate: function(deg) {\n        this.rotation += deg;\n    },\n    /**\n     * Scaling factor on the x axis of this Entity.\n     * @type Number\n     */\n    scaleX: {\n        get: function() {\n            return this._scaleX;\n        },\n        set: function(scaleX) {\n            if(this._scaleX !== scaleX) {\n                this._scaleX = scaleX;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * Scaling factor on the y axis of this Entity.\n     * @type Number\n     */\n    scaleY: {\n        get: function() {\n            return this._scaleY;\n        },\n        set: function(scaleY) {\n            if(this._scaleY !== scaleY) {\n                this._scaleY = scaleY;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * Entity rotation angle (degree).\n     * @type Number\n     */\n    rotation: {\n        get: function() {\n            return this._rotation;\n        },\n        set: function(rotation) {\n            if(this._rotation !== rotation) {\n                this._rotation = rotation;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * The point of origin used for rotation and scaling.\n     * @type Number\n     */\n    originX: {\n        get: function() {\n            return this._originX;\n        },\n        set: function(originX) {\n            if(this._originX !== originX) {\n                this._originX = originX;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * The point of origin used for rotation and scaling.\n     * @type Number\n     */\n    originY: {\n        get: function() {\n            return this._originY;\n        },\n        set: function(originY) {\n            if(this._originY !== originY) {\n                this._originY = originY;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     */\n    enableCollection: function() {\n        this.addEventListener('addedtoscene', this._addSelfToCollection);\n        this.addEventListener('removedfromscene', this._removeSelfFromCollection);\n        if (this.scene) {\n            this._addSelfToCollection();\n        }\n    },\n    /**\n     */\n    disableCollection: function() {\n        this.removeEventListener('addedtoscene', this._addSelfToCollection);\n        this.removeEventListener('removedfromscene', this._removeSelfFromCollection);\n        if (this.scene) {\n            this._removeSelfFromCollection();\n        }\n    },\n    /**#nocode+*/\n    clearEventListener: function() {\n        _nodePrototypeClearEventListener.apply(this,arguments);\n        if (this.scene) {\n            this._removeSelfFromCollection();\n        }\n    },\n    /**#nocode-*/\n    _addSelfToCollection: function() {\n        if (this._isContainedInCollection) {\n            return;\n        }\n\n        var Constructor = this.getConstructor();\n        Constructor._collectionTarget.forEach(function(C) {\n            C.collection.push(this);\n        }, this);\n\n        this._isContainedInCollection = true;\n    },\n    _removeSelfFromCollection: function() {\n        if (!this._isContainedInCollection) {\n            return;\n        }\n\n        var Constructor = this.getConstructor();\n        Constructor._collectionTarget.forEach(function(C) {\n            var i = C.collection.indexOf(this);\n            if (i !== -1) {\n                C.collection.splice(i, 1);\n            }\n        }, this);\n\n        this._isContainedInCollection = false;\n    },\n    getBoundingRect: function() {\n        var w = this.width || 0;\n        var h = this.height || 0;\n        var mat = this._matrix;\n        var m11w = mat[0] * w, m12w = mat[1] * w,\n            m21h = mat[2] * h, m22h = mat[3] * h,\n            mdx = mat[4], mdy = mat[5];\n        var xw = [ mdx, m11w + mdx, m21h + mdx, m11w + m21h + mdx ].sort(function(a, b) { return a - b; });\n        var yh = [ mdy, m12w + mdy, m22h + mdy, m12w + m22h + mdy ].sort(function(a, b) { return a - b; });\n\n        return {\n            left: xw[0],\n            top: yh[0],\n            width: xw[3] - xw[0],\n            height: yh[3] - yh[0]\n        };\n    },\n    getOrientedBoundingRect: function() {\n        var w = this.width || 0;\n        var h = this.height || 0;\n        var mat = this._matrix;\n        var m11w = mat[0] * w, m12w = mat[1] * w,\n            m21h = mat[2] * h, m22h = mat[3] * h,\n            mdx = mat[4], mdy = mat[5];\n\n        return {\n            leftTop: [ mdx, mdy ],\n            rightTop: [ m11w + mdx, m12w + mdy ],\n            leftBottom: [ m21h + mdx, m22h + mdy ],\n            rightBottom: [ m11w + m21h + mdx, m12w + m22h + mdy ]\n        };\n    },\n    getConstructor: function() {\n        return Object.getPrototypeOf(this).constructor;\n    }\n});\n\nvar _collectizeConstructor = function(Constructor) {\n    if (Constructor._collective) {\n        return;\n    }\n    var rel = enchant.Class.getInheritanceTree(Constructor);\n    var i = rel.indexOf(enchant.Entity);\n    if (i !== -1) {\n        Constructor._collectionTarget = rel.splice(0, i + 1);\n    } else {\n        Constructor._collectionTarget = [];\n    }\n    Constructor.intersect = _staticIntersect;\n    Constructor.intersectStrict = _staticIntersectStrict;\n    Constructor.collection = [];\n    Constructor._collective = true;\n};\n\n_collectizeConstructor(enchant.Entity);\n\nenchant.Entity._inherited = function(subclass) {\n    _collectizeConstructor(subclass);\n};\n\n/**\n * @scope enchant.Sprite.prototype\n */\nenchant.Sprite = enchant.Class.create(enchant.Entity, {\n    /**\n     * @name enchant.Sprite\n     * @class\n     * Class which can display images.\n     * @param {Number} width Sprite width.\n     * @param {Number} height Sprite height.\n     *\n     * @example\n     * var bear = new Sprite(32, 32);\n     * bear.image = core.assets['chara1.gif'];\n     *\n     * @constructs\n     * @extends enchant.Entity\n     */\n    initialize: function(width, height) {\n        enchant.Entity.call(this);\n\n        this.width = width;\n        this.height = height;\n        this._image = null;\n        this._debugColor = '#ff0000';\n        this._frameLeft = 0;\n        this._frameTop = 0;\n        this._frame = 0;\n        this._frameSequence = null;\n    },\n    /**\n     * Image displayed in the Sprite.\n     * @type enchant.Surface\n     */\n    image: {\n        get: function() {\n            return this._image;\n        },\n        set: function(image) {\n            if (image === undefined) {\n                throw new Error('Assigned value on Sprite.image is undefined. Please double-check image path, and check if the image you want to use is preload before use.');\n            }\n            if (image === this._image) {\n                return;\n            }\n            this._image = image;\n            this._computeFramePosition();\n        }\n    },\n    /**\n     * Index of the frame to be displayed.\n     * Frames with the same width and height as Sprite will be arrayed from upper left corner of the \n     * {@link enchant.Sprite#image} image. When a sequence of numbers is provided, the displayed frame \n     * will switch automatically. At the end of the array the sequence will restart. By setting \n     * a value within the sequence to null, the frame switching is stopped.\n     *\n     * @example\n     * var sprite = new Sprite(32, 32);\n     * sprite.frame = [0, 1, 0, 2]\n     * //-> 0, 1, 0, 2, 0, 1, 0, 2,..\n     * sprite.frame = [0, 1, 0, 2, null]\n     * //-> 0, 1, 0, 2, (2, 2,.. :stop)\n     *\n     * @type Number|Array\n     */\n    frame: {\n        get: function() {\n            return this._frame;\n        },\n        set: function(frame) {\n            if (((this._frameSequence == null) && (this._frame === frame)) || (this._deepCompareToPreviousFrame(frame))) {\n                return;\n            }\n            if (frame instanceof Array) {\n                this._frameSequence = frame;\n            } else {\n                this._frameSequence = null;\n                this._frame = frame;\n                this._computeFramePosition();\n            }\n        }\n    },\n    _frameSequence: {\n        get: function() {\n            return this.__frameSequence;\n        },\n        set: function(frameSequence) {\n            if(frameSequence && !this.__frameSequence) {\n                this.addEventListener(enchant.Event.ENTER_FRAME, this._rotateFrameSequence);\n            } else if(!frameSequence && this.__frameSequence) {\n                this.removeEventListener(enchant.Event.ENTER_FRAME, this._rotateFrameSequence);\n            }\n            if(frameSequence) {\n                this.__frameSequence = frameSequence.slice();\n                this._originalFrameSequence = frameSequence.slice();\n                this._rotateFrameSequence();\n            } else {\n                this.__frameSequence = null;\n                this._originalFrameSequence = null;\n            }\n        }\n    },\n    /**\n     * If we are setting the same frame Array as animation,\n     * just continue animating.\n     * @private\n     */\n    _deepCompareToPreviousFrame: function(frameArray) {\n        if (frameArray === this._originalFrameSequence) {\n            return true;\n        }\n        if (frameArray == null || this._originalFrameSequence == null) {\n            return false;\n        }\n        if (!(frameArray instanceof Array)) {\n            return false;\n        }\n        if (frameArray.length !== this._originalFrameSequence.length) {\n            return false;\n        }\n        for (var i = 0; i < frameArray.length; ++i) {\n            if (frameArray[i] !== this._originalFrameSequence[i]){\n                return false;\n            }\n        }\n        return true;\n    },\n    /**\n     * 0 <= frame\n     * @private\n     */\n    _computeFramePosition: function() {\n        var image = this._image;\n        var row;\n        if (image != null) {\n            row = image.width / this._width | 0;\n            this._frameLeft = (this._frame % row | 0) * this._width;\n            this._frameTop = (this._frame / row | 0) * this._height % image.height;\n        }\n    },\n    _rotateFrameSequence: function() {\n        var frameSequence = this._frameSequence;\n        if (frameSequence && frameSequence.length !== 0) {\n            var nextFrame = frameSequence.shift();\n            if (nextFrame === null) {\n                this._frameSequence = null;\n                this.dispatchEvent(new enchant.Event(enchant.Event.ANIMATION_END));\n            } else {\n                this._frame = nextFrame;\n                this._computeFramePosition();\n                frameSequence.push(nextFrame);\n            }\n        }\n    },\n    /**#nocode+*/\n    width: {\n        get: function() {\n            return this._width;\n        },\n        set: function(width) {\n            this._width = width;\n            this._computeFramePosition();\n            this._dirty = true;\n        }\n    },\n    height: {\n        get: function() {\n            return this._height;\n        },\n        set: function(height) {\n            this._height = height;\n            this._computeFramePosition();\n            this._dirty = true;\n        }\n    },\n    /**#nocode-*/\n    cvsRender: function(ctx) {\n        var image = this._image,\n            w = this._width, h = this._height,\n            iw, ih, elem, sx, sy, sw, sh;\n        if (image && w !== 0 && h !== 0) {\n            iw = image.width;\n            ih = image.height;\n            if (iw < w || ih < h) {\n                ctx.fillStyle = enchant.Surface._getPattern(image);\n                ctx.fillRect(0, 0, w, h);\n            } else {\n                elem = image._element;\n                sx = this._frameLeft;\n                sy = Math.min(this._frameTop, ih - h);\n                // IE9 doesn't allow for negative or 0 widths/heights when drawing on the CANVAS element\n                sw = Math.max(0.01, Math.min(iw - sx, w));\n                sh = Math.max(0.01, Math.min(ih - sy, h));\n                ctx.drawImage(elem, sx, sy, sw, sh, 0, 0, w, h);\n            }\n        }\n    },\n    domRender: (function() {\n        if (enchant.ENV.VENDOR_PREFIX === 'ms') {\n            return function(element) {\n                if (this._image) {\n                    if (this._image._css) {\n                        this._style['background-image'] = this._image._css;\n                        this._style['background-position'] =\n                            -this._frameLeft + 'px ' +\n                            -this._frameTop + 'px';\n                    } else if (this._image._element) {\n                    }\n                }\n            };\n        } else {\n            return function(element) {\n                if (this._image) {\n                    if (this._image._css) {\n                        this._style['background-image'] = this._image._css;\n                        this._style['background-position'] =\n                            -this._frameLeft + 'px ' +\n                            -this._frameTop + 'px';\n                    } else if (this._image._element) {\n                    }\n                }\n            };\n        }\n    }())\n});\n\n/**\n * @scope enchant.Label.prototype\n */\nenchant.Label = enchant.Class.create(enchant.Entity, {\n    /**\n     * @name enchant.Label\n     * @class\n     * A class for Label object.\n     * @constructs\n     * @extends enchant.Entity\n     */\n    initialize: function(text) {\n        enchant.Entity.call(this);\n\n        this.text = text || '';\n        this.width = 300;\n        this.font = '14px serif';\n        this.textAlign = 'left';\n\n        this._debugColor = '#ff0000';\n    },\n    /**#nocode+*/\n    width: {\n        get: function() {\n            return this._width;\n        },\n        set: function(width) {\n            this._width = width;\n            this._dirty = true;\n            // issue #164\n            this.updateBoundArea();\n        }\n    },\n    /**#nocode-*/\n    /**\n     * Text to be displayed.\n     * @type String\n     */\n    text: {\n        get: function() {\n            return this._text;\n        },\n        set: function(text) {\n            text = '' + text;\n            if(this._text === text) {\n                return;\n            }\n            this._text = text;\n            text = text.replace(/<br ?\\/?>/gi, '<br/>');\n            this._splitText = text.split('<br/>');\n            this.updateBoundArea();\n            for (var i = 0, l = this._splitText.length; i < l; i++) {\n                text = this._splitText[i];\n                var metrics = this.getMetrics(text);\n                this._splitText[i] = {};\n                this._splitText[i].text = text;\n                this._splitText[i].height = metrics.height;\n                this._splitText[i].width = metrics.width;\n            }\n        }\n    },\n    /**\n     * Specifies horizontal alignment of text.\n     * Can be set according to the format of the CSS 'text-align' property.\n     * @type String\n     */\n    textAlign: {\n        get: function() {\n            return this._style['text-align'];\n        },\n        set: function(textAlign) {\n            this._style['text-align'] = textAlign;\n            this.updateBoundArea();\n        }\n    },\n    /**\n     * Font settings.\n     * Can be set according to the format of the CSS 'font' property.\n     * @type String\n     */\n    font: {\n        get: function() {\n            return this._style.font;\n        },\n        set: function(font) {\n            this._style.font = font;\n            this.updateBoundArea();\n        }\n    },\n    /**\n     * Text color settings.\n     * Can be set according to the format of the CSS 'color' property.\n     * @type String\n     */\n    color: {\n        get: function() {\n            return this._style.color;\n        },\n        set: function(color) {\n            this._style.color = color;\n        }\n    },\n    cvsRender: function(ctx) {\n        var x, y = 0;\n        var labelWidth = this.width;\n        var charWidth, amount, line, text, c, buf, increase, length;\n        var bufWidth;\n        if (this._splitText) {\n            ctx.textBaseline = 'top';\n            ctx.font = this.font;\n            ctx.fillStyle = this.color || '#000000';\n            charWidth = ctx.measureText(' ').width;\n            amount = labelWidth / charWidth;\n            for (var i = 0, l = this._splitText.length; i < l; i++) {\n                line = this._splitText[i];\n                text = line.text;\n                c = 0;\n                while (text.length > c + amount || ctx.measureText(text.slice(c, c + amount)).width > labelWidth) {\n                    buf = '';\n                    increase = amount;\n                    length = 0;\n                    while (increase > 0) {\n                        if (ctx.measureText(buf).width < labelWidth) {\n                            length += increase;\n                            buf = text.slice(c, c + length);\n                        } else {\n                            length -= increase;\n                            buf = text.slice(c, c + length);\n                        }\n                        increase = increase / 2 | 0;\n                    }\n                    ctx.fillText(buf, 0, y);\n                    y += line.height - 1;\n                    c += length;\n                }\n                buf = text.slice(c, c + text.length);\n                if (this.textAlign === 'right') {\n                    x = labelWidth - ctx.measureText(buf).width;\n                } else if (this.textAlign === 'center') {\n                    x = (labelWidth - ctx.measureText(buf).width) / 2;\n                } else {\n                    x = 0;\n                }\n                ctx.fillText(buf, x, y);\n                y += line.height - 1;\n            }\n        }\n    },\n    domRender: function(element) {\n        if (element.innerHTML !== this._text) {\n            element.innerHTML = this._text;\n        }\n    },\n    detectRender: function(ctx) {\n        ctx.fillRect(this._boundOffset, 0, this._boundWidth, this._boundHeight);\n    },\n    updateBoundArea: function() {\n        var metrics = this.getMetrics();\n        this._boundWidth = metrics.width;\n        this._boundHeight = metrics.height;\n        if (this.textAlign === 'right') {\n            this._boundOffset = this.width - this._boundWidth;\n        } else if (this.textAlign === 'center') {\n            this._boundOffset = (this.width - this._boundWidth) / 2;\n        } else {\n            this._boundOffset = 0;\n        }\n    },\n    getMetrics: function(text) {\n        var ret = {};\n        var div, width, height;\n        if (document.body) {\n            div = document.createElement('div');\n            for (var prop in this._style) {\n                if(prop !== 'width' && prop !== 'height') {\n                    div.style[prop] = this._style[prop];\n                }\n            }\n            text = text || this._text;\n            div.innerHTML = text.replace(/ /g, '&nbsp;');\n            div.style.whiteSpace = 'noWrap';\n            div.style.lineHeight = 1;\n            document.body.appendChild(div);\n            var computedStyle = getComputedStyle(div);\n            ret.height = parseInt(computedStyle.height, 10) + 1;\n            div.style.position = 'absolute';\n            ret.width = parseInt(computedStyle.width, 10) + 1;\n            document.body.removeChild(div);\n        } else {\n            ret.width = this.width;\n            ret.height = this.height;\n        }\n        return ret;\n    }\n});\n\n/**\n * @scope enchant.Map.prototype\n */\nenchant.Map = enchant.Class.create(enchant.Entity, {\n    /**\n     * @name enchant.Map\n     * @class\n     * A class to create and display maps from a tile set.\n     * @param {Number} tileWidth Tile width.\n     * @param {Number} tileHeight Tile height.\n     * @constructs\n     * @extends enchant.Entity\n     */\n    initialize: function(tileWidth, tileHeight) {\n        var core = enchant.Core.instance;\n\n        enchant.Entity.call(this);\n\n        var surface = new enchant.Surface(core.width, core.height);\n        this._surface = surface;\n        var canvas = surface._element;\n        canvas.style.position = 'absolute';\n        if (enchant.ENV.RETINA_DISPLAY && core.scale === 2) {\n            canvas.width = core.width * 2;\n            canvas.height = core.height * 2;\n            this._style.webkitTransformOrigin = '0 0';\n            this._style.webkitTransform = 'scale(0.5)';\n        } else {\n            canvas.width = core.width;\n            canvas.height = core.height;\n        }\n        this._context = canvas.getContext('2d');\n\n        this._tileWidth = tileWidth || 0;\n        this._tileHeight = tileHeight || 0;\n        this._image = null;\n        this._data = [\n            [\n                []\n            ]\n        ];\n        this._dirty = false;\n        this._tight = false;\n\n        this.touchEnabled = false;\n\n        /**\n         * Two dimensional array to store if collision detection should be performed for a tile.\n         * @type Number[][]\n         */\n        this.collisionData = null;\n\n        this._listeners['render'] = null;\n        this.addEventListener('render', function() {\n            if(this._dirty) {\n                this._previousOffsetX = this._previousOffsetY = null;\n            }\n        });\n    },\n    /**\n     * Set map data.\n     * Sets the tile data, whereas the data (two-dimensional array with indizes starting from 0) \n     * is mapped on the image starting from the upper left corner.\n     * When more than one map data array is set, they are displayed in reverse order.\n     * @param {...Number[][]} data Two-dimensional array of tile indizes. Multiple designations possible.\n     */\n    loadData: function(data) {\n        this._data = Array.prototype.slice.apply(arguments);\n        this._dirty = true;\n\n        this._tight = false;\n        for (var i = 0, len = this._data.length; i < len; i++) {\n            var c = 0;\n            data = this._data[i];\n            for (var y = 0, l = data.length; y < l; y++) {\n                for (var x = 0, ll = data[y].length; x < ll; x++) {\n                    if (data[y][x] >= 0) {\n                        c++;\n                    }\n                }\n            }\n            if (c / (data.length * data[0].length) > 0.2) {\n                this._tight = true;\n                break;\n            }\n        }\n    },\n    /**\n     * Checks what tile is present at the given position.\n     * @param {Number} x x coordinates of the point on the map.\n     * @param {Number} y y coordinates of the point on the map.\n     * @return {*} The tile data for the given position.\n     */\n    checkTile: function(x, y) {\n        if (x < 0 || this.width <= x || y < 0 || this.height <= y) {\n            return false;\n        }\n        var width = this._image.width;\n        var height = this._image.height;\n        var tileWidth = this._tileWidth || width;\n        var tileHeight = this._tileHeight || height;\n        x = x / tileWidth | 0;\n        y = y / tileHeight | 0;\n        //\t\treturn this._data[y][x];\n        var data = this._data[0];\n        return data[y][x];\n    },\n    /**\n     * Judges whether or not obstacles are on top of Map.\n     * @param {Number} x x coordinates of detection spot on map.\n     * @param {Number} y y coordinates of detection spot on map.\n     * @return {Boolean} True, if there are obstacles.\n     */\n    hitTest: function(x, y) {\n        if (x < 0 || this.width <= x || y < 0 || this.height <= y) {\n            return false;\n        }\n        var width = this._image.width;\n        var height = this._image.height;\n        var tileWidth = this._tileWidth || width;\n        var tileHeight = this._tileHeight || height;\n        x = x / tileWidth | 0;\n        y = y / tileHeight | 0;\n        if (this.collisionData != null) {\n            return this.collisionData[y] && !!this.collisionData[y][x];\n        } else {\n            for (var i = 0, len = this._data.length; i < len; i++) {\n                var data = this._data[i];\n                var n;\n                if (data[y] != null && (n = data[y][x]) != null &&\n                    0 <= n && n < (width / tileWidth | 0) * (height / tileHeight | 0)) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    },\n    /**\n     * Image with which the tile set is displayed on the map.\n     * @type enchant.Surface\n     */\n    image: {\n        get: function() {\n            return this._image;\n        },\n        set: function(image) {\n            var core = enchant.Core.instance;\n\n            this._image = image;\n            if (enchant.ENV.RETINA_DISPLAY && core.scale === 2) {\n                var img = new enchant.Surface(image.width * 2, image.height * 2);\n                var tileWidth = this._tileWidth || image.width;\n                var tileHeight = this._tileHeight || image.height;\n                var row = image.width / tileWidth | 0;\n                var col = image.height / tileHeight | 0;\n                for (var y = 0; y < col; y++) {\n                    for (var x = 0; x < row; x++) {\n                        img.draw(image, x * tileWidth, y * tileHeight, tileWidth, tileHeight,\n                            x * tileWidth * 2, y * tileHeight * 2, tileWidth * 2, tileHeight * 2);\n                    }\n                }\n                this._doubledImage = img;\n            }\n            this._dirty = true;\n        }\n    },\n    /**\n     * Map tile width.\n     * @type Number\n     */\n    tileWidth: {\n        get: function() {\n            return this._tileWidth;\n        },\n        set: function(tileWidth) {\n            if(this._tileWidth !== tileWidth) {\n                this._tileWidth = tileWidth;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * Map tile height.\n     * @type Number\n     */\n    tileHeight: {\n        get: function() {\n            return this._tileHeight;\n        },\n        set: function(tileHeight) {\n            if(this._tileHeight !== tileHeight) {\n                this._tileHeight = tileHeight;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n     * @private\n     */\n    width: {\n        get: function() {\n            return this._tileWidth * this._data[0][0].length;\n        }\n    },\n    /**\n     * @private\n     */\n    height: {\n        get: function() {\n            return this._tileHeight * this._data[0].length;\n        }\n    },\n    /**\n     * @private\n     */\n    redraw: function(x, y, width, height) {\n        if (this._image == null) {\n            return;\n        }\n\n        var image, tileWidth, tileHeight, dx, dy;\n        if (this._doubledImage) {\n            image = this._doubledImage;\n            tileWidth = this._tileWidth * 2;\n            tileHeight = this._tileHeight * 2;\n            dx = -this._offsetX * 2;\n            dy = -this._offsetY * 2;\n            x *= 2;\n            y *= 2;\n            width *= 2;\n            height *= 2;\n        } else {\n            image = this._image;\n            tileWidth = this._tileWidth;\n            tileHeight = this._tileHeight;\n            dx = -this._offsetX;\n            dy = -this._offsetY;\n        }\n        var row = image.width / tileWidth | 0;\n        var col = image.height / tileHeight | 0;\n        var left = Math.max((x + dx) / tileWidth | 0, 0);\n        var top = Math.max((y + dy) / tileHeight | 0, 0);\n        var right = Math.ceil((x + dx + width) / tileWidth);\n        var bottom = Math.ceil((y + dy + height) / tileHeight);\n\n        var source = image._element;\n        var context = this._context;\n        var canvas = context.canvas;\n        context.clearRect(x, y, width, height);\n        for (var i = 0, len = this._data.length; i < len; i++) {\n            var data = this._data[i];\n            var r = Math.min(right, data[0].length);\n            var b = Math.min(bottom, data.length);\n            for (y = top; y < b; y++) {\n                for (x = left; x < r; x++) {\n                    var n = data[y][x];\n                    if (0 <= n && n < row * col) {\n                        var sx = (n % row) * tileWidth;\n                        var sy = (n / row | 0) * tileHeight;\n                        context.drawImage(source, sx, sy, tileWidth, tileHeight,\n                            x * tileWidth - dx, y * tileHeight - dy, tileWidth, tileHeight);\n                    }\n                }\n            }\n        }\n    },\n    /**\n     * @private\n     */\n    updateBuffer: function() {\n        if (this._visible === undefined || this._visible) {\n            var core = enchant.Core.instance;\n            if (this._dirty || this._previousOffsetX == null) {\n                this.redraw(0, 0, core.width, core.height);\n            } else if (this._offsetX !== this._previousOffsetX ||\n                    this._offsetY !== this._previousOffsetY) {\n                if (this._tight) {\n                    var x = -this._offsetX;\n                    var y = -this._offsetY;\n                    var px = -this._previousOffsetX;\n                    var py = -this._previousOffsetY;\n                    var w1 = x - px + core.width;\n                    var w2 = px - x + core.width;\n                    var h1 = y - py + core.height;\n                    var h2 = py - y + core.height;\n                    if (w1 > this._tileWidth && w2 > this._tileWidth &&\n                            h1 > this._tileHeight && h2 > this._tileHeight) {\n                        var sx, sy, dx, dy, sw, sh;\n                        if (w1 < w2) {\n                            sx = 0;\n                            dx = px - x;\n                            sw = w1;\n                        } else {\n                            sx = x - px;\n                            dx = 0;\n                            sw = w2;\n                        }\n                        if (h1 < h2) {\n                            sy = 0;\n                            dy = py - y;\n                            sh = h1;\n                        } else {\n                            sy = y - py;\n                            dy = 0;\n                            sh = h2;\n                        }\n\n                        if (core._buffer == null) {\n                            core._buffer = document.createElement('canvas');\n                            core._buffer.width = this._context.canvas.width;\n                            core._buffer.height = this._context.canvas.height;\n                        }\n                        var context = core._buffer.getContext('2d');\n                        if (this._doubledImage) {\n                            context.clearRect(0, 0, sw * 2, sh * 2);\n                            context.drawImage(this._context.canvas,\n                                    sx * 2, sy * 2, sw * 2, sh * 2, 0, 0, sw * 2, sh * 2);\n                            context = this._context;\n                            context.clearRect(dx * 2, dy * 2, sw * 2, sh * 2);\n                            context.drawImage(core._buffer,\n                                    0, 0, sw * 2, sh * 2, dx * 2, dy * 2, sw * 2, sh * 2);\n                        } else {\n                            context.clearRect(0, 0, sw, sh);\n                            context.drawImage(this._context.canvas,\n                                    sx, sy, sw, sh, 0, 0, sw, sh);\n                            context = this._context;\n                            context.clearRect(dx, dy, sw, sh);\n                            context.drawImage(core._buffer,\n                                    0, 0, sw, sh, dx, dy, sw, sh);\n                        }\n\n                        if (dx === 0) {\n                            this.redraw(sw, 0, core.width - sw, core.height);\n                        } else {\n                            this.redraw(0, 0, core.width - sw, core.height);\n                        }\n                        if (dy === 0) {\n                            this.redraw(0, sh, core.width, core.height - sh);\n                        } else {\n                            this.redraw(0, 0, core.width, core.height - sh);\n                        }\n                    } else {\n                        this.redraw(0, 0, core.width, core.height);\n                    }\n                } else {\n                    this.redraw(0, 0, core.width, core.height);\n                }\n            }\n            this._previousOffsetX = this._offsetX;\n            this._previousOffsetY = this._offsetY;\n        }\n    },\n    cvsRender: function(ctx) {\n        if (this.width !== 0 && this.height !== 0) {\n            var core = enchant.Core.instance;\n            this.updateBuffer();\n            ctx.save();\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n            var cvs = this._context.canvas;\n                ctx.drawImage(cvs, 0, 0, core.width, core.height);\n            ctx.restore();\n        }\n    },\n    domRender: function(element) {\n        if (this._image) {\n            this.updateBuffer();\n            this._style['background-image'] = this._surface._css;\n            // bad performance\n            this._style[enchant.ENV.VENDOR_PREFIX + 'Transform'] = 'matrix(1, 0, 0, 1, 0, 0)';\n        }\n    }\n});\n\n\n/**\n * @scope enchant.Group.prototype\n */\nenchant.Group = enchant.Class.create(enchant.Node, {\n    /**\n     * @name enchant.Group\n     * @class\n     * A class that can hold multiple {@link enchant.Node}.\n     *\n     * @example\n     * var stage = new Group();\n     * stage.addChild(player);\n     * stage.addChild(enemy);\n     * stage.addChild(map);\n     * stage.addEventListener('enterframe', function() {\n     *     // Moves the entire frame in according to the player's coordinates.\n     *     if (this.x > 64 - player.x) {\n     *         this.x = 64 - player.x;\n     *     }\n     * });\n     * @constructs\n     * @extends enchant.Node\n     */\n    initialize: function() {\n        /**\n         * Child Nodes.\n         * @type enchant.Node[]\n         */\n        this.childNodes = [];\n\n        enchant.Node.call(this);\n\n        this._rotation = 0;\n        this._scaleX = 1;\n        this._scaleY = 1;\n\n        this._originX = null;\n        this._originY = null;\n\n        this.__dirty = false;\n\n        [enchant.Event.ADDED_TO_SCENE, enchant.Event.REMOVED_FROM_SCENE]\n            .forEach(function(event) {\n                this.addEventListener(event, function(e) {\n                    this.childNodes.forEach(function(child) {\n                        child.scene = this.scene;\n                        child.dispatchEvent(e);\n                    }, this);\n                });\n            }, this);\n    },\n    /**\n     * Adds a Node to the Group.\n     * @param {enchant.Node} node Node to be added.\n     */\n    addChild: function(node) {\n        if (node.parentNode) {\n            node.parentNode.removeChild(node);\n        }\n        this.childNodes.push(node);\n        node.parentNode = this;\n        var childAdded = new enchant.Event('childadded');\n        childAdded.node = node;\n        childAdded.next = null;\n        this.dispatchEvent(childAdded);\n        node.dispatchEvent(new enchant.Event('added'));\n        if (this.scene) {\n            node.scene = this.scene;\n            var addedToScene = new enchant.Event('addedtoscene');\n            node.dispatchEvent(addedToScene);\n        }\n    },\n    /**\n     * Incorporates Node into Group.\n     * @param {enchant.Node} node Node to be incorporated.\n     * @param {enchant.Node} reference Node in position before insertion.\n     */\n    insertBefore: function(node, reference) {\n        if (node.parentNode) {\n            node.parentNode.removeChild(node);\n        }\n        var i = this.childNodes.indexOf(reference);\n        if (i !== -1) {\n            this.childNodes.splice(i, 0, node);\n            node.parentNode = this;\n            var childAdded = new enchant.Event('childadded');\n            childAdded.node = node;\n            childAdded.next = reference;\n            this.dispatchEvent(childAdded);\n            node.dispatchEvent(new enchant.Event('added'));\n            if (this.scene) {\n                node.scene = this.scene;\n                var addedToScene = new enchant.Event('addedtoscene');\n                node.dispatchEvent(addedToScene);\n            }\n        } else {\n            this.addChild(node);\n        }\n    },\n    /**\n     * Remove a Node from the Group.\n     * @param {enchant.Node} node Node to be deleted.\n     */\n    removeChild: function(node) {\n        var i;\n        if ((i = this.childNodes.indexOf(node)) !== -1) {\n            this.childNodes.splice(i, 1);\n            node.parentNode = null;\n            var childRemoved = new enchant.Event('childremoved');\n            childRemoved.node = node;\n            this.dispatchEvent(childRemoved);\n            node.dispatchEvent(new enchant.Event('removed'));\n            if (this.scene) {\n                node.scene = null;\n                var removedFromScene = new enchant.Event('removedfromscene');\n                node.dispatchEvent(removedFromScene);\n            }\n        }\n    },\n    /**\n     * The Node which is the first child.\n     * @type enchant.Node\n     */\n    firstChild: {\n        get: function() {\n            return this.childNodes[0];\n        }\n    },\n    /**\n     * The Node which is the last child.\n     * @type enchant.Node\n     */\n    lastChild: {\n        get: function() {\n            return this.childNodes[this.childNodes.length - 1];\n        }\n    },\n    /**\n    * Group rotation angle (degree).\n    * @type Number\n    */\n    rotation: {\n        get: function() {\n            return this._rotation;\n        },\n        set: function(rotation) {\n            if(this._rotation !== rotation) {\n                this._rotation = rotation;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n    * Scaling factor on the x axis of the Group.\n    * @type Number\n    * @see enchant.Group#originX\n    * @see enchant.Group#originY\n    */\n    scaleX: {\n        get: function() {\n            return this._scaleX;\n        },\n        set: function(scale) {\n            if(this._scaleX !== scale) {\n                this._scaleX = scale;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n    * Scaling factor on the y axis of the Group.\n    * @type Number\n    * @see enchant.Group#originX\n    * @see enchant.Group#originY\n    */\n    scaleY: {\n        get: function() {\n            return this._scaleY;\n        },\n        set: function(scale) {\n            if(this._scaleY !== scale) {\n                this._scaleY = scale;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n    * origin point of rotation, scaling\n    * @type Number\n    */\n    originX: {\n        get: function() {\n            return this._originX;\n        },\n        set: function(originX) {\n            if(this._originX !== originX) {\n                this._originX = originX;\n                this._dirty = true;\n            }\n        }\n    },\n    /**\n    * origin point of rotation, scaling\n    * @type Number\n    */\n    originY: {\n        get: function() {\n            return this._originY;\n        },\n        set: function(originY) {\n            if(this._originY !== originY) {\n                this._originY = originY;\n                this._dirty = true;\n            }\n        }\n    },\n    /**#nocode+*/\n    _dirty: {\n        get: function() {\n            return this.__dirty;\n        },\n        set: function(dirty) {\n            dirty = !!dirty;\n            this.__dirty = dirty;\n            if (dirty) {\n                for (var i = 0, l = this.childNodes.length; i < l; i++) {\n                    this.childNodes[i]._dirty = true;\n                }\n            }\n        }\n    }\n    /**#nocode-*/\n});\n\nenchant.Matrix = enchant.Class.create({\n    initialize: function() {\n        this.reset();\n    },\n    reset: function() {\n        this.stack = [];\n        this.stack.push([ 1, 0, 0, 1, 0, 0 ]);\n    },\n    makeTransformMatrix: function(node, dest) {\n        var x = node._x;\n        var y = node._y;\n        var width = node.width || 0;\n        var height = node.height || 0;\n        var rotation = node._rotation || 0;\n        var scaleX = (typeof node._scaleX === 'number') ? node._scaleX : 1;\n        var scaleY = (typeof node._scaleY === 'number') ? node._scaleY : 1;\n        var theta = rotation * Math.PI / 180;\n        var tmpcos = Math.cos(theta);\n        var tmpsin = Math.sin(theta);\n        var w = (typeof node._originX === 'number') ? node._originX : width / 2;\n        var h = (typeof node._originY === 'number') ? node._originY : height / 2;\n        var a = scaleX * tmpcos;\n        var b = scaleX * tmpsin;\n        var c = scaleY * tmpsin;\n        var d = scaleY * tmpcos;\n        dest[0] = a;\n        dest[1] = b;\n        dest[2] = -c;\n        dest[3] = d;\n        dest[4] = (-a * w + c * h + x + w);\n        dest[5] = (-b * w - d * h + y + h);\n    },\n    multiply: function(m1, m2, dest) {\n        var a11 = m1[0], a21 = m1[2], adx = m1[4],\n            a12 = m1[1], a22 = m1[3], ady = m1[5];\n        var b11 = m2[0], b21 = m2[2], bdx = m2[4],\n            b12 = m2[1], b22 = m2[3], bdy = m2[5];\n\n        dest[0] = a11 * b11 + a21 * b12;\n        dest[1] = a12 * b11 + a22 * b12;\n        dest[2] = a11 * b21 + a21 * b22;\n        dest[3] = a12 * b21 + a22 * b22;\n        dest[4] = a11 * bdx + a21 * bdy + adx;\n        dest[5] = a12 * bdx + a22 * bdy + ady;\n    },\n    multiplyVec: function(mat, vec, dest) {\n        var x = vec[0], y = vec[1];\n        var m11 = mat[0], m21 = mat[2], mdx = mat[4],\n            m12 = mat[1], m22 = mat[3], mdy = mat[5];\n        dest[0] = m11 * x + m21 * y + mdx;\n        dest[1] = m12 * x + m22 * y + mdy;\n    }\n});\nenchant.Matrix.instance = new enchant.Matrix();\n\nenchant.DetectColorManager = enchant.Class.create({\n    initialize: function(reso, max) {\n        this.reference = [];\n        this.colorResolution = reso || 16;\n        this.max = max || 1;\n        this.capacity = Math.pow(this.colorResolution, 3);\n        for (var i = 1, l = this.capacity; i < l; i++) {\n            this.reference[i] = null;\n        }\n    },\n    attachDetectColor: function(sprite) {\n        var i = this.reference.indexOf(null);\n        if (i === -1) {\n            i = 1;\n        }\n        this.reference[i] = sprite;\n        return this._getColor(i);\n    },\n    detachDetectColor: function(sprite) {\n        var i = this.reference.indexOf(sprite);\n        if (i !== -1) {\n            this.reference[i] = null;\n        }\n    },\n    _getColor: function(n) {\n        var C = this.colorResolution;\n        var d = C / this.max;\n        return [\n            parseInt((n / C / C) % C, 10) / d,\n            parseInt((n / C) % C, 10) / d,\n            parseInt(n % C, 10) / d,\n            1.0\n        ];\n    },\n    _decodeDetectColor: function(color, i) {\n        i = i || 0;\n        var C = this.colorResolution;\n        return ~~(color[i] * C * C * C / 256) +\n            ~~(color[i + 1] * C * C / 256) +\n            ~~(color[i + 2] * C / 256);\n    },\n    getSpriteByColor: function(color) {\n        return this.reference[this._decodeDetectColor(color)];\n    },\n    getSpriteByColors: function(rgba) {\n        var i, l, id, result,\n            score = 0,\n            found = {};\n\n        for (i = 0, l = rgba.length; i < l; i+= 4) {\n            id = this._decodeDetectColor(rgba, i);\n            found[id] = (found[id] || 0) + 1;\n        }\n        for (id in found) {\n            if (found[id] > score) {\n                score = found[id];\n                result = id;\n            }\n        }\n\n        return this.reference[result];\n    }\n});\n\nenchant.DomManager = enchant.Class.create({\n    initialize: function(node, elementDefinition) {\n        var core = enchant.Core.instance;\n        this.layer = null;\n        this.targetNode = node;\n        if (typeof elementDefinition === 'string') {\n            this.element = document.createElement(elementDefinition);\n        } else if (elementDefinition instanceof HTMLElement) {\n            this.element = elementDefinition;\n        }\n        this.style = this.element.style;\n        this.style.position = 'absolute';\n        this.style[enchant.ENV.VENDOR_PREFIX + 'TransformOrigin'] = '0px 0px';\n        if (core._debug) {\n            this.style.border = '1px solid blue';\n            this.style.margin = '-1px';\n        }\n\n        var manager = this;\n        this._setDomTarget = function() {\n            manager.layer._touchEventTarget = manager.targetNode;\n        };\n        this._attachEvent();\n    },\n    getDomElement: function() {\n        return this.element;\n    },\n    getDomElementAsNext: function() {\n        return this.element;\n    },\n    getNextManager: function(manager) {\n        var i = this.targetNode.parentNode.childNodes.indexOf(manager.targetNode);\n        if (i !== this.targetNode.parentNode.childNodes.length - 1) {\n            return this.targetNode.parentNode.childNodes[i + 1]._domManager;\n        } else {\n            return null;\n        }\n    },\n    addManager: function(childManager, nextManager) {\n        var nextElement;\n        if (nextManager) {\n            nextElement = nextManager.getDomElementAsNext();\n        }\n        var element = childManager.getDomElement();\n        if (element instanceof Array) {\n            element.forEach(function(child) {\n                if (nextElement) {\n                    this.element.insertBefore(child, nextElement);\n                } else {\n                    this.element.appendChild(child);\n                }\n            }, this);\n        } else {\n            if (nextElement) {\n                this.element.insertBefore(element, nextElement);\n            } else {\n                this.element.appendChild(element);\n            }\n        }\n        this.setLayer(this.layer);\n    },\n    removeManager: function(childManager) {\n        if (childManager instanceof enchant.DomlessManager) {\n            childManager._domRef.forEach(function(element) {\n                this.element.removeChild(element);\n            }, this);\n        } else {\n            this.element.removeChild(childManager.element);\n        }\n        this.setLayer(this.layer);\n    },\n    setLayer: function(layer) {\n        this.layer = layer;\n        var node = this.targetNode;\n        var manager;\n        if (node.childNodes) {\n            for (var i = 0, l = node.childNodes.length; i < l; i++) {\n                manager = node.childNodes[i]._domManager;\n                if (manager) {\n                    manager.setLayer(layer);\n                }\n            }\n        }\n    },\n    render: function(inheritMat) {\n        var node = this.targetNode;\n        var matrix = enchant.Matrix.instance;\n        var stack = matrix.stack;\n        var dest = [];\n        matrix.makeTransformMatrix(node, dest);\n        matrix.multiply(stack[stack.length - 1], dest, dest);\n        matrix.multiply(inheritMat, dest, inheritMat);\n        node._matrix = inheritMat;\n        var ox = (typeof node._originX === 'number') ? node._originX : node.width / 2 || 0;\n        var oy = (typeof node._originY === 'number') ? node._originY : node.height / 2 || 0;\n        var vec = [ ox, oy ];\n        matrix.multiplyVec(dest, vec, vec);\n\n        node._offsetX = vec[0] - ox;\n        node._offsetY = vec[1] - oy;\n        if(node.parentNode && !(node.parentNode instanceof enchant.Group)) {\n            node._offsetX += node.parentNode._offsetX;\n            node._offsetY += node.parentNode._offsetY;\n        }\n        if (node._dirty) {\n            this.style[enchant.ENV.VENDOR_PREFIX + 'Transform'] = 'matrix(' +\n                dest[0].toFixed(10) + ',' +\n                dest[1].toFixed(10) + ',' +\n                dest[2].toFixed(10) + ',' +\n                dest[3].toFixed(10) + ',' +\n                dest[4].toFixed(10) + ',' +\n                dest[5].toFixed(10) +\n            ')';\n        }\n        this.domRender();\n    },\n    domRender: function() {\n        var node = this.targetNode;\n        if(!node._style) {\n            node._style = {};\n        }\n        if(!node.__styleStatus) {\n            node.__styleStatus = {};\n        }\n        if (node.width !== null) {\n            node._style.width = node.width + 'px';\n        }\n        if (node.height !== null) {\n            node._style.height = node.height + 'px';\n        }\n        node._style.opacity = node._opacity;\n        node._style['background-color'] = node._backgroundColor;\n        if (typeof node._visible !== 'undefined') {\n            node._style.display = node._visible ? 'block' : 'none';\n        }\n        if (typeof node.domRender === 'function') {\n            node.domRender(this.element);\n        }\n        var value;\n        for (var prop in node._style) {\n            value = node._style[prop];\n            if(node.__styleStatus[prop] !== value && value != null) {\n                this.style.setProperty(prop, '' + value);\n                node.__styleStatus[prop] = value;\n            }\n        }\n    },\n    _attachEvent: function() {\n        if (enchant.ENV.TOUCH_ENABLED) {\n            this.element.addEventListener('touchstart', this._setDomTarget, true);\n        }\n        this.element.addEventListener('mousedown', this._setDomTarget, true);\n    },\n    _detachEvent: function() {\n        if (enchant.ENV.TOUCH_ENABLED) {\n            this.element.removeEventListener('touchstart', this._setDomTarget, true);\n        }\n        this.element.removeEventListener('mousedown', this._setDomTarget, true);\n    },\n    remove: function() {\n        this._detachEvent();\n        this.element = this.style = this.targetNode = null;\n    }\n});\n\nenchant.DomlessManager = enchant.Class.create({\n    initialize: function(node) {\n        this._domRef = [];\n        this.targetNode = node;\n    },\n    _register: function(element, nextElement) {\n        var i = this._domRef.indexOf(nextElement);\n        if (element instanceof Array) {\n            if (i === -1) {\n                Array.prototype.push.apply(this._domRef, element);\n            } else {\n                Array.prototype.splice.apply(this._domRef, [i, 0].concat(element));\n            }\n        } else {\n            if (i === -1) {\n                this._domRef.push(element);\n            } else {\n                this._domRef.splice(i, 0, element);\n            }\n        }\n    },\n    getNextManager: function(manager) {\n        var i = this.targetNode.parentNode.childNodes.indexOf(manager.targetNode);\n        if (i !== this.targetNode.parentNode.childNodes.length - 1) {\n            return this.targetNode.parentNode.childNodes[i + 1]._domManager;\n        } else {\n            return null;\n        }\n    },\n    getDomElement: function() {\n        var ret = [];\n        this.targetNode.childNodes.forEach(function(child) {\n            ret = ret.concat(child._domManager.getDomElement());\n        });\n        return ret;\n    },\n    getDomElementAsNext: function() {\n        if (this._domRef.length) {\n            return this._domRef[0];\n        } else {\n            var nextManager = this.getNextManager(this);\n            if (nextManager) {\n                return nextManager.element;\n            } else {\n                return null;\n            }\n        }\n    },\n    addManager: function(childManager, nextManager) {\n        var parentNode = this.targetNode.parentNode;\n        if (parentNode) {\n            if (nextManager === null) {\n                nextManager = this.getNextManager(this);\n            }\n            if (parentNode instanceof enchant.Scene) {\n                parentNode._layers.Dom._domManager.addManager(childManager, nextManager);\n            } else {\n                parentNode._domManager.addManager(childManager, nextManager);\n            }\n        }\n        var nextElement = nextManager ? nextManager.getDomElementAsNext() : null;\n        this._register(childManager.getDomElement(), nextElement);\n        this.setLayer(this.layer);\n    },\n    removeManager: function(childManager) {\n        var dom;\n        var i = this._domRef.indexOf(childManager.element);\n        if (i !== -1) {\n            dom = this._domRef[i];\n            dom.parentNode.removeChild(dom);\n            this._domRef.splice(i, 1);\n        }\n        this.setLayer(this.layer);\n    },\n    setLayer: function(layer) {\n        this.layer = layer;\n        var node = this.targetNode;\n        var manager;\n        if (node.childNodes) {\n            for (var i = 0, l = node.childNodes.length; i < l; i++) {\n                manager = node.childNodes[i]._domManager;\n                if (manager) {\n                    manager.setLayer(layer);\n                }\n            }\n        }\n    },\n    render: function(inheritMat) {\n        var matrix = enchant.Matrix.instance;\n        var stack = matrix.stack;\n        var node = this.targetNode;\n        var dest = [];\n        matrix.makeTransformMatrix(node, dest);\n        matrix.multiply(stack[stack.length - 1], dest, dest);\n        matrix.multiply(inheritMat, dest, inheritMat);\n        node._matrix = inheritMat;\n        var ox = (typeof node._originX === 'number') ? node._originX : node.width / 2 || 0;\n        var oy = (typeof node._originY === 'number') ? node._originY : node.height / 2 || 0;\n        var vec = [ ox, oy ];\n        matrix.multiplyVec(dest, vec, vec);\n        node._offsetX = vec[0] - ox;\n        node._offsetY = vec[1] - oy;\n        stack.push(dest);\n    },\n    remove: function() {\n        this._domRef = [];\n        this.targetNode = null;\n    }\n});\n\nenchant.DomLayer = enchant.Class.create(enchant.Group, {\n    initialize: function() {\n        var core = enchant.Core.instance;\n        enchant.Group.call(this);\n\n        this._touchEventTarget = null;\n\n        this._element = document.createElement('div');\n        this._element.style.position = 'absolute';\n\n        this._domManager = new enchant.DomManager(this, this._element);\n        this._domManager.layer = this;\n\n        this.width = core.width;\n        this.height = core.height;\n\n        var touch = [\n            enchant.Event.TOUCH_START,\n            enchant.Event.TOUCH_MOVE,\n            enchant.Event.TOUCH_END\n        ];\n\n        touch.forEach(function(type) {\n            this.addEventListener(type, function(e) {\n                if (this._scene) {\n                    this._scene.dispatchEvent(e);\n                }\n            });\n        }, this);\n\n        var __onchildadded = function(e) {\n            var child = e.node;\n            var next = e.next;\n            var self = e.target;\n            var nextManager = next ? next._domManager : null;\n            enchant.DomLayer._attachDomManager(child, __onchildadded, __onchildremoved);\n            self._domManager.addManager(child._domManager, nextManager);\n            var render = new enchant.Event(enchant.Event.RENDER);\n            child._dirty = true;\n            self._domManager.layer._rendering(child, render);\n        };\n\n        var __onchildremoved = function(e) {\n            var child = e.node;\n            var self = e.target;\n            self._domManager.removeManager(child._domManager);\n            enchant.DomLayer._detachDomManager(child, __onchildadded, __onchildremoved);\n        };\n\n        this.addEventListener('childremoved', __onchildremoved);\n        this.addEventListener('childadded', __onchildadded);\n\n    },\n    width: {\n        get: function() {\n            return this._width;\n        },\n        set: function(width) {\n            this._width = width;\n            this._element.style.width = width + 'px';\n        }\n    },\n    height: {\n        get: function() {\n            return this._height;\n        },\n        set: function(height) {\n            this._height = height;\n            this._element.style.height = height + 'px';\n        }\n    },\n    addChild: function(node) {\n        this.childNodes.push(node);\n        node.parentNode = this;\n        var childAdded = new enchant.Event('childadded');\n        childAdded.node = node;\n        childAdded.next = null;\n        this.dispatchEvent(childAdded);\n        node.dispatchEvent(new enchant.Event('added'));\n        if (this.scene) {\n            node.scene = this.scene;\n            var addedToScene = new enchant.Event('addedtoscene');\n            node.dispatchEvent(addedToScene);\n        }\n    },\n    insertBefore: function(node, reference) {\n        var i = this.childNodes.indexOf(reference);\n        if (i !== -1) {\n            this.childNodes.splice(i, 0, node);\n            node.parentNode = this;\n            var childAdded = new enchant.Event('childadded');\n            childAdded.node = node;\n            childAdded.next = reference;\n            this.dispatchEvent(childAdded);\n            node.dispatchEvent(new enchant.Event('added'));\n            if (this.scene) {\n                node.scene = this.scene;\n                var addedToScene = new enchant.Event('addedtoscene');\n                node.dispatchEvent(addedToScene);\n            }\n        } else {\n            this.addChild(node);\n        }\n    },\n    _startRendering: function() {\n        this.addEventListener('exitframe', this._onexitframe);\n        this._onexitframe();\n    },\n    _stopRendering: function() {\n        this.removeEventListener('exitframe', this._onexitframe);\n        this._onexitframe();\n    },\n    _onexitframe: function() {\n        this._rendering(this, new enchant.Event(enchant.Event.RENDER));\n    },\n    _rendering: function(node, e, inheritMat) {\n        var child;\n        if (!inheritMat) {\n            inheritMat = [ 1, 0, 0, 1, 0, 0 ];\n        }\n        node.dispatchEvent(e);\n        node._domManager.render(inheritMat);\n        if (node.childNodes) {\n            for (var i = 0, l = node.childNodes.length; i < l; i++) {\n                child = node.childNodes[i];\n                this._rendering(child, e, inheritMat.slice());\n            }\n        }\n        if (node._domManager instanceof enchant.DomlessManager) {\n            enchant.Matrix.instance.stack.pop();\n        }\n        node._dirty = false;\n    },\n    _determineEventTarget: function() {\n        var target = this._touchEventTarget;\n        this._touchEventTarget = null;\n        return (target === this) ? null : target;\n    }\n});\n\nenchant.DomLayer._attachDomManager = function(node, onchildadded, onchildremoved) {\n    var child;\n    if (!node._domManager) {\n        node.addEventListener('childadded', onchildadded);\n        node.addEventListener('childremoved', onchildremoved);\n        if (node instanceof enchant.Group) {\n            node._domManager = new enchant.DomlessManager(node);\n        } else {\n            if (node._element) {\n                node._domManager = new enchant.DomManager(node, node._element);\n            } else {\n                node._domManager = new enchant.DomManager(node, 'div');\n            }\n        }\n    }\n    if (node.childNodes) {\n        for (var i = 0, l = node.childNodes.length; i < l; i++) {\n            child = node.childNodes[i];\n            enchant.DomLayer._attachDomManager(child, onchildadded, onchildremoved);\n            node._domManager.addManager(child._domManager, null);\n        }\n    }\n};\n\nenchant.DomLayer._detachDomManager = function(node, onchildadded, onchildremoved) {\n    var child;\n    node.removeEventListener('childadded', onchildadded);\n    node.removeEventListener('childremoved', onchildremoved);\n    if (node.childNodes) {\n        for (var i = 0, l = node.childNodes.length; i < l; i++) {\n            child = node.childNodes[i];\n            node._domManager.removeManager(child._domManager, null);\n            enchant.DomLayer._detachDomManager(child, onchildadded, onchildremoved);\n        }\n    }\n    node._domManager.remove();\n    delete node._domManager;\n};\n\n/**\n * @scope enchant.CanvasLayer.prototype\n */\nenchant.CanvasLayer = enchant.Class.create(enchant.Group, {\n    /**\n     * @name enchant.CanvasLayer\n     * @class\n     * Class that uses the HTML Canvas for rendering.\n     * The rendering of children will be replaced by the Canvas rendering.\n     * @constructs\n     * @extends enchant.Group\n     */\n    initialize: function() {\n        var core = enchant.Core.instance;\n\n        enchant.Group.call(this);\n\n        this._cvsCache = {\n            matrix: [1, 0, 0, 1, 0, 0],\n            detectColor: '#000000'\n        };\n        this._cvsCache.layer = this;\n\n        this._element = document.createElement('canvas');\n        this._element.style.position = 'absolute';\n        // issue 179\n        this._element.style.left = this._element.style.top = '0px';\n\n        this._detect = document.createElement('canvas');\n        this._detect.style.position = 'absolute';\n        this._lastDetected = 0;\n\n        this.context = this._element.getContext('2d');\n        this._dctx = this._detect.getContext('2d');\n        this._setImageSmoothingEnable();\n\n        this._colorManager = new enchant.DetectColorManager(16, 256);\n\n        this.width = core.width;\n        this.height = core.height;\n\n        var touch = [\n            enchant.Event.TOUCH_START,\n            enchant.Event.TOUCH_MOVE,\n            enchant.Event.TOUCH_END\n        ];\n\n        touch.forEach(function(type) {\n            this.addEventListener(type, function(e) {\n                if (this._scene) {\n                    this._scene.dispatchEvent(e);\n                }\n            });\n        }, this);\n\n        var __onchildadded = function(e) {\n            var child = e.node;\n            var self = e.target;\n            var layer;\n            if (self instanceof enchant.CanvasLayer) {\n                layer = self._scene._layers.Canvas;\n            } else {\n                layer = self.scene._layers.Canvas;\n            }\n            enchant.CanvasLayer._attachCache(child, layer, __onchildadded, __onchildremoved);\n            var render = new enchant.Event(enchant.Event.RENDER);\n            if (self._dirty) {\n                self._updateCoordinate();\n            }\n            child._dirty = true;\n            enchant.Matrix.instance.stack.push(self._matrix);\n            enchant.CanvasRenderer.instance.render(layer.context, child, render);\n            enchant.Matrix.instance.stack.pop(self._matrix);\n        };\n\n        var __onchildremoved = function(e) {\n            var child = e.node;\n            var self = e.target;\n            var layer;\n            if (self instanceof enchant.CanvasLayer) {\n                layer = self._scene._layers.Canvas;\n            } else {\n                layer = self.scene._layers.Canvas;\n            }\n            enchant.CanvasLayer._detachCache(child, layer, __onchildadded, __onchildremoved);\n        };\n\n        this.addEventListener('childremoved', __onchildremoved);\n        this.addEventListener('childadded', __onchildadded);\n\n    },\n    /**\n     * The width of the CanvasLayer.\n     * @type Number\n     */\n    width: {\n        get: function() {\n            return this._width;\n        },\n        set: function(width) {\n            this._width = width;\n            this._element.width = this._detect.width = width;\n            this._setImageSmoothingEnable();\n        }\n    },\n    /**\n     * The height of the CanvasLayer.\n     * @type Number\n     */\n    height: {\n        get: function() {\n            return this._height;\n        },\n        set: function(height) {\n            this._height = height;\n            this._element.height = this._detect.height = height;\n            this._setImageSmoothingEnable();\n        }\n    },\n    addChild: function(node) {\n        this.childNodes.push(node);\n        node.parentNode = this;\n        var childAdded = new enchant.Event('childadded');\n        childAdded.node = node;\n        childAdded.next = null;\n        this.dispatchEvent(childAdded);\n        node.dispatchEvent(new enchant.Event('added'));\n    },\n    insertBefore: function(node, reference) {\n        var i = this.childNodes.indexOf(reference);\n        if (i !== -1) {\n            this.childNodes.splice(i, 0, node);\n            node.parentNode = this;\n            var childAdded = new enchant.Event('childadded');\n            childAdded.node = node;\n            childAdded.next = reference;\n            this.dispatchEvent(childAdded);\n            node.dispatchEvent(new enchant.Event('added'));\n        } else {\n            this.addChild(node);\n        }\n    },\n    /**\n     * @private\n     */\n    _startRendering: function() {\n        this.addEventListener('exitframe', this._onexitframe);\n        this._onexitframe();\n    },\n    /**\n     * @private\n     */\n    _stopRendering: function() {\n        this.removeEventListener('exitframe', this._onexitframe);\n        this._onexitframe();\n    },\n    _onexitframe: function() {\n        var core = enchant.Core.instance;\n        var ctx = this.context;\n        ctx.clearRect(0, 0, core.width, core.height);\n        var render = new enchant.Event(enchant.Event.RENDER);\n        enchant.CanvasRenderer.instance.render(ctx, this, render);\n    },\n    _determineEventTarget: function(e) {\n        return this._getEntityByPosition(e.x, e.y);\n    },\n    _getEntityByPosition: function(x, y) {\n        var core = enchant.Core.instance;\n        var ctx = this._dctx;\n        if (this._lastDetected < core.frame) {\n            ctx.clearRect(0, 0, this.width, this.height);\n            enchant.CanvasRenderer.instance.detectRender(ctx, this);\n            this._lastDetected = core.frame;\n        }\n        var extra = enchant.ENV.COLOR_DETECTION_LEVEL - 1;\n        var rgba = ctx.getImageData(x - extra, y - extra, 1 + extra * 2, 1 + extra * 2).data;\n        return this._colorManager.getSpriteByColors(rgba);\n    },\n    _setImageSmoothingEnable: function() {\n        this._dctx.imageSmoothingEnabled =\n                this._dctx.msImageSmoothingEnabled =\n                this._dctx.mozImageSmoothingEnabled =\n                this._dctx.webkitImageSmoothingEnabled = false;\n    }\n});\n\nenchant.CanvasLayer._attachCache = function(node, layer, onchildadded, onchildremoved) {\n    var child;\n    if (!node._cvsCache) {\n        node._cvsCache = {};\n        node._cvsCache.matrix = [ 1, 0, 0, 1, 0, 0 ];\n        node._cvsCache.detectColor = 'rgba(' + layer._colorManager.attachDetectColor(node) + ')';\n        node.addEventListener('childadded', onchildadded);\n        node.addEventListener('childremoved', onchildremoved);\n    }\n    if (node.childNodes) {\n        for (var i = 0, l = node.childNodes.length; i < l; i++) {\n            child = node.childNodes[i];\n            enchant.CanvasLayer._attachCache(child, layer, onchildadded, onchildremoved);\n        }\n    }\n};\n\nenchant.CanvasLayer._detachCache = function(node, layer, onchildadded, onchildremoved) {\n    var child;\n    if (node._cvsCache) {\n        layer._colorManager.detachDetectColor(node);\n        node.removeEventListener('childadded', onchildadded);\n        node.removeEventListener('childremoved', onchildremoved);\n        delete node._cvsCache;\n    }\n    if (node.childNodes) {\n        for (var i = 0, l = node.childNodes.length; i < l; i++) {\n            child = node.childNodes[i];\n            enchant.CanvasLayer._detachCache(child, layer, onchildadded, onchildremoved);\n        }\n    }\n};\n\nenchant.CanvasRenderer = enchant.Class.create({\n    render: function(ctx, node, e) {\n        var width, height, child;\n        ctx.save();\n        node.dispatchEvent(e);\n        // transform\n        this.transform(ctx, node);\n        if (typeof node._visible === 'undefined' || node._visible) {\n            width = node.width;\n            height = node.height;\n            // composite\n            if (node.compositeOperation) {\n                ctx.globalCompositeOperation = node.compositeOperation;\n            }\n            ctx.globalAlpha = (typeof node._opacity === 'number') ? node._opacity : 1.0;\n            // render\n            if (node._backgroundColor) {\n                ctx.fillStyle = node._backgroundColor;\n                ctx.fillRect(0, 0, width, height);\n            }\n\n            if (node.cvsRender) {\n                node.cvsRender(ctx);\n            }\n\n            if (enchant.Core.instance._debug && node._debugColor) {\n                ctx.strokeStyle = node._debugColor;\n                ctx.strokeRect(0, 0, width, height);\n            }\n            if (node._clipping) {\n                ctx.beginPath();\n                ctx.rect(0, 0, width, height);\n                ctx.clip();\n            }\n            if (node.childNodes) {\n                for (var i = 0, l = node.childNodes.length; i < l; i++) {\n                    child = node.childNodes[i];\n                    this.render(ctx, child, e);\n                }\n            }\n        }\n        ctx.restore();\n        enchant.Matrix.instance.stack.pop();\n    },\n    detectRender: function(ctx, node) {\n        var width, height, child;\n        if (typeof node._visible === 'undefined' || node._visible) {\n            width = node.width;\n            height = node.height;\n            ctx.save();\n            this.transform(ctx, node);\n            ctx.fillStyle = node._cvsCache.detectColor;\n            if (node._touchEnabled) {\n                if (node.detectRender) {\n                    node.detectRender(ctx);\n                } else {\n                    ctx.fillRect(0, 0, width, height);\n                }\n            }\n            if (node._clipping) {\n                ctx.beginPath();\n                ctx.rect(0, 0, width, height);\n                ctx.clip();\n            }\n            if (node.childNodes) {\n                for (var i = 0, l = node.childNodes.length; i < l; i++) {\n                    child = node.childNodes[i];\n                    this.detectRender(ctx, child);\n                }\n            }\n            ctx.restore();\n            enchant.Matrix.instance.stack.pop();\n        }\n    },\n    transform: function(ctx, node) {\n        var matrix = enchant.Matrix.instance;\n        var stack = matrix.stack;\n        var newmat, ox, oy, vec;\n        if (node._dirty) {\n            matrix.makeTransformMatrix(node, node._cvsCache.matrix);\n            newmat = [];\n            matrix.multiply(stack[stack.length - 1], node._cvsCache.matrix, newmat);\n            node._matrix = newmat;\n            ox = (typeof node._originX === 'number') ? node._originX : node._width / 2 || 0;\n            oy = (typeof node._originY === 'number') ? node._originY : node._height / 2 || 0;\n            vec = [ ox, oy ];\n            matrix.multiplyVec(newmat, vec, vec);\n            node._offsetX = vec[0] - ox;\n            node._offsetY = vec[1] - oy;\n            node._dirty = false;\n        } else {\n            newmat = node._matrix;\n        }\n        stack.push(newmat);\n        ctx.setTransform.apply(ctx, newmat);\n    }\n});\nenchant.CanvasRenderer.instance = new enchant.CanvasRenderer();\n\n/**\n * @scope enchant.Scene.prototype\n */\nenchant.Scene = enchant.Class.create(enchant.Group, {\n    /**\n     * @name enchant.Scene\n     * @class\n     * Class that becomes the root of the display object tree.\n     * Child {@link Entity} objects are distributed to the Scene layer according to the drawing method.\n     * The DOM of each Scene layer has a ({@link enchant.DOMLayer} and  {@link enchant.CanvasLayer}) and is drawn using the Canvas.\n     * Scenes are drawn in the order that they are added.\n     *\n     * @example\n     * var scene = new Scene();\n     * scene.addChild(player);\n     * scene.addChild(enemy);\n     * core.pushScene(scene);\n     *\n     * @constructs\n     * @extends enchant.Group\n     */\n    initialize: function() {\n        var core = enchant.Core.instance;\n\n        // Call initialize method of enchant.Group\n        enchant.Group.call(this);\n\n        // All nodes (entities, groups, scenes) have reference to the scene that it belongs to.\n        this.scene = this;\n\n        this._backgroundColor = null;\n\n        // Create div tag which possesses its layers\n        this._element = document.createElement('div');\n        this._element.style.position = 'absolute';\n        this._element.style.overflow = 'hidden';\n        this._element.style[enchant.ENV.VENDOR_PREFIX + 'TransformOrigin'] = '0 0';\n\n        this._layers = {};\n        this._layerPriority = [];\n\n        this.addEventListener(enchant.Event.CHILD_ADDED, this._onchildadded);\n        this.addEventListener(enchant.Event.CHILD_REMOVED, this._onchildremoved);\n        this.addEventListener(enchant.Event.ENTER, this._onenter);\n        this.addEventListener(enchant.Event.EXIT, this._onexit);\n\n        var that = this;\n        this._dispatchExitframe = function() {\n            var layer;\n            for (var prop in that._layers) {\n                layer = that._layers[prop];\n                layer.dispatchEvent(new enchant.Event(enchant.Event.EXIT_FRAME));\n            }\n        };\n\n        this.addEventListener(enchant.Event.CORE_RESIZE, this._oncoreresize);\n\n        this._oncoreresize(core);\n    },\n    /**#nocode+*/\n    x: {\n        get: function() {\n            return this._x;\n        },\n        set: function(x) {\n            this._x = x;\n            for (var type in this._layers) {\n                this._layers[type].x = x;\n            }\n        }\n    },\n    y: {\n        get: function() {\n            return this._y;\n        },\n        set: function(y) {\n            this._y = y;\n            for (var type in this._layers) {\n                this._layers[type].y = y;\n            }\n        }\n    },\n    width: {\n        get: function() {\n            return this._width;\n        },\n        set: function(width) {\n            this._width = width;\n            for (var type in this._layers) {\n                this._layers[type].width = width;\n            }\n        }\n    },\n    height: {\n        get: function() {\n            return this._height;\n        },\n        set: function(height) {\n            this._height = height;\n            for (var type in this._layers) {\n                this._layers[type].height = height;\n            }\n        }\n    },\n    rotation: {\n        get: function() {\n            return this._rotation;\n        },\n        set: function(rotation) {\n            this._rotation = rotation;\n            for (var type in this._layers) {\n                this._layers[type].rotation = rotation;\n            }\n        }\n    },\n    scaleX: {\n        get: function() {\n            return this._scaleX;\n        },\n        set: function(scaleX) {\n            this._scaleX = scaleX;\n            for (var type in this._layers) {\n                this._layers[type].scaleX = scaleX;\n            }\n        }\n    },\n    scaleY: {\n        get: function() {\n            return this._scaleY;\n        },\n        set: function(scaleY) {\n            this._scaleY = scaleY;\n            for (var type in this._layers) {\n                this._layers[type].scaleY = scaleY;\n            }\n        }\n    },\n    backgroundColor: {\n        get: function() {\n            return this._backgroundColor;\n        },\n        set: function(color) {\n            this._backgroundColor = this._element.style.backgroundColor = color;\n        }\n    },\n    remove: function() {\n        this.clearEventListener();\n\n        while (this.childNodes.length > 0) {\n            this.childNodes[0].remove();\n        }\n\n        return enchant.Core.instance.removeScene(this);\n    },\n    /**#nocode-*/\n    _oncoreresize: function(e) {\n        this._element.style.width = e.width + 'px';\n        this.width = e.width;\n        this._element.style.height = e.height + 'px';\n        this.height = e.height;\n        this._element.style[enchant.ENV.VENDOR_PREFIX + 'Transform'] = 'scale(' + e.scale + ')';\n\n        for (var type in this._layers) {\n            this._layers[type].dispatchEvent(e);\n        }\n    },\n    addLayer: function(type, i) {\n        var core = enchant.Core.instance;\n        if (this._layers[type]) {\n            return;\n        }\n        var layer = new enchant[type + 'Layer']();\n        if (core.currentScene === this) {\n            layer._startRendering();\n        }\n        this._layers[type] = layer;\n        var element = layer._element;\n        if (typeof i === 'number') {\n            var nextSibling = this._element.childNodes[i];\n            if (nextSibling) {\n                this._element.insertBefore(element, nextSibling);\n            } else {\n                this._element.appendChild(element);\n            }\n            this._layerPriority.splice(i, 0, type);\n        } else {\n            this._element.appendChild(element);\n            this._layerPriority.push(type);\n        }\n        layer._scene = this;\n    },\n    _determineEventTarget: function(e) {\n        var layer, target;\n        for (var i = this._layerPriority.length - 1; i >= 0; i--) {\n            layer = this._layers[this._layerPriority[i]];\n            target = layer._determineEventTarget(e);\n            if (target) {\n                break;\n            }\n        }\n        if (!target) {\n            target = this;\n        }\n        return target;\n    },\n    _onchildadded: function(e) {\n        var child = e.node;\n        var next = e.next;\n        var target, i;\n        if (child._element) {\n            target = 'Dom';\n            i = 1;\n        } else {\n            target = 'Canvas';\n            i = 0;\n        }\n        if (!this._layers[target]) {\n            this.addLayer(target, i);\n        }\n        child._layer = this._layers[target];\n        this._layers[target].insertBefore(child, next);\n        child.parentNode = this;\n    },\n    _onchildremoved: function(e) {\n        var child = e.node;\n        child._layer.removeChild(child);\n        child._layer = null;\n    },\n    _onenter: function() {\n        for (var type in this._layers) {\n            this._layers[type]._startRendering();\n        }\n        enchant.Core.instance.addEventListener('exitframe', this._dispatchExitframe);\n    },\n    _onexit: function() {\n        for (var type in this._layers) {\n            this._layers[type]._stopRendering();\n        }\n        enchant.Core.instance.removeEventListener('exitframe', this._dispatchExitframe);\n    }\n});\n\n/**\n * @scope enchant.LoadingScene.prototype\n */\nenchant.LoadingScene = enchant.Class.create(enchant.Scene, {\n    /**\n     * @name enchant.LoadingScene\n     * @class\n     * Default loading scene. If you want to use your own loading animation, overwrite (don't inherit) this class.\n     * Referred from enchant.Core in default, as `new enchant.LoadingScene` etc.\n     *\n     * @example\n     * enchant.LoadingScene = enchant.Class.create(enchant.Scene, {\n     *     initialize: function() {\n     *         enchant.Scene.call(this);\n     *         this.backgroundColor = 'red';\n     *         // ...\n     *         this.addEventListener('progress', function(e) {\n     *             progress = e.loaded / e.total;\n     *         });\n     *         this.addEventListener('enterframe', function() {\n     *             // animation\n     *         });\n     *     }\n     * });\n     * @constructs\n     * @extends enchant.Scene\n     */\n    initialize: function() {\n        enchant.Scene.call(this);\n        this.backgroundColor = '#000';\n        var barWidth = this.width * 0.4 | 0;\n        var barHeight = this.width * 0.05 | 0;\n        var border = barWidth * 0.03 | 0;\n        var bar = new enchant.Sprite(barWidth, barHeight);\n        bar.disableCollection();\n        bar.x = (this.width - barWidth) / 2;\n        bar.y = (this.height - barHeight) / 2;\n        var image = new enchant.Surface(barWidth, barHeight);\n        image.context.fillStyle = '#fff';\n        image.context.fillRect(0, 0, barWidth, barHeight);\n        image.context.fillStyle = '#000';\n        image.context.fillRect(border, border, barWidth - border * 2, barHeight - border * 2);\n        bar.image = image;\n        var progress = 0, _progress = 0;\n        this.addEventListener('progress', function(e) {\n            // avoid #167 https://github.com/wise9/enchant.js/issues/177\n            progress = e.loaded / e.total * 1.0;\n        });\n        bar.addEventListener('enterframe', function() {\n            _progress *= 0.9;\n            _progress += progress * 0.1;\n            image.context.fillStyle = '#fff';\n            image.context.fillRect(border, 0, (barWidth - border * 2) * _progress, barHeight);\n        });\n        this.addChild(bar);\n        this.addEventListener('load', function(e) {\n            var core = enchant.Core.instance;\n            core.removeScene(core.loadingScene);\n            core.dispatchEvent(e);\n        });\n    }\n});\n\n/**\n * @scope enchant.CanvasScene.prototype\n */\nenchant.CanvasScene = enchant.Class.create(enchant.Scene, {\n    /**\n     * @name enchant.CanvasScene\n     * @class\n     * Scene to draw by the Canvas all of the children.\n     * @constructs\n     * @extends enchant.Scene\n     */\n    initialize: function() {\n        enchant.Scene.call(this);\n        this.addLayer('Canvas');\n    },\n    _determineEventTarget: function(e) {\n        var target = this._layers.Canvas._determineEventTarget(e);\n        if (!target) {\n            target = this;\n        }\n        return target;\n    },\n    _onchildadded: function(e) {\n        var child = e.node;\n        var next = e.next;\n        child._layer = this._layers.Canvas;\n        this._layers.Canvas.insertBefore(child, next);\n    },\n    _onenter: function() {\n        this._layers.Canvas._startRendering();\n        enchant.Core.instance.addEventListener('exitframe', this._dispatchExitframe);\n    },\n    _onexit: function() {\n        this._layers.Canvas._stopRendering();\n        enchant.Core.instance.removeEventListener('exitframe', this._dispatchExitframe);\n    }\n});\n\n/**\n * @scope enchant.DOMScene.prototype\n */\nenchant.DOMScene = enchant.Class.create(enchant.Scene, {\n    /**\n     * @name enchant.DOMScene\n     * @class\n     * Scene to draw by the DOM all of the children.\n     * @constructs\n     * @extends enchant.Scene\n     */\n    initialize: function() {\n        enchant.Scene.call(this);\n        this.addLayer('Dom');\n    },\n    _determineEventTarget: function(e) {\n        var target = this._layers.Dom._determineEventTarget(e);\n        if (!target) {\n            target = this;\n        }\n        return target;\n    },\n    _onchildadded: function(e) {\n        var child = e.node;\n        var next = e.next;\n        child._layer = this._layers.Dom;\n        this._layers.Dom.insertBefore(child, next);\n    },\n    _onenter: function() {\n        this._layers.Dom._startRendering();\n        enchant.Core.instance.addEventListener('exitframe', this._dispatchExitframe);\n    },\n    _onexit: function() {\n        this._layers.Dom._stopRendering();\n        enchant.Core.instance.removeEventListener('exitframe', this._dispatchExitframe);\n    }\n});\n\n/**\n * @scope enchant.Surface.prototype\n */\nenchant.Surface = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.Surface\n     * @class\n     * Class that wraps canvas elements.\n     *\n     * Can be used to set the {@link enchant.Sprite} and {@link enchant.Map}'s image properties to be displayed.\n     * If you wish to access Canvas API use the {@link enchant.Surface#context} property.\n     *\n     * @example\n     * // Creates Sprite that displays a circle.\n     * var ball = new Sprite(50, 50);\n     * var surface = new Surface(50, 50);\n     * surface.context.beginPath();\n     * surface.context.arc(25, 25, 25, 0, Math.PI*2, true);\n     * surface.context.fill();\n     * ball.image = surface;\n     *\n     * @param {Number} width Surface width.\n     * @param {Number} height Surface height.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function(width, height) {\n        enchant.EventTarget.call(this);\n\n        var core = enchant.Core.instance;\n\n        /**\n         * Surface width.\n         * @type Number\n         */\n        this.width = Math.ceil(width);\n        /**\n         * Surface height.\n         * @type Number\n         */\n        this.height = Math.ceil(height);\n        /**\n         * Surface drawing context.\n         * @type CanvasRenderingContext2D\n         */\n        this.context = null;\n\n        var id = 'enchant-surface' + core._surfaceID++;\n        if (document.getCSSCanvasContext) {\n            this.context = document.getCSSCanvasContext('2d', id, width, height);\n            this._element = this.context.canvas;\n            this._css = '-webkit-canvas(' + id + ')';\n            var context = this.context;\n        } else if (document.mozSetImageElement) {\n            this._element = document.createElement('canvas');\n            this._element.width = width;\n            this._element.height = height;\n            this._css = '-moz-element(#' + id + ')';\n            this.context = this._element.getContext('2d');\n            document.mozSetImageElement(id, this._element);\n        } else {\n            this._element = document.createElement('canvas');\n            this._element.width = width;\n            this._element.height = height;\n            this._element.style.position = 'absolute';\n            this.context = this._element.getContext('2d');\n\n            enchant.ENV.CANVAS_DRAWING_METHODS.forEach(function(name) {\n                var method = this.context[name];\n                this.context[name] = function() {\n                    method.apply(this, arguments);\n                    this._dirty = true;\n                };\n            }, this);\n        }\n    },\n    /**\n     * Returns 1 pixel from the Surface.\n     * @param {Number} x The pixel's x coordinates.\n     * @param {Number} y The pixel's y coordinates.\n     * @return {Number[]} An array that holds pixel information in [r, g, b, a] format.\n     */\n    getPixel: function(x, y) {\n        return this.context.getImageData(x, y, 1, 1).data;\n    },\n    /**\n     * Sets one pixel within the surface.\n     * @param {Number} x The pixel's x coordinates.\n     * @param {Number} y The pixel's y coordinates.\n     * @param {Number} r The pixel's red level.\n     * @param {Number} g The pixel's green level.\n     * @param {Number} b The pixel's blue level.\n     * @param {Number} a The pixel's transparency.\n     */\n    setPixel: function(x, y, r, g, b, a) {\n        var pixel = this.context.createImageData(1, 1);\n        pixel.data[0] = r;\n        pixel.data[1] = g;\n        pixel.data[2] = b;\n        pixel.data[3] = a;\n        this.context.putImageData(pixel, x, y);\n    },\n    /**\n     * Clears all Surface pixels and makes the pixels transparent.\n     */\n    clear: function() {\n        this.context.clearRect(0, 0, this.width, this.height);\n    },\n    /**\n     * Draws the content of the given Surface onto this surface.\n     *\n     * Wraps Canvas API drawImage and if multiple arguments are given,\n     * these are getting applied to the Canvas drawImage method.\n     *\n     * @example\n     * var src = core.assets['src.gif'];\n     * var dst = new Surface(100, 100);\n     * dst.draw(src);         // Draws source at (0, 0)\n     * dst.draw(src, 50, 50); // Draws source at (50, 50)\n     * // Draws just 30 horizontal and vertical pixels of source at (50, 50)\n     * dst.draw(src, 50, 50, 30, 30);\n     * // Takes the image content in src starting at (10,10) with a (Width, Height) of (40,40),\n     * // scales it and draws it in this surface at (50, 50) with a (Width, Height) of (30,30).\n     * dst.draw(src, 10, 10, 40, 40, 50, 50, 30, 30);\n     *\n     * @param {enchant.Surface} image Surface used in drawing.\n     */\n    draw: function(image) {\n        image = image._element;\n        if (arguments.length === 1) {\n            this.context.drawImage(image, 0, 0);\n        } else {\n            var args = arguments;\n            args[0] = image;\n            this.context.drawImage.apply(this.context, args);\n        }\n    },\n    /**\n     * Copies Surface.\n     * @return {enchant.Surface} The copied Surface.\n     */\n    clone: function() {\n        var clone = new enchant.Surface(this.width, this.height);\n        clone.draw(this);\n        return clone;\n    },\n    /**\n     * Creates a data URI scheme from this Surface.\n     * @return {String} The data URI scheme that identifies this Surface and\n     * can be used to include this Surface into a dom tree.\n     */\n    toDataURL: function() {\n        var src = this._element.src;\n        if (src) {\n            if (src.slice(0, 5) === 'data:') {\n                return src;\n            } else {\n                return this.clone().toDataURL();\n            }\n        } else {\n            return this._element.toDataURL();\n        }\n    }\n});\n\n/**\n * Loads an image and creates a Surface object out of it.\n *\n * It is not possible to access properties or methods of the {@link enchant.Surface#context}, or to call methods using the Canvas API -\n * like {@link enchant.Surface#draw}, {@link enchant.Surface#clear}, {@link enchant.Surface#getPixel}, {@link enchant.Surface#setPixel}.. -\n * of the wrapped image created with this method.\n * However, it is possible to use this surface to draw it to another surface using the {@link enchant.Surface#draw} method.\n * The resulting surface can then be manipulated. (when loading images in a cross-origin resource sharing environment,\n * pixel acquisition and other image manipulation might be limited).\n *\n * @param {String} src The file path of the image to be loaded.\n * @param {Function} callback on load callback.\n * @param {Function} [onerror] on error callback.\n * @static\n * @return {enchant.Surface} Surface\n */\nenchant.Surface.load = function(src, callback, onerror) {\n    var image = new Image();\n    var surface = Object.create(enchant.Surface.prototype, {\n        context: { value: null },\n        _css: { value: 'url(' + src + ')' },\n        _element: { value: image }\n    });\n    enchant.EventTarget.call(surface);\n    onerror = onerror || function() {};\n    surface.addEventListener('load', callback);\n    surface.addEventListener('error', onerror);\n    image.onerror = function() {\n        var e = new enchant.Event(enchant.Event.ERROR);\n        e.message = 'Cannot load an asset: ' + image.src;\n        enchant.Core.instance.dispatchEvent(e);\n        surface.dispatchEvent(e);\n    };\n    image.onload = function() {\n        surface.width = image.width;\n        surface.height = image.height;\n        surface.dispatchEvent(new enchant.Event('load'));\n    };\n    image.src = src;\n    return surface;\n};\nenchant.Surface._staticCanvas2DContext = document.createElement('canvas').getContext('2d');\n\nenchant.Surface._getPattern = function(surface, force) {\n    if (!surface._pattern || force) {\n        surface._pattern = this._staticCanvas2DContext.createPattern(surface._element, 'repeat');\n    }\n    return surface._pattern;\n};\n\nif (window.Deferred) {\n    enchant.Deferred = window.Deferred;\n} else {\n    /**\n     * @scope enchant.Deferred.prototype\n     */\n    enchant.Deferred = enchant.Class.create({\n        /**\n         * @name enchant.Deferred\n         * @class\n         * <br/>\n         * See: <a href=\"http://cho45.stfuawsc.com/jsdeferred/\">\n         * http://cho45.stfuawsc.com/jsdeferred/</a>\n         *\n         * @example\n         * enchant.Deferred\n         *     .next(function() {\n         *         return 42;\n         *     })\n         *     .next(function(n) {\n         *         console.log(n); // 42\n         *     })\n         *     .next(function() {\n         *         return core.load('img.png'); // wait loading\n         *     })\n         *     .next(function() {\n         *         var img = core.assets['img.png'];\n         *         console.log(img instanceof enchant.Surface); // true\n         *         throw new Error('!!!');\n         *     })\n         *     .next(function() {\n         *         // skip\n         *     })\n         *     .error(function(err) {\n         *          console.log(err.message); // !!!\n         *     });\n         *\n         * @constructs\n         */\n        initialize: function() {\n            this._succ = this._fail = this._next = this._id = null;\n            this._tail = this;\n        },\n        /**\n         * @param {Function} func\n         */\n        next: function(func) {\n            var q = new enchant.Deferred();\n            q._succ = func;\n            return this._add(q);\n        },\n        /**\n         * @param {Function} func\n         */\n        error: function(func) {\n            var q = new enchant.Deferred();\n            q._fail = func;\n            return this._add(q);\n        },\n        _add: function(queue) {\n            this._tail._next = queue;\n            this._tail = queue;\n            return this;\n        },\n        /**\n         * @param {*} arg\n         */\n        call: function(arg) {\n            var received;\n            var queue = this;\n            while (queue && !queue._succ) {\n                queue = queue._next;\n            }\n            if (!(queue instanceof enchant.Deferred)) {\n                return;\n            }\n            try {\n                received = queue._succ(arg);\n            } catch (e) {\n                return queue.fail(e);\n            }\n            if (received instanceof enchant.Deferred) {\n                enchant.Deferred._insert(queue, received);\n            } else if (queue._next instanceof enchant.Deferred) {\n                queue._next.call(received);\n            }\n        },\n        /**\n         * @param {*} arg\n         */\n        fail: function(arg) {\n            var result, err,\n                queue = this;\n            while (queue && !queue._fail) {\n                queue = queue._next;\n            }\n            if (queue instanceof enchant.Deferred) {\n                result = queue._fail(arg);\n                queue.call(result);\n            } else if (arg instanceof Error) {\n                throw arg;\n            } else {\n                err = new Error('failed in Deferred');\n                err.arg = arg;\n                throw err;\n            }\n        }\n    });\n    enchant.Deferred._insert = function(queue, ins) {\n        if (queue._next instanceof enchant.Deferred) {\n            ins._tail._next = queue._next;\n        }\n        queue._next = ins;\n    };\n    /**\n     * @param {Function} func\n     * @return {enchant.Deferred}\n     * @static\n     */\n    enchant.Deferred.next = function(func) {\n        var q = new enchant.Deferred().next(func);\n        q._id = setTimeout(function() { q.call(); }, 0);\n        return q;\n    };\n    /**\n     * @param {Object|enchant.Deferred[]} arg\n     * @return {enchant.Deferred}\n     *\n     * @example\n     * // array\n     * enchant.Deferred\n     *     .parallel([\n     *         enchant.Deferred.next(function() {\n     *             return 24;\n     *         }),\n     *         enchant.Deferred.next(function() {\n     *             return 42;\n     *         })\n     *     ])\n     *     .next(function(arg) {\n     *         console.log(arg); // [ 24, 42 ]\n     *     });\n     * // object\n     * enchant.Deferred\n     *     .parallel({\n     *         foo: enchant.Deferred.next(function() {\n     *             return 24;\n     *         }),\n     *         bar: enchant.Deferred.next(function() {\n     *             return 42;\n     *         })\n     *     })\n     *     .next(function(arg) {\n     *         console.log(arg.foo); // 24\n     *         console.log(arg.bar); // 42\n     *     });\n     *\n     * @static\n     */\n    enchant.Deferred.parallel = function(arg) {\n        var q = new enchant.Deferred();\n        q._id = setTimeout(function() { q.call(); }, 0);\n        var progress = 0;\n        var ret = (arg instanceof Array) ? [] : {};\n        var p = new enchant.Deferred();\n        for (var prop in arg) {\n            if (arg.hasOwnProperty(prop)) {\n                progress++;\n                /*jshint loopfunc:true */\n                (function(queue, name) {\n                    queue.next(function(arg) {\n                        progress--;\n                        ret[name] = arg;\n                        if (progress <= 0) {\n                            p.call(ret);\n                        }\n                    })\n                    .error(function(err) { p.fail(err); });\n                    if (typeof queue._id === 'number') {\n                        clearTimeout(queue._id);\n                    }\n                    queue._id = setTimeout(function() { queue.call(); }, 0);\n                }(arg[prop], prop));\n            }\n        }\n        if (!progress) {\n            p._id = setTimeout(function() { p.call(ret); }, 0);\n        }\n        return q.next(function() { return p; });\n    };\n}\n\n/**\n * @scope enchant.DOMSound.prototype\n */\nenchant.DOMSound = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.DOMSound\n     * @class\n     * Class to wrap audio elements.\n     *\n     * Safari, Chrome, Firefox, Opera, and IE all play MP3 files\n     * (Firefox and Opera play via Flash). WAVE files can be played on\n     * Safari, Chrome, Firefox, and Opera. When the browser is not compatible with\n     * the used codec the file will not play.\n     *\n     * Instances are created not via constructor but via {@link enchant.DOMSound.load}.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function() {\n        enchant.EventTarget.call(this);\n        /**\n         * Sound file duration (seconds).\n         * @type Number\n         */\n        this.duration = 0;\n        throw new Error(\"Illegal Constructor\");\n    },\n    /**\n     * Begin playing.\n     */\n    play: function() {\n        if (this._element) {\n            this._element.play();\n        }\n    },\n    /**\n     * Pause playback.\n     */\n    pause: function() {\n        if (this._element) {\n            this._element.pause();\n        }\n    },\n    /**\n     * Stop playing.\n     */\n    stop: function() {\n        this.pause();\n        this.currentTime = 0;\n    },\n    /**\n     * Create a copy of this Sound object.\n     * @return {enchant.DOMSound} Copied Sound.\n     */\n    clone: function() {\n        var clone;\n        if (this._element instanceof Audio) {\n            clone = Object.create(enchant.DOMSound.prototype, {\n                _element: { value: this._element.cloneNode(false) },\n                duration: { value: this.duration }\n            });\n        } else if (enchant.ENV.USE_FLASH_SOUND) {\n            return this;\n        } else {\n            clone = Object.create(enchant.DOMSound.prototype);\n        }\n        enchant.EventTarget.call(clone);\n        return clone;\n    },\n    /**\n     * Current playback position (seconds).\n     * @type Number\n     */\n    currentTime: {\n        get: function() {\n            return this._element ? this._element.currentTime : 0;\n        },\n        set: function(time) {\n            if (this._element) {\n                this._element.currentTime = time;\n            }\n        }\n    },\n    /**\n     * Volume. 0 (muted) ～ 1 (full volume).\n     * @type Number\n     */\n    volume: {\n        get: function() {\n            return this._element ? this._element.volume : 1;\n        },\n        set: function(volume) {\n            if (this._element) {\n                this._element.volume = volume;\n            }\n        }\n    }\n});\n\n/**\n * Loads an audio file and creates DOMSound object.\n * @param {String} src Path of the audio file to be loaded.\n * @param {String} [type] MIME Type of the audio file.\n * @param {Function} [callback] on load callback.\n * @param {Function} [onerror] on error callback.\n * @return {enchant.DOMSound} DOMSound\n * @static\n */\nenchant.DOMSound.load = function(src, type, callback, onerror) {\n    if (type == null) {\n        var ext = enchant.Core.findExt(src);\n        if (ext) {\n            type = 'audio/' + ext;\n        } else {\n            type = '';\n        }\n    }\n    type = type.replace('mp3', 'mpeg').replace('m4a', 'mp4');\n    callback = callback || function() {};\n    onerror = onerror || function() {};\n\n    var sound = Object.create(enchant.DOMSound.prototype);\n    enchant.EventTarget.call(sound);\n    sound.addEventListener('load', callback);\n    sound.addEventListener('error', onerror);\n    var audio = new Audio();\n    if (!enchant.ENV.SOUND_ENABLED_ON_MOBILE_SAFARI &&\n        enchant.ENV.VENDOR_PREFIX === 'webkit' && enchant.ENV.TOUCH_ENABLED) {\n        window.setTimeout(function() {\n            sound.dispatchEvent(new enchant.Event('load'));\n        }, 0);\n    } else {\n        if (!enchant.ENV.USE_FLASH_SOUND && audio.canPlayType(type)) {\n            audio.addEventListener('canplaythrough', function canplay() {\n                sound.duration = audio.duration;\n                sound.dispatchEvent(new enchant.Event('load'));\n                audio.removeEventListener('canplaythrough', canplay);\n            }, false);\n            audio.src = src;\n            audio.load();\n            audio.autoplay = false;\n            audio.onerror = function() {\n                var e = new enchant.Event(enchant.Event.ERROR);\n                e.message = 'Cannot load an asset: ' + audio.src;\n                enchant.Core.instance.dispatchEvent(e);\n                sound.dispatchEvent(e);\n            };\n            sound._element = audio;\n        } else if (type === 'audio/mpeg') {\n            var embed = document.createElement('embed');\n            var id = 'enchant-audio' + enchant.Core.instance._soundID++;\n            embed.width = embed.height = 1;\n            embed.name = id;\n            embed.src = 'sound.swf?id=' + id + '&src=' + src;\n            embed.allowscriptaccess = 'always';\n            embed.style.position = 'absolute';\n            embed.style.left = '-1px';\n            sound.addEventListener('load', function() {\n                Object.defineProperties(embed, {\n                    currentTime: {\n                        get: function() {\n                            return embed.getCurrentTime();\n                        },\n                        set: function(time) {\n                            embed.setCurrentTime(time);\n                        }\n                    },\n                    volume: {\n                        get: function() {\n                            return embed.getVolume();\n                        },\n                        set: function(volume) {\n                            embed.setVolume(volume);\n                        }\n                    }\n                });\n                sound._element = embed;\n                sound.duration = embed.getDuration();\n            });\n            enchant.Core.instance._element.appendChild(embed);\n            enchant.DOMSound[id] = sound;\n        } else {\n            window.setTimeout(function() {\n                sound.dispatchEvent(new enchant.Event('load'));\n            }, 0);\n        }\n    }\n    return sound;\n};\n\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext || window.oAudioContext;\n\n/**\n * @scope enchant.WebAudioSound.prototype\n */\nenchant.WebAudioSound = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.WebAudioSound\n     * @class\n     * Sound wrapper class for Web Audio API (supported on some webkit-based browsers)\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function() {\n        if (!window.AudioContext) {\n            throw new Error(\"This browser does not support WebAudio API.\");\n        }\n        enchant.EventTarget.call(this);\n        if (!enchant.WebAudioSound.audioContext) {\n          enchant.WebAudioSound.audioContext = new window.AudioContext();\n          enchant.WebAudioSound.destination = enchant.WebAudioSound.audioContext.destination;\n        }\n        this.context = enchant.WebAudioSound.audioContext;\n        this.src = this.context.createBufferSource();\n        this.buffer = null;\n        this._volume = 1;\n        this._currentTime = 0;\n        this._state = 0;\n        this.connectTarget = enchant.WebAudioSound.destination;\n    },\n    /**\n     * Begin playing.\n     * @param {Boolean} [dup=false] If true, Object plays new sound while keeps last sound.\n     */\n    play: function(dup) {\n        if (this._state === 1 && !dup) {\n            this.src.disconnect();\n        }\n        if (this._state !== 2) {\n            this._currentTime = 0;\n        }\n        var offset = this._currentTime;\n        var actx = this.context;\n        this.src = actx.createBufferSource();\n        if (actx.createGain != null) {\n            this._gain = actx.createGain();\n        } else {\n            this._gain = actx.createGainNode();\n        }\n        this.src.buffer = this.buffer;\n        this._gain.gain.value = this._volume;\n\n        this.src.connect(this._gain);\n        this._gain.connect(this.connectTarget);\n        if (this.src.start != null) {\n            this.src.start(0, offset, this.buffer.duration - offset - 1.192e-7);\n        } else {\n            this.src.noteGrainOn(0, offset, this.buffer.duration - offset - 1.192e-7);\n        }\n        this._startTime = actx.currentTime - this._currentTime;\n        this._state = 1;\n    },\n    /**\n     * Pause playback.\n     */\n    pause: function() {\n        var currentTime = this.currentTime;\n        if (currentTime === this.duration) {\n            return;\n        }\n        if (this.src.stop != null) {\n            this.src.stop(0);\n        } else {\n            this.src.noteOff(0);\n        }\n        this._currentTime = currentTime;\n        this._state = 2;\n    },\n    /**\n     * Stop playing.\n     */\n    stop: function() {\n        if (this.src.stop != null) {\n            this.src.stop(0);\n        } else {\n            this.src.noteOff(0);\n        }\n        this._state = 0;\n    },\n    /**\n     * Create a copy of this Sound object.\n     * @return {enchant.WebAudioSound} Copied Sound.\n     */\n    clone: function() {\n        var sound = new enchant.WebAudioSound();\n        sound.buffer = this.buffer;\n        return sound;\n    },\n    /**\n     * Sound file duration (seconds).\n     * @type Number\n     */\n    duration: {\n        get: function() {\n            if (this.buffer) {\n                return this.buffer.duration;\n            } else {\n                return 0;\n            }\n        }\n    },\n    /**\n     * Volume. 0 (muted) ～ 1 (full volume).\n     * @type Number\n     */\n    volume: {\n        get: function() {\n            return this._volume;\n        },\n        set: function(volume) {\n            volume = Math.max(0, Math.min(1, volume));\n            this._volume = volume;\n            if (this.src) {\n                this._gain.gain.value = volume;\n            }\n        }\n    },\n    /**\n     * Current playback position (seconds).\n     * @type Number\n     */\n    currentTime: {\n        get: function() {\n            return Math.max(0, Math.min(this.duration, this.src.context.currentTime - this._startTime));\n        },\n        set: function(time) {\n            this._currentTime = time;\n            if (this._state !== 2) {\n                this.play(false);\n            }\n        }\n    }\n});\n\n/**\n * Loads an audio file and creates WebAudioSound object.\n * @param {String} src Path of the audio file to be loaded.\n * @param {String} [type] MIME Type of the audio file.\n * @param {Function} [callback] on load callback.\n * @param {Function} [onerror] on error callback.\n * @return {enchant.WebAudioSound} WebAudioSound\n * @static\n */\nenchant.WebAudioSound.load = function(src, type, callback, onerror) {\n    var canPlay = (new Audio()).canPlayType(type);\n    var sound = new enchant.WebAudioSound();\n    callback = callback || function() {};\n    onerror = onerror || function() {};\n    sound.addEventListener(enchant.Event.LOAD, callback);\n    sound.addEventListener(enchant.Event.ERROR, onerror);\n    function dispatchErrorEvent() {\n        var e = new enchant.Event(enchant.Event.ERROR);\n        e.message = 'Cannot load an asset: ' + src;\n        enchant.Core.instance.dispatchEvent(e);\n        sound.dispatchEvent(e);\n    }\n    var actx, xhr;\n    if (canPlay === 'maybe' || canPlay === 'probably') {\n        actx = enchant.WebAudioSound.audioContext;\n        xhr = new XMLHttpRequest();\n        xhr.open('GET', src, true);\n        xhr.responseType = 'arraybuffer';\n        xhr.onload = function() {\n            actx.decodeAudioData(xhr.response, function(buffer) {\n                sound.buffer = buffer;\n                sound.dispatchEvent(new enchant.Event(enchant.Event.LOAD));\n            }, dispatchErrorEvent);\n        };\n        xhr.onerror = dispatchErrorEvent;\n        xhr.send(null);\n    } else {\n        setTimeout(dispatchErrorEvent,  50);\n    }\n    return sound;\n};\n\nenchant.Sound = window.AudioContext && enchant.ENV.USE_WEBAUDIO ? enchant.WebAudioSound : enchant.DOMSound;\n\n/*\n * ============================================================================================\n * Easing Equations v2.0\n * September 1, 2003\n * (c) 2003 Robert Penner, all rights reserved.\n * This work is subject to the terms in http://www.robertpenner.com/easing_terms_of_use.html.\n * ============================================================================================\n */\n\n/**\n * @namespace\n * JavaScript translation of Robert Penner's \"Easing Equations\" library which is widely used in ActionScript.\n * \n * @param [t] the current time\n * @param [b] the property's initial value\n * @param [c] how much the value should change\n * @param [d] how much time should elapse before value is changed\n * \n * @return {Number}\n * <br/>\n * See: <a href=\"http://www.robertpenner.com/easing/\">\n * http://www.robertpenner.com/easing/</a>\n * <br/>\n * See: <a href=\"http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf\">\n * http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf</a>\n */\nenchant.Easing = {\n    LINEAR: function(t, b, c, d) {\n        return c * t / d + b;\n    },\n\n    SWING: function(t, b, c, d) {\n        return c * (0.5 - Math.cos(((t / d) * Math.PI)) / 2) + b;\n    },\n\n    // *** quad\n    QUAD_EASEIN: function(t, b, c, d) {\n        return c * (t /= d) * t + b;\n    },\n\n    QUAD_EASEOUT: function(t, b, c, d) {\n        return -c * (t /= d) * (t - 2) + b;\n    },\n\n    QUAD_EASEINOUT: function(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return c / 2 * t * t + b;\n        }\n        return -c / 2 * ((--t) * (t - 2) - 1) + b;\n    },\n\n    // *** cubic\n    CUBIC_EASEIN: function(t, b, c, d) {\n        return c * (t /= d) * t * t + b;\n    },\n\n    CUBIC_EASEOUT: function(t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t + 1) + b;\n    },\n\n    CUBIC_EASEINOUT: function(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return c / 2 * t * t * t + b;\n        }\n        return c / 2 * ((t -= 2) * t * t + 2) + b;\n    },\n\n    // *** quart\n    QUART_EASEIN: function(t, b, c, d) {\n        return c * (t /= d) * t * t * t + b;\n    },\n\n    QUART_EASEOUT: function(t, b, c, d) {\n        return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n    },\n\n    QUART_EASEINOUT: function(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return c / 2 * t * t * t * t + b;\n        }\n        return -c / 2 * ((t -= 2) * t * t * t - 2) + b;\n    },\n\n    // *** quint\n    QUINT_EASEIN: function(t, b, c, d) {\n        return c * (t /= d) * t * t * t * t + b;\n    },\n\n    QUINT_EASEOUT: function(t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n\n    QUINT_EASEINOUT: function(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return c / 2 * t * t * t * t * t + b;\n        }\n        return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n    },\n\n    // *** sin\n    SIN_EASEIN: function(t, b, c, d) {\n        return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\n    },\n\n    SIN_EASEOUT: function(t, b, c, d) {\n        return c * Math.sin(t / d * (Math.PI / 2)) + b;\n    },\n\n    SIN_EASEINOUT: function(t, b, c, d) {\n        return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;\n    },\n\n    // *** circ\n    CIRC_EASEIN: function(t, b, c, d) {\n        return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n    },\n\n    CIRC_EASEOUT: function(t, b, c, d) {\n        return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n    },\n\n    CIRC_EASEINOUT: function(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;\n        }\n        return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n    },\n\n    // *** elastic\n    ELASTIC_EASEIN: function(t, b, c, d, a, p) {\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n\n        if (!p) {\n            p = d * 0.3;\n        }\n\n        var s;\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        } else {\n            s = p / (2 * Math.PI) * Math.asin(c / a);\n        }\n        return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n    },\n\n    ELASTIC_EASEOUT: function(t, b, c, d, a, p) {\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        var s;\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        } else {\n            s = p / (2 * Math.PI) * Math.asin(c / a);\n        }\n        return (a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b);\n    },\n\n    ELASTIC_EASEINOUT: function(t, b, c, d, a, p) {\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d / 2) === 2) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * (0.3 * 1.5);\n        }\n        var s;\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        } else {\n            s = p / (2 * Math.PI) * Math.asin(c / a);\n        }\n        if (t < 1) {\n            return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n        }\n        return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * 0.5 + c + b;\n    },\n\n    // *** bounce\n    BOUNCE_EASEOUT: function(t, b, c, d) {\n        if ((t /= d) < (1 / 2.75)) {\n            return c * (7.5625 * t * t) + b;\n        } else if (t < (2 / 2.75)) {\n            return c * (7.5625 * (t -= (1.5 / 2.75)) * t + 0.75) + b;\n        } else if (t < (2.5 / 2.75)) {\n            return c * (7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375) + b;\n        } else {\n            return c * (7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375) + b;\n        }\n    },\n\n    BOUNCE_EASEIN: function(t, b, c, d) {\n        return c - enchant.Easing.BOUNCE_EASEOUT(d - t, 0, c, d) + b;\n    },\n\n    BOUNCE_EASEINOUT: function(t, b, c, d) {\n        if (t < d / 2) {\n            return enchant.Easing.BOUNCE_EASEIN(t * 2, 0, c, d) * 0.5 + b;\n        } else {\n            return enchant.Easing.BOUNCE_EASEOUT(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n        }\n\n    },\n\n    // *** back\n    BACK_EASEIN: function(t, b, c, d, s) {\n        if (s === undefined) {\n            s = 1.70158;\n        }\n        return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n\n    BACK_EASEOUT: function(t, b, c, d, s) {\n        if (s === undefined) {\n            s = 1.70158;\n        }\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n\n    BACK_EASEINOUT: function(t, b, c, d, s) {\n        if (s === undefined) {\n            s = 1.70158;\n        }\n        if ((t /= d / 2) < 1) {\n            return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;\n        }\n        return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;\n    },\n\n    // *** expo\n    EXPO_EASEIN: function(t, b, c, d) {\n        return (t === 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\n    },\n\n    EXPO_EASEOUT: function(t, b, c, d) {\n        return (t === d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;\n    },\n\n    EXPO_EASEINOUT: function(t, b, c, d) {\n        if (t === 0) {\n            return b;\n        }\n        if (t === d) {\n            return b + c;\n        }\n        if ((t /= d / 2) < 1) {\n            return c / 2 * Math.pow(2, 10 * (t - 1)) + b;\n        }\n        return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;\n    }\n};\n\n/**\n * @scope enchant.ActionEventTarget.prototype\n */\nenchant.ActionEventTarget = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.ActionEventTarget\n     * @class\n     * EventTarget which can change the context of event listeners.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function() {\n        enchant.EventTarget.apply(this, arguments);\n    },\n    dispatchEvent: function(e) {\n        var target = this.node ? this.node : this;\n\n        e.target = target;\n        e.localX = e.x - target._offsetX;\n        e.localY = e.y - target._offsetY;\n\n        if (this['on' + e.type] != null) {\n            this['on' + e.type].call(target, e);\n        }\n        var listeners = this._listeners[e.type];\n        if (listeners != null) {\n            listeners = listeners.slice();\n            for (var i = 0, len = listeners.length; i < len; i++) {\n                listeners[i].call(target, e);\n            }\n        }\n    }\n});\n\n/**\n * @scope enchant.Timeline.prototype\n */\nenchant.Timeline = enchant.Class.create(enchant.EventTarget, {\n    /**\n     * @name enchant.Timeline\n     * @class\n     * Time-line class.\n     * Class for managing the action.\n     *\n     * For one node to manipulate the timeline of one must correspond.\n     * Time-line class has a method to add a variety of actions to himself,\n     * entities can be animated and various operations by using these briefly.\n     * You can choose time based and frame based(default) animation.\n     * @param {enchant.Node} node target node.\n     * @constructs\n     * @extends enchant.EventTarget\n     */\n    initialize: function(node) {\n        enchant.EventTarget.call(this);\n        this.node = node;\n        this.queue = [];\n        this.paused = false;\n        this.looped = false;\n        this.isFrameBased = true;\n        this._parallel = null;\n        this._activated = false;\n        this.addEventListener(enchant.Event.ENTER_FRAME, this._onenterframe);\n\n        var tl = this;\n        this._nodeEventListener = function(e) {\n            tl.dispatchEvent(e);\n        };\n    },\n    /**\n     * @private\n     */\n    _deactivateTimeline: function() {\n        if (this._activated) {\n            this._activated = false;\n            this.node.removeEventListener('enterframe', this._nodeEventListener);\n        }\n    },\n    /**\n     * @private\n     */\n    _activateTimeline: function() {\n        if (!this._activated && !this.paused) {\n            this.node.addEventListener(\"enterframe\", this._nodeEventListener);\n            this._activated = true;\n        }\n    },\n    /**\n     * @private\n     */\n    _onenterframe: function(evt) {\n        if (this.paused) {\n            return;\n        }\n\n        this.tick(this.isFrameBased ? 1 : evt.elapsed);\n    },\n    /**\n     */\n    setFrameBased: function() {\n        this.isFrameBased = true;\n    },\n    /**\n     */\n    setTimeBased: function() {\n        this.isFrameBased = false;\n    },\n    /**\n     */\n    next: function(remainingTime) {\n        var e, action = this.queue.shift();\n\n        if (action) {\n            e = new enchant.Event(\"actionend\");\n            e.timeline = this;\n            action.dispatchEvent(e);\n\n            e = new enchant.Event(\"removedfromtimeline\");\n            e.timeline = this;\n            action.dispatchEvent(e);\n\n            if (this.looped) {\n                this.add(action);\n            }\n        }\n\n        if (this.queue.length === 0) {\n            this._deactivateTimeline();\n            return;\n        }\n\n        if (remainingTime > 0 || (this.queue[0] && this.queue[0].time === 0)) {\n            var event = new enchant.Event(\"actiontick\");\n            event.elapsed = remainingTime;\n            event.timeline = this;\n            this.queue[0].dispatchEvent(event);\n        }\n    },\n    /**\n     * @param {Number} elapsed\n     */\n    tick: function(elapsed) {\n        if (this.queue.length > 0) {\n            var action = this.queue[0];\n            if (action.frame === 0) {\n                var f;\n                f = new enchant.Event(\"actionstart\");\n                f.timeline = this;\n                action.dispatchEvent(f);\n            }\n\n            var e = new enchant.Event(\"actiontick\");\n            e.timeline = this;\n            e.elapsed = elapsed;\n            action.dispatchEvent(e);\n        }\n    },\n    /**\n     * @param {enchant.Action} action\n     * @return {enchant.Timeline}\n     */\n    add: function(action) {\n        this._activateTimeline();\n        if (this._parallel) {\n            this._parallel.actions.push(action);\n            this._parallel = null;\n        } else {\n            this.queue.push(action);\n        }\n        action.frame = 0;\n\n        var e = new enchant.Event(\"addedtotimeline\");\n        e.timeline = this;\n        action.dispatchEvent(e);\n\n        e = new enchant.Event(\"actionadded\");\n        e.action = action;\n        this.dispatchEvent(e);\n\n        return this;\n    },\n    /**\n     * @param {Object} params\n     * @return {enchant.Timeline}\n     */\n    action: function(params) {\n        return this.add(new enchant.Action(params));\n    },\n    /**\n     * @param {Object} params\n     * @return {enchant.Timeline}\n     */\n    tween: function(params) {\n        return this.add(new enchant.Tween(params));\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    clear: function() {\n        var e = new enchant.Event(\"removedfromtimeline\");\n        e.timeline = this;\n\n        for (var i = 0, len = this.queue.length; i < len; i++) {\n            this.queue[i].dispatchEvent(e);\n        }\n        this.queue = [];\n        this._deactivateTimeline();\n        return this;\n    },\n    /**\n     * @param {Number} frames\n     * @return {enchant.Timeline}\n     */\n    skip: function(frames) {\n        var event = new enchant.Event(\"enterframe\");\n        if (this.isFrameBased) {\n            event.elapsed = 1;\n        } else {\n            event.elapsed = frames;\n            frames = 1;\n        }\n        while (frames--) {\n            this.dispatchEvent(event);\n        }\n        return this;\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    pause: function() {\n        if (!this.paused) {\n            this.paused = true;\n            this._deactivateTimeline();\n        }\n        return this;\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    resume: function() {\n        if (this.paused) {\n            this.paused = false;\n            this._activateTimeline();\n        }\n        return this;\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    loop: function() {\n        this.looped = true;\n        return this;\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    unloop: function() {\n        this.looped = false;\n        return this;\n    },\n    /**\n     * @param {Number} time\n     * @return {enchant.Timeline}\n     */\n    delay: function(time) {\n        return this.action({\n            time: time\n        });\n    },\n    /**\n     * @ignore\n     * @param {Number} time\n     */\n    wait: function(time) {\n        // reserved\n        return this;\n    },\n    /**\n     * @param {Function} func\n     * @return {enchant.Timeline}\n     */\n    then: function(func) {\n        return this.action({\n            onactiontick: function(evt) {\n                func.call(this);\n            },\n            // if time is 0, next action will be immediately executed\n            time: 0\n        });\n    },\n    /**\n     * @param {Function} func\n     * @return {enchant.Timeline}\n     */\n    exec: function(func) {\n        return this.then(func);\n    },\n    /**\n     * @param {Object} cue\n     * @return {enchant.Timeline}\n     */\n    cue: function(cue) {\n        var ptr = 0;\n        for (var frame in cue) {\n            if (cue.hasOwnProperty(frame)) {\n                this.delay(frame - ptr);\n                this.then(cue[frame]);\n                ptr = frame;\n            }\n        }\n        return this;\n    },\n    /**\n     * @param {Function} func\n     * @param {Number} time\n     * @return {enchant.Timeline}\n     */\n    repeat: function(func, time) {\n        return this.action({\n            onactiontick: function(evt) {\n                func.call(this);\n            },\n            time: time\n        });\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    and: function() {\n        var last = this.queue.pop();\n        if (last instanceof enchant.ParallelAction) {\n            this._parallel = last;\n            this.queue.push(last);\n        } else {\n            var parallel = new enchant.ParallelAction();\n            parallel.actions.push(last);\n            this.queue.push(parallel);\n            this._parallel = parallel;\n        }\n        return this;\n    },\n    /**\n     * @ignore\n     */\n    or: function() {\n        return this;\n    },\n    /**\n     * @ignore\n     */\n    doAll: function(children) {\n        return this;\n    },\n    /**\n     * @ignore\n     */\n    waitAll: function() {\n        return this;\n    },\n    /**\n     * @param {Function} func\n     * @return {enchant.Timeline}\n     */\n    waitUntil: function(func) {\n        return this.action({\n            onactiontick: function(evt) {\n                if (func.call(this)) {\n                    evt.timeline.next();\n                }\n            }\n        });\n    },\n    /**\n     * @param {Number} opacity\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    fadeTo: function(opacity, time, easing) {\n        return this.tween({\n            opacity: opacity,\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    fadeIn: function(time, easing) {\n        return this.fadeTo(1, time, easing);\n    },\n    /**\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    fadeOut: function(time, easing) {\n        return this.fadeTo(0, time, easing);\n    },\n    /**\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    moveTo: function(x, y, time, easing) {\n        return this.tween({\n            x: x,\n            y: y,\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} x\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    moveX: function(x, time, easing) {\n        return this.tween({\n            x: x,\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} y\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    moveY: function(y, time, easing) {\n        return this.tween({\n            y: y,\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    moveBy: function(x, y, time, easing) {\n        return this.tween({\n            x: function() {\n                return this.x + x;\n            },\n            y: function() {\n                return this.y + y;\n            },\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    hide: function() {\n        return this.then(function() {\n            this.opacity = 0;\n        });\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    show: function() {\n        return this.then(function() {\n            this.opacity = 1;\n        });\n    },\n    /**\n     * @return {enchant.Timeline}\n     */\n    removeFromScene: function() {\n        return this.then(function() {\n            this.parentNode.removeChild(this);\n        });\n    },\n    /**\n     * @param {Number} scaleX\n     * @param {Number} [scaleY]\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    scaleTo: function(scale, time, easing) {\n        var scaleX, scaleY;\n\n        if (typeof easing === \"number\") {\n            scaleX = arguments[0];\n            scaleY = arguments[1];\n            time = arguments[2];\n            easing = arguments[3];\n        } else {\n            scaleX = scaleY = scale;\n        }\n\n        return this.tween({\n            scaleX: scaleX,\n            scaleY: scaleY,\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} scaleX\n     * @param {Number} [scaleY]\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    scaleBy: function(scale, time, easing) {\n        var scaleX, scaleY;\n\n        if (typeof easing === \"number\") {\n            scaleX = arguments[0];\n            scaleY = arguments[1];\n            time = arguments[2];\n            easing = arguments[3];\n        } else {\n            scaleX = scaleY = scale;\n        }\n\n        return this.tween({\n            scaleX: function() {\n                return this.scaleX * scaleX;\n            },\n            scaleY: function() {\n                return this.scaleY * scaleY;\n            },\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} deg\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    rotateTo: function(deg, time, easing) {\n        return this.tween({\n            rotation: deg,\n            time: time,\n            easing: easing\n        });\n    },\n    /**\n     * @param {Number} deg\n     * @param {Number} time\n     * @param {Function} [easing=enchant.Easing.LINEAR]\n     * @return {enchant.Timeline}\n     */\n    rotateBy: function(deg, time, easing) {\n        return this.tween({\n            rotation: function() {\n                return this.rotation + deg;\n            },\n            time: time,\n            easing: easing\n        });\n    }\n});\n\n/**\n * @scope enchant.Action.prototype\n */\nenchant.Action = enchant.Class.create(enchant.ActionEventTarget, {\n    /**\n     * @name enchant.Action\n     * @class\n     * Actions are units that make up the timeline.\n     * It is a unit used to specify the action you want to perform.\n     * \n     * Actions that have been added to the timeline are performed in sequential order.\n     * The transition from one action to the next occurs automatically \n     * after the number of frames specified by the time parameter have elapsed.\n     *\n     * An actionstart event is fired when the action has started.\n     * An actionend event is fired when the action has stopped.\n     * For each frame that elapses, an actiontick event is fired.\n     * \n     * You can specify a listener for these events to perform specific events when they occur.\n     *\n     * @param {Object} param\n     * @param {Number} [param.time] The number of frames that the action will persist. For an infinite number set this to null.\n     * @param {Function} [param.onactionstart] Event listener for when the action is initiated.\n     * @param {Function} [param.onactiontick] Event listener for when the action has passed one frame.\n     * @param {Function} [param.onactionend] Event listener for when the action is finished.\n     * @constructs\n     * @extends enchant.ActionEventTarget\n     */\n    initialize: function(param) {\n        enchant.ActionEventTarget.call(this);\n        this.time = null;\n        this.frame = 0;\n        for (var key in param) {\n            if (param.hasOwnProperty(key)) {\n                if (param[key] != null) {\n                    this[key] = param[key];\n                }\n            }\n        }\n        var action = this;\n\n        this.timeline = null;\n        this.node = null;\n\n        this.addEventListener(enchant.Event.ADDED_TO_TIMELINE, function(evt) {\n            action.timeline = evt.timeline;\n            action.node = evt.timeline.node;\n            action.frame = 0;\n        });\n\n        this.addEventListener(enchant.Event.REMOVED_FROM_TIMELINE, function() {\n            action.timeline = null;\n            action.node = null;\n            action.frame = 0;\n        });\n\n        this.addEventListener(enchant.Event.ACTION_TICK, function(evt) {\n            var remaining = action.time - (action.frame + evt.elapsed);\n            if (action.time != null && remaining <= 0) {\n                action.frame = action.time;\n                evt.timeline.next(-remaining);\n            } else {\n                action.frame += evt.elapsed;\n            }\n        });\n\n    }\n});\n\n/**\n * @scope enchant.ParallelAction.prototype\n */\nenchant.ParallelAction = enchant.Class.create(enchant.Action, {\n    /**\n     * @name enchant.ParallelAction\n     * @class\n     * Actions to be executed in parallel.\n     * It's possible to have more than one child action.\n     * @constructs\n     * @extends enchant.Action\n     */\n    initialize: function(param) {\n        enchant.Action.call(this, param);\n        /**\n         * Children Actions.\n         * @type enchant.Action[]\n         */\n        this.actions = [];\n        /**\n         * Removed actions.\n         * @type enchant.Action[]\n         */\n        this.endedActions = [];\n        var that = this;\n\n        this.addEventListener(enchant.Event.ACTION_START, function(evt) {\n            for (var i = 0, len = that.actions.length; i < len; i++) {\n                that.actions[i].dispatchEvent(evt);\n            }\n        });\n\n        this.addEventListener(enchant.Event.ACTION_TICK, function(evt) {\n            var i, len, timeline = {\n                next: function(remaining) {\n                    var action = that.actions[i];\n                    that.actions.splice(i--, 1);\n                    len = that.actions.length;\n                    that.endedActions.push(action);\n\n                    var e = new enchant.Event(\"actionend\");\n                    e.timeline = this;\n                    action.dispatchEvent(e);\n\n                    e = new enchant.Event(\"removedfromtimeline\");\n                    e.timeline = this;\n                    action.dispatchEvent(e);\n                }\n            };\n\n            var e = new enchant.Event(\"actiontick\");\n            e.timeline = timeline;\n            e.elapsed = evt.elapsed;\n            for (i = 0, len = that.actions.length; i < len; i++) {\n                that.actions[i].dispatchEvent(e);\n            }\n\n            if (that.actions.length === 0) {\n                evt.timeline.next();\n            }\n        });\n\n        this.addEventListener(enchant.Event.ADDED_TO_TIMELINE, function(evt) {\n            for (var i = 0, len = that.actions.length; i < len; i++) {\n                that.actions[i].dispatchEvent(evt);\n            }\n        });\n\n        this.addEventListener(enchant.Event.REMOVED_FROM_TIMELINE, function() {\n            that.actions = that.endedActions;\n            that.endedActions = [];\n        });\n\n    }\n});\n\n/**\n * @scope enchant.Tween.prototype\n */\nenchant.Tween = enchant.Class.create(enchant.Action, {\n    /**\n     * @name enchant.Tween\n     * @class\n     * @param {Object} params\n     * @param {Number} params.time\n     * @param {Function} [params.easing=enchant.Easing.LINEAR]\n     * @constructs\n     * @extends enchant.Action\n     */\n    initialize: function(params) {\n        var origin = {};\n        var target = {};\n        enchant.Action.call(this, params);\n\n        if (this.easing == null) {\n            this.easing = enchant.Easing.LINEAR;\n        }\n\n        var tween = this;\n        this.addEventListener(enchant.Event.ACTION_START, function() {\n            // excepted property\n            var excepted = [\"frame\", \"time\", \"callback\", \"onactiontick\", \"onactionstart\", \"onactionend\"];\n            for (var prop in params) {\n                if (params.hasOwnProperty(prop)) {\n                    // if function is used instead of numerical value, evaluate it\n                    var target_val;\n                    if (typeof params[prop] === \"function\") {\n                        target_val = params[prop].call(tween.node);\n                    } else {\n                        target_val = params[prop];\n                    }\n\n                    if (excepted.indexOf(prop) === -1) {\n                        origin[prop] = tween.node[prop];\n                        target[prop] = target_val;\n                    }\n                }\n            }\n        });\n\n        this.addEventListener(enchant.Event.ACTION_TICK, function(evt) {\n            // if time is 0, set property to target value immediately\n            var ratio = tween.time === 0 ? 1 : tween.easing(Math.min(tween.time,tween.frame + evt.elapsed), 0, 1, tween.time) - tween.easing(tween.frame, 0, 1, tween.time);\n\n            for (var prop in target){\n                if (target.hasOwnProperty(prop)) {\n                    if (typeof this[prop] === \"undefined\"){\n                        continue;\n                    }\n                    tween.node[prop] += (target[prop] - origin[prop]) * ratio;\n                    if (Math.abs(tween.node[prop]) < 10e-8){\n                        tween.node[prop] = 0;\n                    }\n                }\n            }\n        });\n    }\n});\n\n}(window));\n","/**\n * @fileOverview\n * ui.enchant.js v2 (2012/11/05)\n * ui parts support\n * @require enchant.js v0.5.2 or later\n * @require image files for gamepad, icons (default: pad.png, apad.png, icon0.png, font0.png)\n *\n * @features\n * - D-Pad (left, right, up, down)\n * - Analog Pad\n * - Button (3 built-in themes and can be customized)\n * - MutableText\n * - ScoreLabel\n * - TimeLabel\n * - LifeLabel\n * - Bar\n * - VirtualMap\n *\n * @usage\n * [D-Pad]\n *      var pad = new Pad();\n *      pad.x = 0;\n *      pad.y = 220;\n *      core.rootScene.addChild(pad);\n *  (input of X direction can be detected from \"Xbuttonup\" \"Xbuttondown\" events\n *   or enchant.Core.instance.input.X)\n *\n * [A-Pad]\n *      var pad = new APad();\n *      pad.x = 0;\n *      pad.y = 220;\n *      core.rootScene.addChild(pad);\n *  (input can be detected from pad.vx/vy and pad.touched)\n *\n * [Button]\n *      var button = new Button(\"Press me\");\n *      button.addEventListener(\"touchstart\", function(){ ... })\n *      core.rootScene.addEventListener(button);\n *\n *      var button_light = new Button(\"Press me\", \"light\");\n *      core.rootScene.addEventListener(button);\n *\n *      var button_blue = new Button(\"Press me\", \"blue\");\n *      core.rootScene.addEventListener(button);\n */\n\n/**\n * @type {Object}\n */\nenchant.ui = { assets: ['pad.png', 'apad.png', 'icon0.png', 'font0.png'] };\n\n/**\n * 方向キーパッドのクラス: Pad\n * @scope enchant.ui.Pad\n */\nenchant.ui.Pad = enchant.Class.create(enchant.Sprite, {\n    /**\n     * 方向キーパッドオブジェクトを作成する。\n     * @constructs\n     * @extends enchant.Sprite\n     */\n    initialize: function() {\n        var core = enchant.Core.instance;\n        var image = core.assets['pad.png'];\n        enchant.Sprite.call(this, image.width / 2, image.height);\n        this.image = image;\n        this.input = { left: false, right: false, up: false, down: false };\n        this.addEventListener('touchstart', function(e) {\n            this._updateInput(this._detectInput(e.localX, e.localY));\n        });\n        this.addEventListener('touchmove', function(e) {\n            this._updateInput(this._detectInput(e.localX, e.localY));\n        });\n        this.addEventListener('touchend', function(e) {\n            this._updateInput({ left: false, right: false, up: false, down: false });\n        });\n    },\n    _detectInput: function(x, y) {\n        x -= this.width * 0.5;\n        y -= this.height * 0.5;\n        var input = { left: false, right: false, up: false, down: false };\n        if (x * x + y * y <= 2500 && x * x + y * y > 200) {\n            if (x < 0 && y < x * x * 0.1 && y > x * x * -0.1) {\n                input.left = true;\n            }\n            if (x > 0 && y < x * x * 0.1 && y > x * x * -0.1) {\n                input.right = true;\n            }\n            if (y < 0 && x < y * y * 0.1 && x > y * y * -0.1) {\n                input.up = true;\n            }\n            if (y > 0 && x < y * y * 0.1 && x > y * y * -0.1) {\n                input.down = true;\n            }\n        }\n        return input;\n    },\n    _updateInput: function(input) {\n        var core = enchant.Core.instance;\n        ['left', 'right', 'up', 'down'].forEach(function(type) {\n            if (this.input[type] && !input[type]) {\n                core.changeButtonState(type, false);\n            }\n            if (!this.input[type] && input[type]) {\n                core.changeButtonState(type, true);\n            }\n        }, this);\n        this.input = input;\n    }\n});\n\n/**\n * アナログパッドのクラス: APad\n * @scope enchant.ui.APad\n */\nenchant.ui.APad = enchant.Class.create(enchant.Group, {\n    /**\n     * アナログパッドオブジェクトを作成する。\n     * @constructs\n     * @extends enchant.Group\n     * @param mode\n     *   'direct': 入力ベクトルは正規化されない (大きさは 0~1 の間)\n     *   'normal': 入力ベクトルを常に正規化する (大きさは常に1となる)\n     */\n    initialize: function(mode) {\n        var core = enchant.Core.instance;\n        var image = core.assets['apad.png'];\n        var w = this.width = image.width;\n        var h = this.height = image.height;\n        enchant.Group.call(this);\n\n        this.outside = new enchant.Sprite(w, h);\n        var outsideImage = new enchant.Surface(w, h);\n        outsideImage.draw(image, 0, 0, w, h / 4, 0, 0, w, h / 4);\n        outsideImage.draw(image, 0, h / 4 * 3, w, h / 4, 0, h / 4 * 3, w, h / 4);\n        outsideImage.draw(image, 0, h / 4, w / 4, h / 2, 0, h / 4, w / 4, h / 2);\n        outsideImage.draw(image, w / 4 * 3, h / 4, w / 4, h / 2, w / 4 * 3, h / 4, w / 4, h / 2);\n        this.outside.image = outsideImage;\n        this.inside = new enchant.Sprite(w / 2, h / 2);\n        var insideImage = new enchant.Surface(w / 2, h / 2);\n        insideImage.draw(image, w / 4, h / 4, w / 2, h / 2, 0, 0, w / 2, h / 2);\n        this.inside.image = insideImage;\n        this.r = w / 2;\n\n        /**\n         * isTouched\n         * @type {Boolean}\n         * タッチされているかどうか\n         */\n        this.isTouched = false;\n\n        /**\n         * vx, vy\n         * @type {Number}\n         * 入力ベクトルの(x, y)方向の大きさ\n         */\n        this.vx = 0;\n        this.vy = 0;\n\n        /**\n         * rad, dist\n         * @type {Number}\n         * 入力ベクトルの極座標表示\n         * radは角度、distはベクトルの大きさを示す\n         */\n        this.rad = 0;\n        this.dist = 0;\n\n        if (mode === 'direct') {\n            this.mode = 'direct';\n        } else {\n            this.mode = 'normal';\n        }\n        this._updateImage();\n        this.addChild(this.inside);\n        this.addChild(this.outside);\n        this.addEventListener('touchstart', function(e) {\n            this._detectInput(e.localX, e.localY);\n            this._calcPolar(e.localX, e.localY);\n            this._updateImage(e.localX, e.localY);\n            this._dispatchPadEvent('apadstart');\n            this.isTouched = true;\n        });\n        this.addEventListener('touchmove', function(e) {\n            this._detectInput(e.localX, e.localY);\n            this._calcPolar(e.localX, e.localY);\n            this._updateImage(e.localX, e.localY);\n            this._dispatchPadEvent('apadmove');\n        });\n        this.addEventListener('touchend', function(e) {\n            this._detectInput(this.width / 2, this.height / 2);\n            this._calcPolar(this.width / 2, this.height / 2);\n            this._updateImage(this.width / 2, this.height / 2);\n            this._dispatchPadEvent('apadend');\n            this.isTouched = false;\n        });\n    },\n    _dispatchPadEvent: function(type) {\n        var e = new enchant.Event(type);\n        e.vx = this.vx;\n        e.vy = this.vy;\n        e.rad = this.rad;\n        e.dist = this.dist;\n        this.dispatchEvent(e);\n    },\n    _updateImage: function(x, y) {\n        x -= this.width / 2;\n        y -= this.height / 2;\n        this.inside.x = this.vx * (this.r - 10) + 25;\n        this.inside.y = this.vy * (this.r - 10) + 25;\n    },\n    _detectInput: function(x, y) {\n        x -= this.width / 2;\n        y -= this.height / 2;\n        var distance = Math.sqrt(x * x + y * y);\n        var tan = y / x;\n        var rad = Math.atan(tan);\n        var dir = x / Math.abs(x);\n        if (distance === 0) {\n            this.vx = 0;\n            this.vy = 0;\n        } else if (x === 0) {\n            this.vx = 0;\n            if (this.mode === 'direct') {\n                this.vy = (y / this.r);\n            } else {\n                dir = y / Math.abs(y);\n                this.vy = Math.pow((y / this.r), 2) * dir;\n            }\n        } else if (distance < this.r) {\n            if (this.mode === 'direct') {\n                this.vx = (x / this.r);\n                this.vy = (y / this.r);\n            } else {\n                this.vx = Math.pow((distance / this.r), 2) * Math.cos(rad) * dir;\n                this.vy = Math.pow((distance / this.r), 2) * Math.sin(rad) * dir;\n            }\n        } else {\n            this.vx = Math.cos(rad) * dir;\n            this.vy = Math.sin(rad) * dir;\n        }\n    },\n    _calcPolar: function(x, y) {\n        x -= this.width / 2;\n        y -= this.height / 2;\n        var add = 0;\n        var rad = 0;\n        var dist = Math.sqrt(x * x + y * y);\n        if (dist > this.r) {\n            dist = this.r;\n        }\n        dist /= this.r;\n        if (this.mode === 'normal') {\n            dist *= dist;\n        }\n        if (x >= 0 && y < 0) {\n            add = Math.PI / 2 * 3;\n            rad = x / y;\n        } else if (x < 0 && y <= 0) {\n            add = Math.PI;\n            rad = y / x;\n        } else if (x <= 0 && y > 0) {\n            add = Math.PI / 2;\n            rad = x / y;\n        } else if (x > 0 && y >= 0) {\n            add = 0;\n            rad = y / x;\n        }\n        if (x === 0 || y === 0) {\n            rad = 0;\n        }\n        this.rad = Math.abs(Math.atan(rad)) + add;\n        this.dist = dist;\n    }\n});\n\n/**\n * ボタンオブジェクトのクラス: Button\n * available in only DOMGroup\n *\n * @scope enchant.ui.Button.prototype\n * @deprecated\n * @classes\n */\nenchant.ui.Button = enchant.Class.create(enchant.Entity, {\n    /**\n     * ボタンオブジェクトを作成する。\n     * @constructs\n     * @extends enchant.Entity\n     */\n    initialize: function(text, theme, height, width) {\n        enchant.Entity.call(this);\n\n        if (enchant.CanvasLayer) {\n            this._element = 'div';\n        }\n\n        this.width = width || null;\n        this.height = height || null;\n        this.text = text;\n        this.pressed = false;\n\n        // デフォルトのスタイル (テーマで上書き可能)\n        var style = this._style;\n        style[\"display\"] = \"inline-block\";\n        style[\"font-size\"] = \"12px\";\n        style[\"height\"] = \"2em\";\n        style[\"line-height\"] = \"2em\";\n        style[\"min-width\"] = \"2em\";\n        style[\"padding\"] = \"2px 10px\";\n        style[\"text-align\"] = \"center\";\n        style[\"font-weight\"] = \"bold\";\n        style[\"border-radius\"] = \"0.5em\";\n\n        // テーマの指定がなければ \"dark\" を使う\n        theme = theme || \"dark\";\n\n        if (typeof theme === \"string\") {\n            // theme 引数が string なら、その名前のデフォルトテーマを使う\n            this.theme = enchant.ui.Button.DEFAULT_THEME[theme];\n        } else {\n            // theme 引数が object なら、その引数をテーマとして扱う\n            this.theme = theme;\n        }\n\n        // テーマを適用する\n        this._applyTheme(this.theme.normal);\n\n        // タッチしたときの挙動\n        this.addEventListener(\"touchstart\", function() {\n            this._applyTheme(this.theme.active);\n            this.pressed = true;\n            this.y++;\n        });\n\n        // タッチが離されたときの挙動\n        this.addEventListener(\"touchend\", function() {\n            this._applyTheme(this.theme.normal);\n            this.pressed = false;\n            this.y--;\n        });\n    },\n    _applyTheme: function(theme) {\n        var style = this._style;\n        var css = enchant.ui.Button.theme2css(theme);\n        for (var i in css) {\n            if (css.hasOwnProperty(i)) {\n                style[i] = css[i];\n            }\n        }\n    },\n    /**\n     * 表示するテキスト\n     * @type {String}\n     */\n    text: {\n        get: function() {\n            return this._text;\n        },\n        set: function(text) {\n                this._text = text;\n            if (!enchant.CanvasLayer) {\n                this._element.innerHTML = text;\n            }\n        }\n    },\n    /**\n     * フォントサイズ\n     */\n    size: {\n        get: function() {\n            return this._style.fontSize;\n        },\n        set: function(size) {\n            this._style.fontSize = size;\n        }\n    },\n    /**\n     * フォントの指定\n     * @type {String}\n     */\n    font: {\n        get: function() {\n            return this._style.font;\n        },\n        set: function(font) {\n            this._style.font = font;\n        }\n    },\n    /**\n     * Text color settings.\n     * CSS 'color' can be set to same format as properties.\n     * @type {String}\n     */\n    color: {\n        get: function() {\n            return this._style.color;\n        },\n        set: function(color) {\n            this._style.color = color;\n        }\n    },\n    cvsRender: function() {\n        // not available now\n    },\n    domRender: function() {\n        var element = this._domManager.element;\n        element.innerHTML = this._text;\n        element.style.font = this._font;\n        element.style.color = this._color;\n        element.style.textAlign = this._textAlign;\n    }\n});\n\nenchant.ui.Button.theme2css = function(theme) {\n    var prefix = '-' + enchant.ENV.VENDOR_PREFIX.toLowerCase() + '-';\n    var obj = {};\n    var bg = theme.background;\n    var bd = theme.border;\n    var ts = theme.textShadow;\n    var bs = theme.boxShadow;\n    if (prefix === '-ms-') {\n        obj['background'] = bg.start;\n    } else {\n        obj['background-image'] = prefix + bg.type + '('+ [ 'top', bg.start, bg.end ] + ')';\n    }\n    obj['color'] = theme.color;\n    obj['border'] = bd.color + ' ' + bd.width + ' ' + bd.type;\n    obj['text-shadow'] = ts.offsetX + 'px ' + ts.offsetY + 'px ' + ts.blur + ' ' + ts.color;\n    obj['box-shadow'] = bs.offsetX + 'px ' + bs.offsetY + 'px ' + bs.blur + ' ' + bs.color;\n    return obj;\n};\n\nenchant.ui.Button.DEFAULT_THEME = {\n    dark: {\n        normal: {\n            color: '#fff',\n            background: { type: 'linear-gradient', start: '#666', end: '#333' },\n            border: { color: '#333', width: 1, type: 'solid' },\n            textShadow: { offsetX: 0, offsetY: 1, blur: 0, color: '#666' },\n            boxShadow: { offsetX: 0, offsetY: 1, blur: 0, color: 'rgba(255, 255, 255, 0.3)' }\n        },\n        active: {\n            color: '#ccc',\n            background: { type: 'linear-gradient', start: '#333', end: '#000' },\n            border: { color: '#333', width: 1, type: 'solid' },\n            textShadow: { offsetX: 0, offsetY: 1, blur: 0, color: '#000' },\n            boxShadow: { offsetX: 0, offsetY: 1, blur: 0, color: 'rgba(255, 255, 255, 0.3)' }\n        }\n    },\n    light: {\n        normal: {\n            color: '#333',\n            background: { type: 'linear-gradient', start: '#fff', end:'#ccc' },\n            border: { color: '#999', width: 1, type: 'solid' },\n            textShadow: { offsetX: 0, offsetY: 1, blur: 0, color: '#fff' },\n            boxShadow: { offsetX: 0, offsetY: 1, blur: 0, color: 'rgba(0, 0, 0, 1)' },\n        },\n        active: {\n            color: '#333',\n            background: { type: 'linear-gradient', start: '#ccc', end: '#999' },\n            border: { color: '#666', width: 1, type: 'solid' },\n            textShadow: { offsetX: 0, offsetY: 1, blur: 0, color: '#ccc' },\n            boxShadow: { offsetX: 0, offsetY: 1, blur: 0, color: 'rgba(255, 255, 255, 0.3)' }\n        }\n    },\n    blue: {\n        normal: {\n            color: '#fff',\n            background: { type: 'linear-gradient', start: '#04f', end: '#04c' },\n            border: { color: '#026', width: 1, type: 'solid' },\n            textShadow: { offsetX: 0, offsetY: 1, blur: 0, color: '#666' },\n            boxShadow: { offsetX: 0, offsetY: 1, blur: 0, color: 'rgba(0, 0, 0, 0.5)' }\n        },\n        active: {\n            color: '#ccc',\n            background: { type: 'linear-gradient', start: '#029', end: '#026' },\n            border: { color: '#026', width: 1, type: 'solid' },\n            textShadow: { offsetX: 0, offsetY: 1, blur: 0, color: '#000' },\n            boxShadow: 'none'\n        }\n    }\n};\n\n/**\n * @scope enchant.ui.MutableText.prototype\n * @type {*}\n */\nenchant.ui.MutableText = enchant.Class.create(enchant.Sprite, {\n    /**\n     *\n     * @usage\n     *     var text = new MutableText(0, 0);\n     *     game.text = 'Hello, world!';\n     *     game.rootScene.addChild(text);\n     *\n     * @constructs\n     * @param posX\n     * @param posY\n     * @param width\n     */\n    initialize: function(x, y, width) {\n        enchant.Sprite.call(this, 0, 0);\n        this.fontSize = 16;\n        this.widthItemNum = 16;\n        this.x = x;\n        this.y = y;\n        this._imageAge = Number.MAX_VALUE;\n        this.text = '';\n        if (arguments[2]) {\n            this.row = Math.floor(arguments[2] / this.fontSize);\n        }\n    },\n    /**\n     * ラベルの内容を書き換える関数\n     * @param txt\n     */\n    setText: function(txt) {\n        var i, x, y, wNum, charCode, charPos;\n        this._text = txt;\n        var newWidth;\n        if (!this.returnLength) {\n            this.width = Math.min(this.fontSize * this._text.length, enchant.Game.instance.width);\n        } else {\n            this.width = Math.min(this.returnLength * this.fontSize, enchant.Game.instance.width);\n        }\n        this.height = this.fontSize * (Math.ceil(this._text.length / this.row) || 1);\n        // if image is to small or was to big for a long time create new image\n        if(!this.image || this.width > this.image.width || this.height > this.image.height || this._imageAge > 300) {\n            this.image = new enchant.Surface(this.width, this.height);\n            this._imageAge = 0;\n        } else if(this.width < this.image.width || this.height < this.image.height) {\n            this._imageAge++;\n        } else {\n            this._imageAge = 0;\n        }\n        this.image.context.clearRect(0, 0, this.width, this.height);\n        for (i = 0; i < txt.length; i++) {\n            charCode = txt.charCodeAt(i);\n            if (charCode >= 32 && charCode <= 127) {\n                charPos = charCode - 32;\n            } else {\n                charPos = 0;\n            }\n            x = charPos % this.widthItemNum;\n            y = (charPos / this.widthItemNum) | 0;\n            this.image.draw(enchant.Game.instance.assets['font0.png'],\n                x * this.fontSize, y * this.fontSize, this.fontSize, this.fontSize,\n                (i % this.row) * this.fontSize, ((i / this.row) | 0) * this.fontSize, this.fontSize, this.fontSize);\n        }\n    },\n    /**\n     * ラベルの内容\n     * @type {String}\n     */\n    text: {\n        get: function() {\n            return this._text;\n        },\n        set: function(txt) {\n            this.setText(txt);\n        }\n    },\n    /**\n     * @type {Number}\n     */\n    row: {\n        get: function() {\n            return this.returnLength || this.width / this.fontSize;\n        },\n        set: function(row) {\n            this.returnLength = row;\n            this.text = this.text;\n        }\n    }\n});\n\n/**\n * @scope enchant.ui.ScoreLabel.prototype\n * @type {*}\n */\nenchant.ui.ScoreLabel = enchant.Class.create(enchant.ui.MutableText, {\n    /**\n     * スコアを表示するラベル。\n     * 画像フォントクラス (MutableText) を使って表示する。\n     * @constructs\n     * @param x\n     * @param y\n     */\n    initialize: function(x, y) {\n        enchant.ui.MutableText.call(this, 0, 0);\n        switch (arguments.length) {\n            case 2:\n                this.y = y;\n                this.x = x;\n                break;\n            case 1:\n                this.x = x;\n                break;\n            default:\n                break;\n        }\n        this._score = 0;\n        this._current = 0;\n        this.easing = 2.5;\n        this.text = this.label = 'SCORE:';\n        this.addEventListener('enterframe', function() {\n            if (this.easing === 0) {\n                this.text = this.label + (this._current = this._score);\n            } else {\n                var dist = this._score - this._current;\n                if (0 < dist) {\n                    this._current += Math.ceil(dist / this.easing);\n                } else if (dist < 0) {\n                    this._current += Math.floor(dist / this.easing);\n                }\n                this.text = this.label + this._current;\n            }\n        });\n    },\n    /**\n     * スコア\n     * @type {Number}\n     */\n    score: {\n        get: function() {\n            return this._score;\n        },\n        set: function(newscore) {\n            this._score = newscore;\n        }\n    }\n});\n\n/**\n * @type {*}\n * @scope enchant.ui.TimeLabel.prototype\n */\nenchant.ui.TimeLabel = enchant.Class.create(enchant.ui.MutableText, {\n    /**\n     * 残り時間などのタイムを表示するラベル\n     * @constructs\n     * @param x\n     * @param y\n     * @param counttype\n     */\n    initialize: function(x, y, counttype) {\n        enchant.ui.MutableText.call(this, 0, 0);\n        switch (arguments.length) {\n            case 3:\n            case 2:\n                this.y = y;\n                this.x = x;\n                break;\n            case 1:\n                this.x = x;\n                break;\n            default:\n                break;\n        }\n        this._time = 0;\n        this._count = 1;// この数を毎フレーム每に足して上げ下げを制御する\n        if (counttype === 'countdown') {\n            this._count = -1;\n        }\n        this.text = this.label = 'TIME:';\n        this.addEventListener('enterframe', function() {\n            this._time += this._count;\n            this.text = this.label + (this._time / enchant.Game.instance.fps).toFixed(2);\n        });\n    },\n    /**\n     * 残り時間\n     * @type {Number}\n     */\n    time: {\n        get: function() {\n            return Math.floor(this._time / enchant.Game.instance.fps);\n        },\n        set: function(newtime) {\n            this._time = newtime * enchant.Game.instance.fps;\n        }\n    }\n});\n\n/**\n * @type {*}\n * @scope enchant.ui.LifeLabel.prototype\n */\nenchant.ui.LifeLabel = enchant.Class.create(enchant.Group, {\n    /**\n     * ライフを表示する専用のラベル\n     * icon0.png 内のハートの画像を用いる\n     * @constructs\n     * @param x\n     * @param y\n     * @param maxlife\n     */\n    initialize: function(x, y, maxlife) {\n        enchant.Group.call(this);\n        this.x = x || 0;\n        this.y = y || 0;\n        this._maxlife = maxlife || 9;\n        this._life = 0;\n        this.label = new enchant.ui.MutableText(0, 0, 80);\n        this.label.text = 'LIFE:';\n        this.addChild(this.label);\n        this.heart = [];\n        for (var i = 0; i < this._maxlife; i++) {\n            this.heart[i] = new enchant.Sprite(16, 16);\n            this.heart[i].image = enchant.Game.instance.assets['icon0.png'];\n            this.heart[i].x = this.label.width + i * 16;\n            this.heart[i].y = -3;\n            this.heart[i].frame = 10;\n            this.addChild(this.heart[i]);\n        }\n    },\n    /**\n     * 残りライフの数\n     * @type {Number}\n     */\n    life: {\n        get: function() {\n            return this._life;\n        },\n        set: function(newlife) {\n            this._life = newlife;\n            if (this._maxlife < newlife) {\n                this._life = this._maxlife;\n            }\n            for (var i = 0; i < this._maxlife; i++) {\n                this.heart[i].visible = (i <= newlife - 1);\n            }\n        }\n    }\n});\n\n/**\n * @scope enchant.ui.Bar\n * @type {*}\n */\nenchant.ui.Bar = enchant.Class.create(enchant.Sprite, {\n    /**\n     * イージング付きのバークラス\n     * @constructs\n     * @param x\n     * @param y\n     */\n    initialize: function(x, y) {\n        enchant.Sprite.call(this, 1, 16);\n        this.image = new enchant.Surface(1, 16);// Null用\n        this.image.context.fillColor = 'RGB(0, 0, 256)';\n        this.image.context.fillRect(0, 0, 1, 16);\n        this._direction = 'right';\n        this._origin = 0;\n        this._maxvalue = enchant.Game.instance.width;\n        this._lastvalue = 0;\n        this.value = 0;\n        this.easing = 5;\n        switch (arguments.length) {\n            case 2:\n                this.y = y;\n                this.x = x;\n                this._origin = x;\n                break;\n            case 1:\n                this.x = x;\n                this._origin = x;\n                break;\n            default:\n                break;\n        }\n        this.addEventListener('enterframe', function() {\n            if (this.value < 0) {\n                this.value = 0;\n            }\n            this._lastvalue += (this.value - this._lastvalue) / this.easing;\n            if (Math.abs(this._lastvalue - this.value) < 1.3) {\n                this._lastvalue = this.value;\n            }\n            this.width = (this._lastvalue) | 0;\n            if (this.width > this._maxvalue) {\n                this.width = this._maxvalue;\n            }\n            if (this._direction === 'left') {\n                this._x = this._origin - this.width;\n            } else {\n                this._x = this._origin;\n            }\n            this._updateCoordinate();\n        });\n    },\n    /**\n     * バーの向き ('right' or 'left')\n     * @default 'right'\n     * @type {String}\n     */\n    direction: {\n        get: function() {\n            return this._direction;\n        },\n        set: function(newdirection) {\n            if (newdirection !== 'right' && newdirection !== 'left') {\n                // ignore\n            } else {\n                this._direction = newdirection;\n            }\n        }\n    },\n    /**\n     * x 座標\n     * @type {Number}\n     */\n    x: {\n        get: function() {\n            return this._origin;\n        },\n        set: function(x) {\n            this._x = x;\n            this._origin = x;\n            this._dirty = true;\n        }\n    },\n    /**\n     * @type {Number}\n     */\n    maxvalue: {\n        get: function() {\n            return this._maxvalue;\n        },\n        set: function(val) {\n            this._maxvalue = val;\n        }\n    }\n});\n\n/**\n * @scope enchant.ui.VirtualMap.prototype\n */\nenchant.ui.VirtualMap = enchant.Class.create(enchant.Group, {\n    /**\n     * マップライクな Group\n     * addChildで Sprite 等を追加すると、自動的に mx, my プロパティが追加され、\n     * VirtualMap内での座標で Sprite を操作できる\n     *\n     * 使い方\n     * //20 x 20 メッシュの縦横320ピクセルの盤を作り、その上に16 x 16の駒を8つ並べる\n     * var board = new VirtualMap(20, 20);\n     * board.width = 320;\n     * board.height = 320;\n     * for(var i=0; i<8; i++){\n     *     var piece = new Sprite(16, 16);\n     *     piece.image = game.assets['icon0.gif'];\n     *     board.addChild(piece);\n     *     piece.mx = i + 3;\n     *     piece.my = 16;\n     * }\n     * game.rootScene.addChild(board);\n     *\n     * @param meshWidth\n     * @param meshHeight\n     * @constructs\n     */\n    initialize: function(meshWidth, meshHeight) {\n        enchant.Group.call(this);\n        this.meshWidth = meshWidth || 16;\n        this.meshHeight = meshHeight || 16;\n    },\n    /**\n     * VirtualMap にオブジェクトを追加する (自動的にバインドされる)\n     * @param obj\n     */\n    addChild: function(obj) {\n        enchant.Group.prototype.addChild.call(this, obj);\n        this.bind(obj);\n    },\n    /**\n     * VirtualMap にオブジェクトを追加する\n     * reference で指定したオブジェクトより前に追加される (自動的にバインドされる)。\n     * @param obj\n     * @param reference\n     */\n    insertBefore: function(obj, reference) {\n        enchant.Group.prototype.insertBefore.call(this, obj, reference);\n        this.bind(obj);\n    },\n    /**\n     * オブジェクトを VirtualMap にバインドする。\n     * バインドされたオブジェクトはメッシュ座標 mx, my プロパティを持ち、これを操作することで\n     * VirtualMap の中を移動させることができる。\n     * @param obj\n     */\n    bind: function(obj) {\n        Object.defineProperties(obj, {\n            \"mx\": {\n                get: function() {\n                    return Math.floor(this.x / this.parentNode.meshWidth);\n                },\n                set: function(arg) {\n                    this.x = Math.floor(arg * this.parentNode.meshWidth);\n                }\n            },\n            \"my\": {\n                get: function() {\n                    return Math.floor(this.y / this.parentNode.meshHeight);\n                },\n                set: function(arg) {\n                    this.y = Math.floor(arg * this.parentNode.meshWidth);\n                }\n            }\n        });\n        obj.mx = 0;\n        obj.my = 0;\n    }\n});\n\nfunction rand(num) {\n    return Math.floor(Math.random() * num);\n}\n","/**\n * @fileOverview\n * avatar.enchant.js\n * @version 0.2 (2012/08/09)\n * @requires enchant.js v0.4.0 or later\n * @author shi3z/UEI Corporation\n *\n * @description\n * enchant.js extension for 9leap.net\n * Avatar character plugin for enchant.js with 9leap.net\n *\n * @example\n * var core = new Core(320, 320);\n * core.preload('avatarBg1.png', 'avatarBg2.png', 'avatarBg3.png', 'bigmonster1.gif');\n * core.onload = function(){\n *     core.rootScene.backgroundColor = \"#000000\";\n *     // show infinite scrolling background\n *     bg = new AvatarBG(0);\n *     bg.y = 50;\n *     core.rootScene.addChild(bg);\n *     \n *     // show monster\n *     monster = new AvatarMonster(core.assets['bigmonster1.gif']);\n *     monster.x = 200;\n *     monster.y = 100;\n *     core.rootScene.addChild(monster);\n *     \n *     // show avatar\n *     chara = new Avatar(\"2:2:1:2004:21230:22480\");\n *     core.rootScene.addChild(chara);\n *     chara.scaleX = -1;\n *     chara.scaleY = 1;\n *     chara.x = 50;\n *     chara.y = 100;\n * };\n * core.start();\n */\n\n/**\n * avatar namespace object\n * @type {Object}\n */\nenchant.avatar = {};\n\n/**\n * AvatarCharacter\n * Base class of enchant.Avatar and enchant.AvatarMonster\n * @scope enchant.avatar.AvatarCharacter.prototype\n */\nenchant.avatar.AvatarCharacter = enchant.Class.create(enchant.Sprite, {\n    /**\n     * Constructor of AvatarCharacter\n     * @constructs\n     * @param width\n     * @param height\n     */\n    initialize: function(width, height) {\n        enchant.Sprite.call(this, width, height);\n        this.right();\n\n        /**\n         * Name of animation pattern;\n         * @type {String}\n         */\n        this.action = \"stop\";\n\n        /**\n         * Array of animation patterns\n         * @type {Object}\n         */\n        this.animPattern = { \"stop\": [ 0]};\n\n        /**\n         * Frame number of animation\n         * @type {Object}\n         */\n        this.animFrame = 0;\n        this.addEventListener('enterframe', function() {\n            if ((~~(this.age) & 0x03) !== 0)return;\n            if (this.action) {\n                var animPattern = this.animPattern[this.action];\n                this.frame = animPattern[this.animFrame];\n                this.animFrame++;\n                if (animPattern[this.animFrame] === -1) {\n                    this.animFrame = 0;\n                    this.action = \"stop\";\n                }\n                if (animPattern[this.animFrame] === -2) {\n                    this.parentNode.removeChild(this);\n                }\n                if (this.animFrame >= animPattern.length) {\n                    this.animFrame = 0;\n                }\n            }\n        });\n    },\n\n    /**\n     * Flip to left\n     */\n    left: function() {\n        this.scaleX = 1;\n    },\n    /**\n     * Flip to right\n     */\n    right: function() {\n        this.scaleX = -1;\n    }\n});\n\n\n/**\n * AvatarMonster\n * subclass of enchant.avatar.AvatarCharacter\n * @scope enchant.avatar.AvatarMonster.prototype\n */\nenchant.avatar.AvatarMonster = enchant.Class.create(enchant.avatar.AvatarCharacter, {\n    /**\n     * AvatarMonster\n     * Manage a monter animations\n     * @constructs\n     * @param {image} Image of monster\n     * @extends enchant.avatar.AvatarCharacter\n     */\n    initialize: function(image) {\n        var w = ~~(image.width / 4);\n        var h = w;\n        enchant.avatar.AvatarCharacter.call(this, w, h);\n        this.image = image;\n        this.animPattern = { \"stop\": [ 4, 4, 4, 3, 3, 3],\n            \"walk\": [ 2, 3, 4, 3],\n            \"appear\": [ 0, 1, 7, 6, 5, 4, 2, 3, -1],\n            \"disappear\": [ 3, 2, 4, 5, 6, 7, 1, 0, -2],\n            \"attack\": [ 5, 4, 6, 6, 6, -1]\n        };\n        this.action = \"attack\";\n        this.left();\n    }\n});\n\n/**\n * AvatarBG\n * @scope enchant.AvatarBG.prototype\n */\nenchant.avatar.AvatarBG = enchant.Class.create(enchant.Group, {\n    /**\n     * A class of infinite scrolling background.\n     * @param mode {Number} 0 to 3\n     * @constructs\n     * @extends enchant.Group\n     */\n    initialize: function(mode) {\n        enchant.Group.call(this);\n        var core = enchant.Core.instance;\n\n        this.veryfarbg = new enchant.Sprite(320, 51);\n        this.veryfarbg.y = 0;\n        this.veryfarbg.image = core.assets[\"avatarBg2.png\"];\n        this.veryfarbg.frame = mode;\n        this.addChild(this.veryfarbg);\n        this.farbgs = [];\n        for (i = 0; i < 3; i++) {\n            var bg = new enchant.Sprite(320, 32);\n            bg.image = core.assets[\"avatarBg3.png\"];\n            bg.frame = mode;\n            bg.x = i * 320 - 320;\n            bg.y = 20;\n            this.farbgs[this.farbgs.length] = bg;\n            this.addChild(bg);\n        }\n\n        this.tiles = [];\n        for (i = 0; i < 14; i++) {\n            var tile = new enchant.Sprite(32, 128);\n            tile.image = core.assets[\"avatarBg1.png\"];\n            tile.frame = mode;\n            tile.x = i * 31 - 48;\n            tile.y = 48;\n            this.tiles[this.tiles.length] = tile;\n            this.addChild(tile);\n        }\n    },\n    /**\n     * horizontal scrolling.\n     * @param {int} x Offset of x coordinate.\n     */\n    scroll: function(x) {\n        var dx = ~~(x / 2) % 320, ddx = ~~(x) % 32 * 2;\n        for (i = 0; i < 14; i++) {\n            this.tiles[i].x = i * 31 - ddx - 48;\n        }\n        for (i = 0; i < 3; i++) {\n            this.farbgs[i].x = i * 320 - dx - 320;\n        }\n    }\n});\n\n/**\n * Avatar\n * @scope enchant.Avatar.prototype\n */\nenchant.avatar.Avatar = enchant.Class.create(enchant.avatar.AvatarCharacter, {\n    /**\n     * @param {int}code  Avatar code\n     * @extends enchant.avatar.AvatarCharacter\n     * @constructs\n     */\n    initialize: function(code) {\n        enchant.avatar.AvatarCharacter.call(this, 64, 64);\n        if (code) {\n            this.setCode(code);\n        } else {\n            this.gender = 1;\n            this.hairstyle = 1;\n            this.haircolor = 0;\n            this.weapon = 2545;\n            this.armor = 2135;\n            this.headpiece = 0;\n            this.loadImage();\n        }\n        this.animPattern = { \"stop\": [ 0],\n            \"run\": [ 1, 2, 3, 2],\n            \"attack\": [ 0, 2, 9, 10, 11, 5, 0, 0, 0, -1],\n            \"special\": [ 0, 6, 5, 13, 14, 15, 0, 0, -1],\n            \"damage\": [ 7, 7, 7, 7, 0, 0, 0, -1],\n            \"dead\": [8],\n            \"demo\": [ 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 0, 0, 0, 0, 2, 9, 10, 11, 5, 0, 0, 0,\n                1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 0, 6, 5, 13, 14, 15, 0, 0]\n        };\n\n\n    },\n    /**\n     * Reflesh avatar animation image\n     */\n    loadImage: function() {\n        var ___EnchantAvatarServerURL = \"http://9leap.net/meruru/draw/draw.php\";\n        this.opt = \"gender=\" + this.gender + \"&job=0&hairstyle=\" + this.hairstyle + \"&haircolor=\" + this.haircolor + \"&weapon=\" + this.weapon + \"&armor=\" + this.armor + \"&headpiece=\" + this.headpiece + \"&invisible=0&x=0&y=0&w=4&h=4&dummy=.gif\";\n        this.src = ___EnchantAvatarServerURL + \"?\" + this.opt;\n        (function(that) {\n            var core = enchant.Core.instance;\n            core.load(that.src, function() {\n                that.image = core.assets[that.src];\n            });\n        })(this);\n    },\n    /**\n     * Get avatar code from actual object\n     * @return {String} code;\n     */\n    getCode: function() {\n        return this.gender + \":\" + this.hairstyle + \":\" + this.haircolor + \":\" +\n            this.weapon + \":\" + this.armor + \":\" + this.headpiece;\n    },\n    /**\n     * Set avatar code and reflesh avatar image.\n     * @param {String} code\n     */\n    setCode: function(code) {\n        data = code.split(\":\");\n        this.gender = data[0];\n        this.hairstyle = data[1];\n        this.haircolor = data[2];\n        this.weapon = data[3];\n        this.armor = data[4];\n        this.headpiece = data[5];\n        this.loadImage();\n    }\n});\n","/**\n * random.\n *\n * @param {int} min\n * @param {int} max\n */\nexport function random(min = 0, max = 0) {\n  return Math.floor( Math.random() * (max + 1 - min) ) + min\n}\n","import {random} from \"../functions\"\n\nclass Base {\n  constructor(x, y, Controller) {\n    this.controller = Controller \n    this.item = new Sprite(x, y)\n    this.item.x = 0\n    this.item.y = 0\n    this.game = Controller.game\n\n    this.item.on('enterframe', () => this.on())\n  }\n\n  on() {\n  }\n\n  random(min = 0, max = 0) {\n    return random(min, max)\n  }\n\n  apply(group) {\n    this.item.image = this.image\n    this.group = group\n    this.group.addChild(this.item)\n    return this\n  }\n\n  remove() {\n    if (!this.group) return this\n    this.group.removeChild(this.item)\n    return this\n  }\n}\n\nexport default Base\n","import Base from './_base'\n\nclass Ninja extends Base {\n  constructor(Controller) {\n    super(16, 25, Controller)\n    this.isJump = false\n    this.GROUND_Y = 468\n    this.item.on('touchstart', () => this.touchstart())\n    this.item.on('touchend', () => this.touchend())\n    this.item.x = 50\n    this.item.scale(3)\n    this.item.frame = [0, 1, 2]\n    this.item.y = this.GROUND_Y\n\n    this.soundEffect = this.game.assets['bgm/se_maoudamashii_retro08.mp3'].clone()\n    this.image = this.game.assets['img/ninja.png']\n    this.runSpeed = 1\n    this.SPEED_FLG = 0\n    this.isBan = false\n    return this\n  }\n\n  touchstart() {\n    if (!this.isJump) {\n      this.soundEffect.play()\n      this.isJump = true\n      this.vy = -20\n      this.item.frame = 0\n    }\n  }\n\n  touchend() {\n    if(this.isJump && this.vy < 0){\n      this.vy /= 2;\n    }\n  }\n\n  jump() {\n    // ジャンプ中\n    if (this.isJump) {\n      this.vy += 1\n      this.item.frame = 0\n      if (!this.isBan) this.item.y += this.vy\n      if (this.item.y >= this.GROUND_Y) {\n        this.item.y = this.GROUND_Y\n        this.isJump = false\n        this.item.frame = [0, 1, 2]\n      }\n    }\n  }\n\n  runState() {\n    if (this.SPEED_FLG > 0) this.item.frame = [2]\n    if (this.SPEED_FLG === 0) this.item.frame = [0, 1, 2]\n  }\n\n  run() {\n    this.runState()\n    if (this.controller.isSecond()) this.oneSecond()\n\n    if (!this.isJump) this.item.x += this.runSpeed\n    // this.item.x += this.runSpeed\n    // if (this.item.x > 650) this.controller.clear()\n  }\n\n  oneSecond() {\n    // 一秒に一回実行\n    if (this.SPEED_FLG > 0) this.SPEED_FLG -= 1\n    if (this.SPEED_FLG === 0) this.runSpeed = 1\n    if (this.SPEED_FLG === 0) this.isBan = false\n  }\n\n  speed() {\n    return this.SCROLL_SPEED\n  }\n\n  backRun() {\n    this.runSpeed = 1\n  }\n\n  slowRun() {\n    this.runSpeed = 0\n    this.SPEED_FLG = 1\n    this.isBan = true\n  }\n\n  on() {\n    this.jump()\n    this.run()\n  }\n}\n\nexport default Ninja\n","import Base from './_base'\n\nclass Cloud extends Base {\n  constructor(Controller) {\n    super(171, 51, Controller)\n    const y = this.random(0, 20) * 10\n    this.item.y = y\n    this.item.x = 640\n    this.item.frame = this.random(0, 2)\n    if (y < 80) this.SPEED = this.random(2, 8)\n    else this.SPEED = this.random(0, 2)\n    this.image = this.game.assets['img/cloud.png']\n    return this\n  }\n\n  init() {\n    this.item.x = this.random(3, 64) * 15\n    return this\n  }\n\n  on() {\n    this.item.x += (this.controller.scroll() + this.SPEED)\n  }\n}\n\nexport default Cloud\n","import Base from './_base'\n\nclass Mountain extends Base {\n  constructor(Controller) {\n    super(262, 138, Controller)\n    this.item.y = 351\n    this.item.x = 640\n    this.item.frame = this.random(0, 1)\n    this.image = this.game.assets['img/mountain.png']\n    return this\n  }\n\n  init() {\n    this.item.x = this.random(3, 64) * 15\n    return this\n  }\n\n  on() {\n    this.item.x += this.controller.scroll()\n  }\n}\n\nexport default Mountain\n","import Base from './_base'\n\nclass Ground extends Base {\n  constructor(Controller) {\n    super(640, 151, Controller)\n    this.item.y = 489\n    this.item.x = 0\n    this.item.frame = 0\n    this.image = this.game.assets['img/grand.png']\n    return this\n  }\n}\n\nexport default Ground\n","import Base from './_base'\n\nclass jumpBtn extends Base {\n  constructor(Controller) {\n    super(50, 50, Controller)\n    this.item.y = 550\n    this.item.x = 500\n    this.item.scale(2)\n    this.item.on('touchstart', () => this.touchstart())\n    this.item.on('touchend', () => this.touchend())\n\n    this.player = this.controller.items.prayer\n    this.image = this.game.assets['img/btn_jump.png']\n    return this\n  }\n\n  on() {\n  }\n\n  touchstart() {\n    this.player.touchstart()\n  }\n\n  touchend() {\n    this.player.touchend()\n  }\n}\n\nexport default jumpBtn\n","import Base from './_base'\n\nexport default class Rook extends Base {\n  constructor(Controller) {\n    super(251, 127, Controller)\n    this.item.y = 500\n    this.item.x = 640 + 251\n    // this.item.x = 487\n    this.item.scale(0.2)\n    this.image = this.game.assets['img/rook.png']\n    return this\n  }\n\n  move(num) {\n    this.item.x += num\n  }\n\n  on() {\n    this.move(this.controller.scroll())\n  }\n}\n\n","import {random} from \"../functions\"\n\nexport default class EnemyBase {\n  constructor(x, y, Controller) {\n    this.controller = Controller \n    this.item = new Sprite(x, y)\n    this.item.x = 0\n    this.item.y = 0\n    this.game = Controller.game\n\n    this.item.on('enterframe', () => this.on())\n    return this\n  }\n\n  move(num) {\n    this.item.x += num\n  }\n\n  on() {\n    this.move(this.controller.scroll())\n    // const prayer = this.controller.items.prayer\n    // if (this.area.intersect(prayer.item)) {\n    //   prayer.slowRun()\n    //   this.controller.scroll(0)\n    // } else {\n    //   prayer.backRun()\n    //   this.controller.scroll(-10)\n    // }\n  }\n\n  random(min = 0, max = 0) {\n    return random(min, max)\n  }\n\n  apply(group) {\n    this.item.image = this.image\n    this.group = group\n    group.addChild(this.item)\n    return this\n  }\n\n  remove() {\n    if (!this.group) return this\n    this.group.removeChild(this.item)\n    return this\n  }\n}\n\n","import EnemyBase from './_enemyBase'\n\nexport default class Musha extends EnemyBase {\n  constructor(Controller) {\n    super(25, 33, Controller)\n    this.item.y = 462\n    let x = 260\n    if (2 === this.controller.mode) x = 235\n    if (3 === this.controller.mode) x = 220\n    this.item.x = x\n\n    this.item.scale(2.5)\n    this.item.scaleX = -2.5\n\n    this.item.frame = [0, 1, 2]\n    this.image = this.game.assets['img/koka_ninja.png']\n\n    this.defaultRunSpeed = 0.4\n    this.runSpeed = this.defaultRunSpeed\n    this.SPEED_FLG = 0\n    return this\n  }\n\n  move() {\n    if (this.controller.isSecond()) this.oneSecond()\n    this.item.x += this.runSpeed\n  }\n\n  oneSecond() {\n    if (this.SPEED_FLG > 0) this.SPEED_FLG -= 1\n    if (this.SPEED_FLG === 0) this.runSpeed = this.defaultRunSpeed\n  }\n\n  on() {\n    this.move()\n    if (this.controller.intersectPrayer(this.item)) this.controller.clear()\n    if (this.item.x > 650) this.controller.over()\n  }\n}\n\n","import EnemyBase from './_enemyBase'\n\nexport default class Bakuhatu extends EnemyBase {\n  constructor(Controller, y, x) {\n    super(150, 150, Controller)\n    this.item.y = y\n    this.item.x = x\n\n    this.item.scale(-0.8)\n    // this.item.scaleX = -1.5\n\n    this.item.frame = 0\n    this.item.image = this.game.assets['img/bakuhatsu3.png']\n    this.controller.scene.addChild(this.item)\n    this.soundEffect = this.game.assets['bgm/panti.mp3'].clone()\n\n    this.item.on('enterframe', () => this.on())\n    this.soundEffect.play()\n    return this\n  }\n\n  on() {\n    if (this.controller.isSecond()) this.remove()\n  }\n\n  apply() {\n    return this\n  }\n\n  remove() {\n    this.controller.scene.removeChild(this.item)\n    return this\n  }\n\n}\n\n","import EnemyBase from './_enemyBase'\nimport Bakuhatu from './_bakuhatu'\n\nexport default class Ashigaru extends EnemyBase {\n  constructor(Controller) {\n    super(25, 25, Controller)\n    this.item.y = 470\n    this.item.x = 640 + 25\n\n    this.item.scale(2.8)\n\n    this.item.frame = [0, 1, 2]\n    this.image = this.game.assets['img/ashigaru.png']\n\n    this.runSpeed = -1\n    this.isJump = false\n    this.GROUND_Y = 470\n    return this\n  }\n\n  move(num) {\n    this.item.x += num + this.runSpeed\n  }\n\n  on() {\n    this.move(this.controller.scroll())\n    this.jump()\n    const prayer = this.controller.items.prayer\n    const boss = this.controller.items.boss\n    if (this.controller.intersectPrayer(this.item)) {\n      this.controller.SCROLL_SPEED = 0\n      this.controller.SCROLL_FLG = 1\n      prayer.slowRun()\n      boss.runSpeed = 4\n      boss.SPEED_FLG = 1\n      new Bakuhatu(this.controller, this.item.y - 55, this.item.x -65)\n      this.item.remove()\n    }\n  }\n\n  jump() {\n    if (this.random(1, 35) === 1 && 2 < this.controller.mode) {\n      if (!this.isJump) {\n        this.isJump = true\n        this.vy = this.random(-10, -15)\n      }\n    }\n    // ジャンプ中\n    if (this.isJump) {\n      this.vy += 1\n      this.item.y += this.vy\n      this.item.frame = 0\n      if (this.item.y >= this.GROUND_Y) {\n        this.item.y = this.GROUND_Y\n        this.isJump = false\n        this.item.frame = [0, 1, 2]\n      }\n    }\n  }\n}\n\n","import EnemyBase from './_enemyBase'\n\nexport default class Bakuhatu2 extends EnemyBase {\n  constructor(Controller, y, x) {\n    super(150, 150, Controller)\n    this.item.y = y\n    this.item.x = x\n\n    this.item.scale(-0.8)\n    // this.item.scaleX = -1.5\n\n    this.item.frame = 0\n    this.item.image = this.game.assets['img/bakuhatsu1.png']\n    this.controller.scene.addChild(this.item)\n    this.soundEffect = this.game.assets['bgm/bakuhatu.mp3'].clone()\n\n    this.item.on('enterframe', () => this.on())\n    this.soundEffect.play()\n    return this\n  }\n\n  on() {\n    if (this.controller.isSecond()) this.remove()\n  }\n\n  apply() {\n    return this\n  }\n\n  remove() {\n    this.controller.scene.removeChild(this.item)\n    return this\n  }\n\n}\n\n","import EnemyBase from './_enemyBase'\nimport Bakuhatu2 from './_bakuhatu2'\n\nexport default class Hinotama extends EnemyBase {\n  constructor(Controller) {\n    super(39, 25, Controller)\n    this.item.y = this.random(380, 460)\n    // this.item.y = 460\n    this.item.x = 620\n\n    this.item.scale(1.5)\n    // this.item.scaleX = -1.5\n\n    this.item.frame = [0, 1]\n    this.image = this.game.assets['img/hinotama.png']\n\n    this.runSpeed = -10\n    this.flg = false\n    return this\n  }\n\n  move() {\n    this.item.x += this.runSpeed\n    this.item.y += this.random(-10, 10)\n    if (this.item.y > 460) this.item.y = 460\n    if (this.item.y > 380) this.item.y = 380\n  }\n\n  getDegree(min, max, n) {\n    n %= max\n    if (n < min) n += max\n    return n\n  }\n\n  on() {\n    this.move()\n    if (this.flg) this.controller.over()\n    if (this.controller.intersectPrayer(this.item)) {\n      new Bakuhatu2(this.controller, this.item.y - 55, this.item.x -65)\n      this.flg = true\n    }\n  }\n}\n\n","/**\n * MyLabel // ラベルを作成する\n *\n * @param {} scene\n * @param {number} x\n * @param {number} y\n * @param {string} text\n * @param {number} fontSize\n */\nexport function MyLabel(scene, x, y, text, fontSize = 26, textAlign = 'left', color = '#333') {\n  const label = new Label(text)\n  label.x = x\n  label.y = y\n  label.font = `${fontSize}px sans-serif`\n  label.textAlign = textAlign\n  label.color = color\n  return label\n}\n","export const enemysTimeline = [\n  { class: 'Ashigaru', count: 1, mode: 1 },\n  { class: 'Hinotama', count: 3, mode: 1 },\n  { class: 'Hinotama', count: 6, mode: 1 },\n  { class: 'Ashigaru', count: 5, mode: 1 },\n  { class: 'Hinotama', count: 9, mode: 1 },\n  { class: 'Ashigaru', count: 9, mode: 1 },\n  { class: 'Ashigaru', count: 10, mode: 2 },\n  { class: 'Hinotama', count: 11, mode: 1 },\n  { class: 'Hinotama', count: 12, mode: 2 },\n  { class: 'Hinotama', count: 13, mode: 3 },\n  { class: 'Ashigaru', count: 13, mode: 1 },\n  { class: 'Ashigaru', count: 14, mode: 2 },\n  { class: 'Hinotama', count: 14, mode: 3 },\n  { class: 'Hinotama', count: 15, mode: 3 },\n  { class: 'Ashigaru', count: 17, mode: 1 },\n  { class: 'Hinotama', count: 18, mode: 2 },\n  { class: 'Hinotama', count: 20, mode: 3 },\n  { class: 'Ashigaru', count: 21, mode: 2 },\n  { class: 'Hinotama', count: 22, mode: 1 },\n  { class: 'Ashigaru', count: 23, mode: 3 },\n  { class: 'Ashigaru', count: 24, mode: 1 },\n  { class: 'Ashigaru', count: 25, mode: 2 },\n  { class: 'Hinotama', count: 26, mode: 3 },\n  { class: 'Ashigaru', count: 27, mode: 2 },\n  { class: 'Hinotama', count: 28, mode: 1 },\n  { class: 'Ashigaru', count: 29, mode: 2 },\n  { class: 'Ashigaru', count: 29, mode: 2 },\n  { class: 'Hinotama', count: 30, mode: 2 },\n  { class: 'Hinotama', count: 30, mode: 3 },\n  { class: 'Hinotama', count: 30, mode: 3 },\n];\n","/**\n * MySprite // スプライトを作成する\n *\n * @param {number} w\n * @param {number} h\n * @param {object} asset\n * @param {number} x\n * @param {number} y\n*/\nexport function MySprite(w, h, asset, x, y, scale = 1) {\n  const item = new Sprite(w, h)\n  item.image = asset\n  item.x = x\n  item.y = y\n  item.scale(scale)\n  return item\n}\n","// import Factory from './model/_factory'\nimport Ninja from './sprite/_ninja'\n// import Bg from './sprite/_bg'\nimport Cloud from './sprite/_cloud'\nimport Mountain from './sprite/_mountain'\nimport Ground from './sprite/_ground'\nimport Jump from './sprite/_janpBtn'\nimport River from './sprite/_river'\nimport Maluta from './sprite/_malta'\nimport Rook from './sprite/_rook'\nimport Musha from './sprite/_musha'\nimport Ashigaru from './sprite/_ashigaru'\nimport Hinotama from './sprite/_hinotama'\nimport { MyLabel } from './model/_label'\nimport {enemysTimeline} from './config/enemy'\nimport {MySprite} from './model/_sprite'\nimport {random} from './functions'\n\nconst GAME_CLEAR = 'img/game_clear.png'\nconst GAME_OVER = 'img/gameover.png'\nconst PASSWORD_MAKIMONO = 'img/password_makimono.png'\nconst PASSWORD_INTRODUCTION = 'img/password_introduction2.png'\nconst TAP_HERE = 'img/taphere.png'\n\nclass Main {\n  constructor() {\n    console.log('Main.constructor')\n    this.game = null\n    this.SCROLL_SPEED = -10\n    this.SCROLL_FLG = 0\n  }\n\n  init(game) {\n    console.log('Main.init')\n    this.fps = 24\n    this.game = game\n    this.game.fps = this.fps\n    // this.game.addEventListener('load', () => {\n    //   this.game.pushScene( this.game.mainScene() )\n    // })\n    // this.game.mainScene = () => {\n    //   const scene = new Scene()\n    //   scene.backgroundColor = 'black'\n    //   return scene\n    // }\n    this.game.onload = () => this.load()\n    this.game.on('enterframe', () => this.on())\n    this.items = {}\n    this.asset = {}\n    this.flameCount = 0\n    this.second = 0\n    this.scene = null\n    this.gameStart = false\n    this.restart = 0\n  }\n\n  hookAdd(name, hookClass) {\n    this.enemysClass[name] = (applyGroup) => new hookClass(this).apply(applyGroup)\n  }\n\n  enemyApply(name, applyGroup) {\n    const data = this.enemysClass[name]\n    if (data) return data(applyGroup)\n  }\n\n  facade() {\n    console.log('Main.facade')\n    this.enemysClass = {}\n    this.game.preload(\n      'img/ninja.png',\n      'img/btn_jump.png',\n      'img/kawa.png',\n      'img/cloud.png',\n      'img/mountain.png',\n      'img/grand.png',\n      'img/wind.png',\n      'img/rook.png',\n      'img/musha.png',\n      'img/ashigaru.png',\n      'img/hinotama.png',\n      'img/bakuhatsu3.png',\n      'img/bakuhatsu1.png',\n      'bgm/se_maoudamashii_retro08.mp3',\n      'bgm/MusMus-BGM-122.mp3',\n      'bgm/MusMus-BGM-115.mp3',\n      'bgm/MusMus-BGM-104.mp3',\n      'bgm/panti.mp3',\n      'bgm/bakuhatu.mp3',\n      'img/koka_ninja.png',\n      GAME_OVER,\n      GAME_CLEAR,\n      PASSWORD_MAKIMONO,\n      PASSWORD_INTRODUCTION,\n      TAP_HERE,\n    )\n\n    this.hookAdd('Ashigaru', Ashigaru)\n    this.hookAdd('Hinotama', Hinotama)\n  }\n\n  on() {\n    console.log('Main.on')\n    // ゲームが開始している場合\n    if (this.gameStart) {\n      this.flameCount += 1\n      if (this.isSecond()) this.second += 1\n\n      // ストップ秒数がある場合\n      if (this.isSecond() && this.SCROLL_FLG > 0) this.SCROLL_FLG -= 1\n      // ストップ秒数がない場合\n      if (this.isSecond() && this.SCROLL_FLG === 0) this.SCROLL_SPEED = -10\n\n      if (this.isSecond()) {\n        const applyArray = enemysTimeline\n          .filter((item) => item.count === this.second)\n          .filter((item) => item.mode <= this.mode)\n        applyArray.map((item) => this.enemyApply(item.class ,this.charaGroup))\n      }\n\n      const isSecond = this.isSecond()\n      if (isSecond && random(1, 3) === 1) new Cloud(this).apply(this.bgGroup)\n      if (isSecond && random(1, 4) === 1) new Cloud(this).apply(this.bgGroup)\n      if (isSecond && random(1, 5) === 1) new Mountain(this).apply(this.bgGroup)\n      if (isSecond && random(1, 5) === 1) new Rook(this).apply(this.bgGroup)\n      // if (isSecond && random(1, 9) === 1) new River(this),apply(this.bgGroup)\n      // if (isSecond && num === 2) new Maluta(this).apply()\n    }\n  }\n\n  isSecond() {\n    // 秒を判定する\n    return this.flameCount % this.fps === 0\n  }\n\n  timerInit() {\n    this.flameCount = 0\n    this.second = 0\n  }\n\n  removeScene(scene) {\n    if (!scene) return\n    while(scene.firstChild){\n        scene.removeChild(scene.firstChild);\n    }\n  }\n\n  replaceScene(scene) {\n    this.game.replaceScene(scene)\n    this.scene = scene\n  }\n\n  titleScene(old) {\n    this.removeScene(old)\n    if (this.bgm) this.bgm.stop()\n    const scene = new Scene()\n    scene.addChild(MyLabel(scene, 180, 200, '武者を捕まえろ', 27, 'center', '#ffffff'))\n    scene.addChild(MyLabel(scene, 180, 250, '難易度選択でゲーム開始', 27, 'center', '#ffffff'))\n\n    const easy = MyLabel(scene, 180, 340, 'かんたん', 27, 'center', '#ffffff')\n    const nomal = MyLabel(scene, 180, 400, 'ふつー', 27, 'center', '#ffffff')\n    const hard = MyLabel(scene, 180, 460, 'むずかしい', 27, 'center', '#ffffff')\n    scene.addChild(easy)\n    scene.addChild(nomal)\n    scene.addChild(hard)\n\n    easy.on('touchstart', () => this.gameScene(scene, 1))\n    nomal.on('touchstart', () => this.gameScene(scene, 2))\n    hard.on('touchstart', () => this.gameScene(scene, 3))\n    scene.backgroundColor = '#4a62e6'\n    this.replaceScene(scene)\n\n    const bgGroup = new Group()\n    // new Cloud(this).init().apply(bgGroup)\n    // new Cloud(this).init().apply(bgGroup)\n    // new Mountain(this).init().apply(bgGroup)\n    // this.bgGroup = bgGroup\n    scene.addChild(bgGroup)\n  }\n\n  gameScene(old, mode = 2) {\n    // モードを設定\n    this.mode = mode\n\n    this.removeScene(old)\n    this.timerInit()\n    const scene = new Scene()\n\n    this.bgm = this.game.assets['bgm/MusMus-BGM-122.mp3'].clone()\n    this.bgm.play()\n    this.replaceScene(scene)\n    scene.backgroundColor = '#4a62e6'\n\n    const ctlGroup = new Group()\n    const bgGroup = new Group()\n    const charaGroup = new Group()\n\n    this.items.prayer = new Ninja(this).apply(charaGroup)\n    this.items.boss = new Musha(this).apply(charaGroup)\n    this.items.jumpBtn = new Jump(this).apply(ctlGroup)\n\n    new Ground(this).apply(bgGroup)\n    new Cloud(this).init().apply(bgGroup)\n    new Cloud(this).init().apply(bgGroup)\n    new Mountain(this).init().apply(bgGroup)\n    new Rook(this).apply(bgGroup)\n\n    scene.addChild(bgGroup)\n    scene.addChild(charaGroup)\n    scene.addChild(ctlGroup)\n    this.bgGroup = bgGroup\n    this.charaGroup = charaGroup\n\n    this.gameStart = true\n  }\n\n  overScene(old) {\n    this.removeScene(old)\n    const scene = new Scene()\n    scene.backgroundColor = '#333'\n    scene.addChild(MyLabel(scene, 170, 250, 'GAME OVER', 40, 'center', '#ffffff'))\n    // scene.addChild(MyLabel(scene, 190, 300, `タッチでリトライ`, 30, 'center', '#ffffff'))\n    // scene.addChild(MySprite(189, 97, this.game.assets[GAME_OVER], 240, 190, 2))\n    scene.addChild(MyLabel(scene, 180, 400, `タッチでリトライ`, 30, 'center', '#ffffff'))\n\n    scene.on('touchstart', () => this.titleScene())\n    this.replaceScene(scene)\n    if (this.bgm) this.bgm.stop()\n    this.bgm = this.game.assets['bgm/MusMus-BGM-104.mp3'].clone()\n    this.bgm.play()\n  }\n\n  clearScene(old) {\n    this.removeScene(old)\n    const scene = new Scene()\n    scene.addChild(MyLabel(scene, 160, 280, 'GAME CLEAR', 30, 'center'))\n    scene.addChild(MyLabel(scene, 190, 330, `タイム ${this.second}秒`, 30, 'center'))\n    scene.addChild(MyLabel(scene, 160, 380, `リスタート${this.restart}回`, 30, 'center'))\n    scene.on('touchstart', () => this.gameclearScene())\n    this.replaceScene(scene)\n  }\n\n  gameclearScene(old) {\n    this.removeScene(old)\n    const scene = new Scene()\n    scene.backgroundColor = 'black'\n\n    scene.addChild(MySprite(126, 24, this.game.assets[GAME_CLEAR], 265, 95, 2))\n    scene.addChild(MySprite(100, 70, this.game.assets[PASSWORD_MAKIMONO], 270, 215, 2))\n    scene.addChild(MySprite(65, 18, this.game.assets[PASSWORD_INTRODUCTION], 296, 332, 2))\n\n    // //ここをタップ\n    const taphere = new Sprite(127,25)\n    taphere.image = this.game.assets[TAP_HERE]\n    taphere.x = 260\n    taphere.y = 490\n    taphere.scale(2)\n    const opa = 0.08\n    taphere.opacity = opa\n    var flg = 0\n    taphere.onenterframe = function(){\n        if(taphere.opacity < 1 && flg == 0){\n            taphere.opacity += opa\n        }else{\n            if(taphere.opacity >= 1){\n                flg = 1\n            }\n            if(taphere.opacity <= 0){\n                flg = 0\n            }\n            var opa_check = taphere.opacity - opa\n            if(opa_check < 0){\n                taphere.opacity = 0\n            }else{\n                taphere.opacity -= opa\n            }\n        }\n    }\n    scene.addChild(taphere)\n    // taphere.on('touchstart', () => this.endScene())\n    taphere.on('touchstart', () =>window.location.href = 'https://genmakai.github.io/site/')\n\n\n    const label = MyLabel(scene, 300, 224, 'き', 32, 'left')\n    label.color = 'black'\n    label.font = \"64px 'Meiryo', 'メイリオ', 'ヒラギノ角ゴ Pro W3', sans-serif\"\n    scene.addChild(label)\n\n    // scene.on('touchstart', () => this.endScene())\n    this.replaceScene(scene)\n  }\n\n  endScene(old) {\n    this.removeScene(old)\n    const scene = new Scene()\n    scene.addChild(MyLabel(scene, 280, 80, '使用素材', 26, 'left'))\n    scene.addChild(MyLabel(scene, 220, 180, 'フリーBGM・音楽素材MusMus <br>https://musmus.main.jp/<br>・Mid-range Strength<br>・隠密ファンク<br>・希望の青', 16, 'left'))\n    scene.on('touchstart', () => this.titleScene())\n    this.replaceScene(scene)\n  }\n\n  intersectPrayer(chara) {\n    const prayer = this.getData(this.items, 'prayer.item')\n    if (!prayer) return false\n    return prayer.intersect(chara)\n  }\n\n  start() {\n    console.log('メイン処理開始')\n    this.titleScene()\n    this.game.start()\n  }\n\n  stop() {\n    console.log('メイン処理停止')\n    this.game.stop()\n    this.gameStart = false\n  }\n\n  over() {\n    this.overScene()\n    this.restart += 1\n    this.gameStart  = false\n  }\n\n  clear() {\n    console.log('スクリーンクリア')\n    // this.clearScene()\n    this.gameclearScene()\n    this.gameStart  = false\n  }\n\n  load() {\n    console.log('メイン読み込み')\n  }\n\n  scroll() {\n    return this.SCROLL_SPEED\n  }\n\n  getData(object, path, defaultValue) {\n    if (!object) return null\n    const propertyArray = path.split('.')\n    let result = object\n    try {\n      propertyArray.map((value) => {\n        const r = result[value]\n        result = r\n      })\n      return result\n    } catch (e) {\n      return defaultValue\n    }\n  }\n}\nexport default new Main()\n","import './enchant.js'\nimport './plugins/ui.enchant'\nimport './plugins/avatar.enchant'\nenchant()\n\nimport Main from './_main'\n\nwindow.main = Main\n\nwindow.onload = function(){\n  console.log('読み込み完了')\n\n  const core = new Core(640, 640)\n  Main.init(core)\n  Main.facade()\n  Main.start()\n}\n"],"sourceRoot":""}